/*!
 * Socket.IO v2.1.0
 * (c) 2014-2018 Guillermo Rauch
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.io=e():t.io=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t,e){"object"===("undefined"==typeof t?"undefined":o(t))&&(e=t,t=void 0),e=e||{};var n,r=i(t),s=r.source,p=r.id,h=r.path,f=u[p]&&h in u[p].nsps,l=e.forceNew||e["force new connection"]||!1===e.multiplex||f;return l?(c("ignoring socket cache for %s",s),n=a(s,e)):(u[p]||(c("new io instance for %s",s),u[p]=a(s,e)),n=u[p]),r.query&&!e.query&&(e.query=r.query),n.socket(r.path,e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(1),s=n(7),a=n(12),c=n(3)("socket.io-client");t.exports=e=r;var u=e.managers={};e.protocol=s.protocol,e.connect=r,e.Manager=n(12),e.Socket=n(37)},function(t,e,n){(function(e){"use strict";function r(t,n){var r=t;n=n||e.location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t="undefined"!=typeof n?n.protocol+"//"+t:"https://"+t),i("parse %s",t),r=o(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=r.host.indexOf(":")!==-1,a=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}var o=n(2),i=n(3)("socket.io-client:url");t.exports=r}).call(e,function(){return this}())},function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,o=t.indexOf("["),i=t.indexOf("]");o!=-1&&i!=-1&&(t=t.substring(0,o)+t.substring(o,i).replace(/:/g,";")+t.substring(i,t.length));for(var s=n.exec(t||""),a={},c=14;c--;)a[r[c]]=s[c]||"";return o!=-1&&i!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,n){(function(r){function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,r)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(n){}}function c(){var t;try{t=e.storage.debug}catch(n){}return!t&&"undefined"!=typeof r&&"env"in r&&(t=r.env.DEBUG),t}function u(){try{return window.localStorage}catch(t){}}e=t.exports=n(5),e.log=s,e.formatArgs=i,e.save=a,e.load=c,e.useColors=o,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},e.enable(c())}).call(e,n(4))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(p===setTimeout)return setTimeout(t,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function i(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){y&&l&&(y=!1,l.length?d=l.concat(d):m=-1,d.length&&a())}function a(){if(!y){var t=o(s);y=!0;for(var e=d.length;e;){for(l=d,d=[];++m<e;)l&&l[m].run();m=-1,e=d.length}l=null,y=!1,i(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var p,h,f=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(t){p=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var l,d=[],y=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new c(t,e)),1!==d.length||y||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){function r(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}function o(t){function n(){if(n.enabled){var t=n,r=+new Date,i=r-(o||r);t.diff=i,t.prev=o,t.curr=r,o=r;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=e.formatters[r];if("function"==typeof o){var i=s[c];n=o.call(t,i),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s);var u=n.log||e.log||console.log.bind(console);u.apply(t,s)}}var o;return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=r(t),n.destroy=i,"function"==typeof e.init&&e.init(n),e.instances.push(n),n}function i(){var t=e.instances.indexOf(this);return t!==-1&&(e.instances.splice(t,1),!0)}function s(t){e.save(t),e.names=[],e.skips=[];var n,r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&(t=r[n].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var i=e.instances[n];i.enabled=e.enabled(i.namespace)}}function a(){e.enable("")}function c(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1}function u(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=o.debug=o["default"]=o,e.coerce=u,e.disable=a,e.enable=s,e.enabled=c,e.humanize=n(6),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function n(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*p;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*a;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function r(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function o(t){return i(t,u,"day")||i(t,c,"hour")||i(t,a,"minute")||i(t,s,"second")||t+" ms"}function i(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,p=365.25*u;t.exports=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return n(t);if("number"===i&&isNaN(t)===!1)return e["long"]?o(t):r(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){function r(){}function o(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var r=i(t.data);if(r===!1)return g;n+=r}return f("encoded %j as %s",t,n),n}function i(t){try{return JSON.stringify(t)}catch(e){return!1}}function s(t,e){function n(t){var n=d.deconstructPacket(t),r=o(n.packet),i=n.buffers;i.unshift(r),e(i)}d.removeBlobs(t,n)}function a(){this.reconstructor=null}function c(t){var n=0,r={type:Number(t.charAt(0))};if(null==e.types[r.type])return h("unknown packet type "+r.type);if(e.BINARY_EVENT===r.type||e.BINARY_ACK===r.type){for(var o="";"-"!==t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!==t.charAt(n))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(n+1))for(r.nsp="";++n;){var i=t.charAt(n);if(","===i)break;if(r.nsp+=i,n===t.length)break}else r.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(r.id="";++n;){var i=t.charAt(n);if(null==i||Number(i)!=i){--n;break}if(r.id+=t.charAt(n),n===t.length)break}r.id=Number(r.id)}if(t.charAt(++n)){var a=u(t.substr(n)),c=a!==!1&&(r.type===e.ERROR||y(a));if(!c)return h("invalid payload");r.data=a}return f("decoded %s as %j",t,r),r}function u(t){try{return JSON.parse(t)}catch(e){return!1}}function p(t){this.reconPack=t,this.buffers=[]}function h(t){return{type:e.ERROR,data:"parser error: "+t}}var f=n(3)("socket.io-parser"),l=n(8),d=n(9),y=n(10),m=n(11);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=r,e.Decoder=a;var g=e.ERROR+'"encode error"';r.prototype.encode=function(t,n){if(f("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)s(t,n);else{var r=o(t);n([r])}},l(a.prototype),a.prototype.add=function(t){var n;if("string"==typeof t)n=c(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!m(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,this.emit("decoded",n))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,n){function r(t){if(t)return o(t)}function o(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){(function(t){function r(t,e){if(!t)return t;if(s(t)){var n={_placeholder:!0,num:e.length};return e.push(t),n}if(i(t)){for(var o=new Array(t.length),a=0;a<t.length;a++)o[a]=r(t[a],e);return o}if("object"==typeof t&&!(t instanceof Date)){var o={};for(var c in t)o[c]=r(t[c],e);return o}return t}function o(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(i(t))for(var n=0;n<t.length;n++)t[n]=o(t[n],e);else if("object"==typeof t)for(var r in t)t[r]=o(t[r],e);return t}var i=n(10),s=n(11),a=Object.prototype.toString,c="function"==typeof t.Blob||"[object BlobConstructor]"===a.call(t.Blob),u="function"==typeof t.File||"[object FileConstructor]"===a.call(t.File);e.deconstructPacket=function(t){var e=[],n=t.data,o=t;return o.data=r(n,e),o.attachments=e.length,{packet:o,buffers:e}},e.reconstructPacket=function(t,e){return t.data=o(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){function n(t,a,p){if(!t)return t;if(c&&t instanceof Blob||u&&t instanceof File){r++;var h=new FileReader;h.onload=function(){p?p[a]=this.result:o=this.result,--r||e(o)},h.readAsArrayBuffer(t)}else if(i(t))for(var f=0;f<t.length;f++)n(t[f],f,t);else if("object"==typeof t&&!s(t))for(var l in t)n(t[l],l,t)}var r=0,o=t;n(o),r||e(o)}}).call(e,function(){return this}())},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){(function(e){function n(t){return r&&e.Buffer.isBuffer(t)||o&&(t instanceof e.ArrayBuffer||i(t))}t.exports=n;var r="function"==typeof e.Buffer&&"function"==typeof e.Buffer.isBuffer,o="function"==typeof e.ArrayBuffer,i=function(){return o&&"function"==typeof e.ArrayBuffer.isView?e.ArrayBuffer.isView:function(t){return t.buffer instanceof e.ArrayBuffer}}()}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t&&"object"===("undefined"==typeof t?"undefined":o(t))&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||c;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=e.autoConnect!==!1,this.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(13),s=n(37),a=n(8),c=n(7),u=n(39),p=n(40),h=n(3)("socket.io-client:manager"),f=n(36),l=n(41),d=Object.prototype.hasOwnProperty;t.exports=r,r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)d.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},r.prototype.updateSocketIds=function(){for(var t in this.nsps)d.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},r.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},a(r.prototype),r.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},r.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},r.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(t,e){if(h("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=u(n,"open",function(){r.onopen(),t&&t()}),s=u(n,"error",function(e){if(h("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;h("connect attempt will timeout after %d",a);var c=setTimeout(function(){h("connect attempt timed out after %d",a),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(s),this},r.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(u(t,"data",p(this,"ondata"))),this.subs.push(u(t,"ping",p(this,"onping"))),this.subs.push(u(t,"pong",p(this,"onpong"))),this.subs.push(u(t,"error",p(this,"onerror"))),this.subs.push(u(t,"close",p(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",p(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(t){this.decoder.add(t)},r.prototype.ondecoded=function(t){this.emit("packet",t)},r.prototype.onerror=function(t){h("error",t),this.emitAll("error",t)},r.prototype.socket=function(t,e){function n(){~f(o.connecting,r)||o.connecting.push(r)}var r=this.nsps[t];if(!r){r=new s(this,t,e),this.nsps[t]=r;var o=this;r.on("connecting",n),r.on("connect",function(){r.id=o.generateId(t)}),this.autoConnect&&n()}return r},r.prototype.destroy=function(t){var e=f(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},r.prototype.packet=function(t){h("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()}))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},r.prototype.cleanup=function(){h("cleanup");for(var t=this.subs.length,e=0;e<t;e++){var n=this.subs.shift();n.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){h("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(t){h("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();h("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(h("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(h("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(h("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},r.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,n){t.exports=n(14),t.exports.parser=n(21)},function(t,e,n){(function(e){function r(t,n){if(!(this instanceof r))return new r(t,n);n=n||{},t&&"object"==typeof t&&(n=t,t=null),t?(t=p(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=p(n.host).host),this.secure=null!=n.secure?n.secure:e.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(e.location?location.hostname:"localhost"),this.port=n.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var o="object"==typeof e&&e;o.global===o&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function o(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var i=n(15),s=n(8),a=n(3)("engine.io-client:socket"),c=n(36),u=n(21),p=n(2),h=n(30);t.exports=r,r.priorWebsocketSuccess=!1,s(r.prototype),r.protocol=u.protocol,r.Socket=r,r.Transport=n(20),r.transports=n(15),r.parser=n(21),r.prototype.createTransport=function(t){a('creating transport "%s"',t);var e=o(this.query);e.EIO=u.protocol,e.transport=t;var n=this.transportOptions[t]||{};this.id&&(e.sid=this.id);var r=new i[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0});return r},r.prototype.open=function(){var t;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(n){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},r.prototype.setTransport=function(t){a("setting transport %s",t.name);var e=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},r.prototype.probe=function(t){function e(){if(f.onlyBinaryUpgrades){var e=!this.supportsBinary&&f.transport.supportsBinary;h=h||e}h||(a('probe transport "%s" opened',t),p.send([{type:"ping",data:"probe"}]),p.once("packet",function(e){if(!h)if("pong"===e.type&&"probe"===e.data){if(a('probe transport "%s" pong',t),f.upgrading=!0,f.emit("upgrading",p),!p)return;r.priorWebsocketSuccess="websocket"===p.name,a('pausing current transport "%s"',f.transport.name),f.transport.pause(function(){h||"closed"!==f.readyState&&(a("changing transport and sending upgrade packet"),u(),f.setTransport(p),p.send([{type:"upgrade"}]),f.emit("upgrade",p),p=null,f.upgrading=!1,f.flush())})}else{a('probe transport "%s" failed',t);var n=new Error("probe error");n.transport=p.name,f.emit("upgradeError",n)}}))}function n(){h||(h=!0,u(),p.close(),p=null)}function o(e){var r=new Error("probe error: "+e);r.transport=p.name,n(),a('probe transport "%s" failed because of error: %s',t,e),f.emit("upgradeError",r)}function i(){o("transport closed")}function s(){o("socket closed")}function c(t){p&&t.name!==p.name&&(a('"%s" works - aborting "%s"',t.name,p.name),n())}function u(){p.removeListener("open",e),p.removeListener("error",o),p.removeListener("close",i),f.removeListener("close",s),f.removeListener("upgrading",c)}a('probing transport "%s"',t);var p=this.createTransport(t,{probe:1}),h=!1,f=this;r.priorWebsocketSuccess=!1,p.once("open",e),p.once("error",o),p.once("close",i),this.once("close",s),this.once("upgrading",c),p.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},r.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},r.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},r.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},r.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){n=n||{},n.compress=!1!==n.compress;var o={type:t,data:e,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function t(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function e(){r.removeListener("upgrade",e),r.removeListener("upgradeError",e),t()}function n(){r.once("upgrade",e),r.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():t()}):this.upgrading?n():t()}return this},r.prototype.onError=function(t){a("socket error %j",t),r.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},r.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){a('socket close with reason: "%s"',t);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),n.writeBuffer=[],n.prevBufferLen=0}},r.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~c(this.transports,t[n])&&e.push(t[n]);return e}}).call(e,function(){return this}())},function(t,e,n){(function(t){function r(e){var n,r=!1,a=!1,c=!1!==e.jsonp;if(t.location){var u="https:"===location.protocol,p=location.port;p||(p=u?443:80),r=e.hostname!==location.hostname||p!==e.port,a=e.secure!==u}if(e.xdomain=r,e.xscheme=a,n=new o(e),"open"in n&&!e.forceJSONP)return new i(e);if(!c)throw new Error("JSONP disabled");return new s(e)}var o=n(16),i=n(18),s=n(33),a=n(34);e.polling=r,e.websocket=a}).call(e,function(){return this}())},function(t,e,n){(function(e){var r=n(17);t.exports=function(t){var n=t.xdomain,o=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(s){}try{if("undefined"!=typeof XDomainRequest&&!o&&i)return new XDomainRequest}catch(s){}if(!n)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(s){}}}).call(e,function(){return this}())},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},function(t,e,n){(function(e){function r(){}function o(t){if(c.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,e.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=t.hostname!==e.location.hostname||r!==t.port,this.xs=t.secure!==n}}function i(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in i.requests)i.requests.hasOwnProperty(t)&&i.requests[t].abort()}var a=n(16),c=n(19),u=n(8),p=n(31),h=n(3)("engine.io-client:polling-xhr");t.exports=o,t.exports.Request=i,p(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new i(t)},o.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),o=this;r.on("success",e),r.on("error",function(t){o.onError("xhr post error",t)}),this.sendXhr=r},o.prototype.doPoll=function(){h("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},u(i.prototype),i.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new a(t),r=this;try{h("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(var o in this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this.extraHeaders[o])}}catch(s){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}try{n.setRequestHeader("Accept","*/*")}catch(s){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState)try{var t=n.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===t&&(n.responseType="arraybuffer")}catch(e){}4===n.readyState&&(200===n.status||1223===n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},h("xhr data %s",this.data),n.send(this.data)}catch(s){return void setTimeout(function(){r.onError(s)},0)}e.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},i.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},i.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,t)try{this.xhr.abort()}catch(n){}e.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(n){}t="application/octet-stream"===e?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(n){this.onError(n)}null!=t&&this.onData(t)},i.prototype.hasXDR=function(){return"undefined"!=typeof e.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",s):e.addEventListener&&e.addEventListener("beforeunload",s,!1))}).call(e,function(){return this}())},function(t,e,n){function r(t){var e=t&&t.forceBase64;p&&!e||(this.supportsBinary=!1),o.call(this,t)}var o=n(20),i=n(30),s=n(21),a=n(31),c=n(32),u=n(3)("engine.io-client:polling");t.exports=r;var p=function(){var t=n(16),e=new t({xdomain:!1});return null!=e.responseType}();a(r,o),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(t){function e(){u("paused"),n.readyState="paused",t()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||e()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||e()}))}else e()},r.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(t){var e=this;u("polling got data %s",t);var n=function(t,n,r){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,n),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function t(){u("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},r.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,n)})},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t);var r=this.hostname.indexOf(":")!==-1;return e+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+t}},function(t,e,n){function r(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var o=n(21),i=n(8);t.exports=r,i(r.prototype),r.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(t){var e=o.decodePacket(t,this.socket.binaryType);this.onPacket(e)},r.prototype.onPacket=function(t){this.emit("packet",t)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,n){(function(t){function r(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}function o(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var o=t.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=v[t.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}function i(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var o=new FileReader;return o.onload=function(){t.data=o.result,e.encodePacket(t,n,!0,r)},o.readAsArrayBuffer(t.data)}function s(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(g)return i(t,n,r);var o=new Uint8Array(1);o[0]=v[t.type];var s=new k([o.buffer,t.data]);return r(s)}function a(t){try{t=d.decode(t,{strict:!1})}catch(e){return!1}return t}function c(t,e,n){for(var r=new Array(t.length),o=l(t.length,n),i=function(t,n,o){e(n,function(e,n){r[t]=n,o(e,r)})},s=0;s<t.length;s++)i(s,t[s],o)}var u,p=n(22),h=n(23),f=n(24),l=n(25),d=n(26);t&&t.ArrayBuffer&&(u=n(28));var y="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),g=y||m;e.protocol=3;var v=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=p(v),w={type:"error",data:"parser error"},k=n(29);e.encodePacket=function(e,n,i,a){"function"==typeof n&&(a=n,n=!1),"function"==typeof i&&(a=i,i=null);var c=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&c instanceof ArrayBuffer)return o(e,n,a);if(k&&c instanceof t.Blob)return s(e,n,a);if(c&&c.base64)return r(e,a);var u=v[e.type];return void 0!==e.data&&(u+=i?d.encode(String(e.data),{strict:!1}):String(e.data)),a(""+u)},e.encodeBase64Packet=function(n,r){var o="b"+e.packets[n.type];if(k&&n.data instanceof t.Blob){var i=new FileReader;return i.onload=function(){var t=i.result.split(",")[1];r(o+t)},i.readAsDataURL(n.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(a){for(var c=new Uint8Array(n.data),u=new Array(c.length),p=0;p<c.length;p++)u[p]=c[p];s=String.fromCharCode.apply(null,u)}return o+=t.btoa(s),r(o)},e.decodePacket=function(t,n,r){if(void 0===t)return w;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),n);if(r&&(t=a(t),t===!1))return w;var o=t.charAt(0);return Number(o)==o&&b[o]?t.length>1?{type:b[o],data:t.substring(1)}:{type:b[o]}:w}var i=new Uint8Array(t),o=i[0],s=f(t,1);return k&&"blob"===n&&(s=new k([s])),{type:b[o],data:s}},e.decodeBase64Packet=function(t,e){var n=b[t.charAt(0)];if(!u)return{type:n,data:{base64:!0,data:t.substr(1)}};var r=u.decode(t.substr(1));return"blob"===e&&k&&(r=new k([r])),{type:n,data:r}},e.encodePayload=function(t,n,r){function o(t){return t.length+":"+t}function i(t,r){e.encodePacket(t,!!s&&n,!1,function(t){r(null,o(t))})}"function"==typeof n&&(r=n,n=null);var s=h(t);return n&&s?k&&!g?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r):t.length?void c(t,i,function(t,e){return r(e.join(""))}):r("0:")},e.decodePayload=function(t,n,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,n,r);"function"==typeof n&&(r=n,n=null);var o;if(""===t)return r(w,0,1);for(var i,s,a="",c=0,u=t.length;c<u;c++){var p=t.charAt(c);if(":"===p){if(""===a||a!=(i=Number(a)))return r(w,0,1);if(s=t.substr(c+1,i),a!=s.length)return r(w,0,1);if(s.length){if(o=e.decodePacket(s,n,!1),w.type===o.type&&w.data===o.data)return r(w,0,1);var h=r(o,c+i,u);if(!1===h)return}c+=i,a=""}else a+=p}return""!==a?r(w,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){function r(t,n){e.encodePacket(t,!0,!0,function(t){return n(null,t)})}return t.length?void c(t,r,function(t,e){var r=e.reduce(function(t,e){var n;return n="string"==typeof e?e.length:e.byteLength,t+n.toString().length+n+2},0),o=new Uint8Array(r),i=0;return e.forEach(function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);n=r.buffer}e?o[i++]=0:o[i++]=1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]}),n(o.buffer)}):n(new ArrayBuffer(0))},e.encodePayloadAsBlob=function(t,n){function r(t,n){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);t=r.buffer,e[0]=0}for(var i=t instanceof ArrayBuffer?t.byteLength:t.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++)a[o]=parseInt(s[o]);if(a[s.length]=255,k){var c=new k([e.buffer,a.buffer,t]);n(null,c)}})}c(t,r,function(t,e){return n(new k(e))})},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var o=t,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),a=0===s[0],c="",u=1;255!==s[u];u++){if(c.length>310)return r(w,0,1);c+=s[u]}o=f(o,2+c.length),c=parseInt(c);var p=f(o,0,c);if(a)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(h){var l=new Uint8Array(p);p="";for(var u=0;u<l.length;u++)p+=String.fromCharCode(l[u])}i.push(p),o=f(o,c)}var d=i.length;i.forEach(function(t,o){r(e.decodePacket(t,n,!0),o,d)})}}).call(e,function(){return this}())},function(t,e){t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},function(t,e,n){(function(e){function r(t){if(!t||"object"!=typeof t)return!1;if(o(t)){for(var n=0,i=t.length;n<i;n++)if(r(t[n]))return!0;return!1}if("function"==typeof e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(t)||"function"==typeof e.ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return r(t.toJSON(),!0);for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)&&r(t[c]))return!0;return!1}var o=n(10),i=Object.prototype.toString,s="function"==typeof e.Blob||"[object BlobConstructor]"===i.call(e.Blob),a="function"==typeof e.File||"[object FileConstructor]"===i.call(e.File);t.exports=r}).call(e,function(){return this}())},function(t,e){t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(t),i=new Uint8Array(n-e),s=e,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},function(t,e){function n(t,e,n){function o(t,r){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=n):0!==o.count||i||e(null,r)}var i=!1;return n=n||r,o.count=t,0===t?e():o}function r(){}t.exports=n},function(t,e,n){var r;(function(t,o){!function(i){function s(t){for(var e,n,r=[],o=0,i=t.length;o<i;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<i?(n=t.charCodeAt(o++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--)):r.push(e);return r}function a(t){for(var e,n=t.length,r=-1,o="";++r<n;)e=t[r],e>65535&&(e-=65536,o+=w(e>>>10&1023|55296),e=56320|1023&e),o+=w(e);return o}function c(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(t,e){return w(t>>e&63|128)}function p(t,e){if(0==(4294967168&t))return w(t);var n="";return 0==(4294965248&t)?n=w(t>>6&31|192):0==(4294901760&t)?(c(t,e)||(t=65533),n=w(t>>12&15|224),n+=u(t,6)):0==(4292870144&t)&&(n=w(t>>18&7|240),n+=u(t,12),n+=u(t,6)),n+=w(63&t|128)}function h(t,e){e=e||{};for(var n,r=!1!==e.strict,o=s(t),i=o.length,a=-1,c="";++a<i;)n=o[a],c+=p(n,r);return c}function f(){if(b>=v)throw Error("Invalid byte index");var t=255&g[b];if(b++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(t){var e,n,r,o,i;if(b>v)throw Error("Invalid byte index");if(b==v)return!1;if(e=255&g[b],b++,0==(128&e))return e;if(192==(224&e)){if(n=f(),i=(31&e)<<6|n,i>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(n=f(),r=f(),i=(15&e)<<12|n<<6|r,i>=2048)return c(i,t)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(n=f(),r=f(),o=f(),i=(7&e)<<18|n<<12|r<<6|o,i>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}function d(t,e){e=e||{};var n=!1!==e.strict;g=s(t),v=g.length,b=0;for(var r,o=[];(r=l(n))!==!1;)o.push(r);return a(o)}var y="object"==typeof e&&e,m=("object"==typeof t&&t&&t.exports==y&&t,"object"==typeof o&&o);m.global!==m&&m.window!==m||(i=m);var g,v,b,w=String.fromCharCode,k={version:"2.1.2",encode:h,decode:d};r=function(){return k}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)}).call(e,n(27)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;e.encode=function(e){var n,r=new Uint8Array(e),o=r.length,i="";for(n=0;n<o;n+=3)i+=t[r[n]>>2],i+=t[(3&r[n])<<4|r[n+1]>>4],i+=t[(15&r[n+1])<<2|r[n+2]>>6],i+=t[63&r[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},e.decode=function(t){var e,r,o,i,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var p=new ArrayBuffer(a),h=new Uint8Array(p);for(e=0;e<c;e+=4)r=n[t.charCodeAt(e)],o=n[t.charCodeAt(e+1)],i=n[t.charCodeAt(e+2)],s=n[t.charCodeAt(e+3)],h[u++]=r<<2|o>>4,h[u++]=(15&o)<<4|i>>2,h[u++]=(3&i)<<6|63&s;return p}}()},function(t,e){(function(e){function n(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}t[e]=r}}}function r(t,e){e=e||{};var r=new i;n(t);for(var o=0;o<t.length;o++)r.append(t[o]);return e.type?r.getBlob(e.type):r.getBlob()}function o(t,e){return n(t),new Blob(t,e||{})}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{var t=new Blob(["hi"]);return 2===t.size}catch(e){return!1}}(),a=s&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return 2===t.size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return s?a?e.Blob:o:c?r:void 0}()}).call(e,function(){return this}())},function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},function(t,e){t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){"use strict";function n(t){var e="";do e=s[t%a]+e,t=Math.floor(t/a);while(t>0);return e}function r(t){var e=0;for(p=0;p<t.length;p++)e=e*a+c[t.charAt(p)];return e}function o(){var t=n(+new Date);return t!==i?(u=0,i=t):t+"."+n(u++)}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,c={},u=0,p=0;p<a;p++)c[s[p]]=p;o.encode=n,o.decode=r,t.exports=o},function(t,e,n){(function(e){function r(){}function o(t){i.call(this,t),this.query=this.query||{},a||(e.___eio||(e.___eio=[]),a=e.___eio),this.index=a.length;var n=this;a.push(function(t){n.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var i=n(19),s=n(31);t.exports=o;var a,c=/\n/g,u=/\\n/g;s(o,i),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},o.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},o.prototype.doWrite=function(t,e){function n(){r(),e()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(t){o.onError("jsonp polling iframe removal error",t)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(t){i=document.createElement("iframe"),i.name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),p=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=p,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),r(),t=t.replace(u,"\\\n"),this.area.value=t.replace(c,"\\n");try{this.form.submit()}catch(h){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(e,function(){return this}())},function(t,e,n){(function(e){function r(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=h&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(l=o),i.call(this,t)}var o,i=n(20),s=n(21),a=n(30),c=n(31),u=n(32),p=n(3)("engine.io-client:websocket"),h=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{o=n(35)}catch(f){}var l=h;l||"undefined"!=typeof window||(l=o),t.exports=r,c(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new l(t,e):new l(t):new l(t,e,n)}catch(r){return this.emit("error",r)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},r.prototype.write=function(t){function n(){r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0)}var r=this;this.writable=!1;for(var o=t.length,i=0,a=o;i<a;i++)!function(t){s.encodePacket(t,r.supportsBinary,function(i){if(!r.usingBrowserWebSocket){var s={};if(t.options&&(s.compress=t.options.compress),r.perMessageDeflate){var a="string"==typeof i?e.Buffer.byteLength(i):i.length;a<r.perMessageDeflate.threshold&&(s.compress=!1)}}try{r.usingBrowserWebSocket?r.ws.send(i):r.ws.send(i,s)}catch(c){p("websocket closed before onclose event")}--o||n()})}(t[i])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},r.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),t=a.encode(t),t.length&&(t="?"+t);var r=this.hostname.indexOf(":")!==-1;return e+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+t},r.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===r.prototype.name)}}).call(e,function(){return this}())},function(t,e){},function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,n){"use strict";function r(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(7),s=n(8),a=n(38),c=n(39),u=n(40),p=n(3)("socket.io-client:socket"),h=n(30),f=n(23);t.exports=e=r;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=s.prototype.emit;s(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[c(t,"open",u(this,"onopen")),c(t,"packet",u(this,"onpacket")),c(t,"close",u(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},r.prototype.send=function(){var t=a(arguments);return t.unshift("message"),this.emit.apply(this,t),this},r.prototype.emit=function(t){if(l.hasOwnProperty(t))return d.apply(this,arguments),this;var e=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:f(e))?i.BINARY_EVENT:i.EVENT,data:e};return n.options={},n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(p("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},r.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},r.prototype.onopen=function(){if(p("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"===o(this.query)?h.encode(this.query):this.query;p("sending connect packet with query %s",t),this.packet({type:i.CONNECT,query:t})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(t){p("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},r.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(t);break;case i.BINARY_EVENT:this.onevent(t);break;case i.ACK:this.onack(t);break;case i.BINARY_ACK:this.onack(t);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",t.data)}},r.prototype.onevent=function(t){var e=t.data||[];p("emitting event %j",e),null!=t.id&&(p("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?d.apply(this,e):this.receiveBuffer.push(e)},r.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var r=a(arguments);p("sending ack %j",r),e.packet({type:f(r)?i.BINARY_ACK:i.ACK,id:t,data:r})}}},r.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(p("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):p("bad ack %s",t.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)d.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){p("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(p("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(t){return this.flags.compress=t,this},r.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){function n(t,e){var n=[];e=e||0;for(var r=e||0;r<t.length;r++)n[r-e]=t[r];return n}t.exports=n},function(t,e){"use strict";function n(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}t.exports=n},function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}},function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}}])});var PushSocketIOProvider=function(config){this.socket=null;this.config=config;this.callbacks={};this.closeTimer=null;this.urlsIndex=null;this.noUrlChange=!1;this.autoReconnect=!0;this.handlers={};this.name='socket.io';this.failConnects=0;this.isConnected=function(){return this.socket&&this.socket.connected};this.isConnecting=function(){return this.socket&&this.socket.io.readyState=='opening'};this.isClosed=function(){return this.socket&&this.socket.io.readyState=='closed'};this.onDisconnect=function(){$(document).trigger('comet:disconnected')};this.addEventListener=function(event,handler){this.handlers[event]=this.handlers[event]||[];this.handlers[event].push(handler)};this.connect=function(){if(this.isConnecting())return;if(this.isConnected()){if(this.socket){this.socket.close();delete(this.socket);this.socket=null}
this.onDisconnect();return}
this.socket=io(config.url,{path:'/sio'});var self=this;this.socket.on('connect',function(){if(self.handlers.open){for(var i=0;i<self.handlers.open.length;i++){self.handlers.open[i].call()}}
for(var c in self.callbacks){if(self.callbacks.hasOwnProperty(c)){self.send("join",c)}}
$(document).trigger('comet:connected')});this.socket.on('sm',function(data){self.runCallbacks(data)});this.socket.on('disconnect',function(){if(self.handlers.close){for(var i=0;i<self.handlers.close.length;i++){self.handlers.close[i].call()}}
self.onDisconnect()});this.socket.on("po",function(data){$(document).trigger('comet:pong',[data])})};this.subscribe=function(channelName,callback){this.callbacks[channelName]=this.callbacks[channelName]||[];this.callbacks[channelName].push(callback);this.send("join",channelName)};this.unsubscribe=function(channelName){this.send("leave",channelName);delete this.callbacks[channelName];this.callbacks[channelName]=[]};this.publish=function(channelName,data){this.send("cm",channelName,data)};this.send=function(action,channel,data){if(this.isConnected()){this.socket.emit(action,{c:channel,d:data})}};this.ping=function(){$(document).trigger('comet:ping');this.send("pi",null,{p:location.href})};this.runCallbacks=function(data){if(data.c&&this.callbacks[data.c]&&this.callbacks[data.c].length){for(var i=0;i<this.callbacks[data.c].length;i++){this.callbacks[data.c][i].call(this,data.d,data.c,data.t)}}};this.close=function(){if(this.socket){this.autoReconnect=!1;this.socket.close()}};this.connect()};!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.SockJS=e()}}(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(global){'use strict';var transportList=require('./transport-list');module.exports=require('./main')(transportList);if('_sockjs_onload' in global){setTimeout(global._sockjs_onload,1)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./main":14,"./transport-list":16}],2:[function(require,module,exports){'use strict';var inherits=require('inherits'),Event=require('./event');function CloseEvent(){Event.call(this);this.initEvent('close',!1,!1);this.wasClean=!1;this.code=0;this.reason=''}
inherits(CloseEvent,Event);module.exports=CloseEvent},{"./event":4,"inherits":57}],3:[function(require,module,exports){'use strict';var inherits=require('inherits'),EventTarget=require('./eventtarget');function EventEmitter(){EventTarget.call(this)}
inherits(EventEmitter,EventTarget);EventEmitter.prototype.removeAllListeners=function(type){if(type){delete this._listeners[type]}else{this._listeners={}}};EventEmitter.prototype.once=function(type,listener){var self=this,fired=!1;function g(){self.removeListener(type,g);if(!fired){fired=!0;listener.apply(this,arguments)}}
this.on(type,g)};EventEmitter.prototype.emit=function(){var type=arguments[0];var listeners=this._listeners[type];if(!listeners){return}
var l=arguments.length;var args=new Array(l-1);for(var ai=1;ai<l;ai++){args[ai-1]=arguments[ai]}
for(var i=0;i<listeners.length;i++){listeners[i].apply(this,args)}};EventEmitter.prototype.on=EventEmitter.prototype.addListener=EventTarget.prototype.addEventListener;EventEmitter.prototype.removeListener=EventTarget.prototype.removeEventListener;module.exports.EventEmitter=EventEmitter},{"./eventtarget":5,"inherits":57}],4:[function(require,module,exports){'use strict';function Event(eventType){this.type=eventType}
Event.prototype.initEvent=function(eventType,canBubble,cancelable){this.type=eventType;this.bubbles=canBubble;this.cancelable=cancelable;this.timeStamp=+new Date();return this};Event.prototype.stopPropagation=function(){};Event.prototype.preventDefault=function(){};Event.CAPTURING_PHASE=1;Event.AT_TARGET=2;Event.BUBBLING_PHASE=3;module.exports=Event},{}],5:[function(require,module,exports){'use strict';function EventTarget(){this._listeners={}}
EventTarget.prototype.addEventListener=function(eventType,listener){if(!(eventType in this._listeners)){this._listeners[eventType]=[]}
var arr=this._listeners[eventType];if(arr.indexOf(listener)===-1){arr=arr.concat([listener])}
this._listeners[eventType]=arr};EventTarget.prototype.removeEventListener=function(eventType,listener){var arr=this._listeners[eventType];if(!arr){return}
var idx=arr.indexOf(listener);if(idx!==-1){if(arr.length>1){this._listeners[eventType]=arr.slice(0,idx).concat(arr.slice(idx+1))}else{delete this._listeners[eventType]}
return}};EventTarget.prototype.dispatchEvent=function(){var event=arguments[0];var t=event.type;var args=arguments.length===1?[event]:Array.apply(null,arguments);if(this['on'+t]){this['on'+t].apply(this,args)}
if(t in this._listeners){var listeners=this._listeners[t];for(var i=0;i<listeners.length;i++){listeners[i].apply(this,args)}}};module.exports=EventTarget},{}],6:[function(require,module,exports){'use strict';var inherits=require('inherits'),Event=require('./event');function TransportMessageEvent(data){Event.call(this);this.initEvent('message',!1,!1);this.data=data}
inherits(TransportMessageEvent,Event);module.exports=TransportMessageEvent},{"./event":4,"inherits":57}],7:[function(require,module,exports){'use strict';var JSON3=require('json3'),iframeUtils=require('./utils/iframe');function FacadeJS(transport){this._transport=transport;transport.on('message',this._transportMessage.bind(this));transport.on('close',this._transportClose.bind(this))}
FacadeJS.prototype._transportClose=function(code,reason){iframeUtils.postMessage('c',JSON3.stringify([code,reason]))};FacadeJS.prototype._transportMessage=function(frame){iframeUtils.postMessage('t',frame)};FacadeJS.prototype._send=function(data){this._transport.send(data)};FacadeJS.prototype._close=function(){this._transport.close();this._transport.removeAllListeners()};module.exports=FacadeJS},{"./utils/iframe":47,"json3":58}],8:[function(require,module,exports){(function(process){'use strict';var urlUtils=require('./utils/url'),eventUtils=require('./utils/event'),JSON3=require('json3'),FacadeJS=require('./facade'),InfoIframeReceiver=require('./info-iframe-receiver'),iframeUtils=require('./utils/iframe'),loc=require('./location');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:iframe-bootstrap')}
module.exports=function(SockJS,availableTransports){var transportMap={};availableTransports.forEach(function(at){if(at.facadeTransport){transportMap[at.facadeTransport.transportName]=at.facadeTransport}});transportMap[InfoIframeReceiver.transportName]=InfoIframeReceiver;var parentOrigin;SockJS.bootstrap_iframe=function(){var facade;iframeUtils.currentWindowId=loc.hash.slice(1);var onMessage=function(e){if(e.source!==parent){return}
if(typeof parentOrigin==='undefined'){parentOrigin=e.origin}
if(e.origin!==parentOrigin){return}
var iframeMessage;try{iframeMessage=JSON3.parse(e.data)}catch(ignored){debug('bad json',e.data);return}
if(iframeMessage.windowId!==iframeUtils.currentWindowId){return}
switch(iframeMessage.type){case 's':var p;try{p=JSON3.parse(iframeMessage.data)}catch(ignored){debug('bad json',iframeMessage.data);break}
var version=p[0];var transport=p[1];var transUrl=p[2];var baseUrl=p[3];debug(version,transport,transUrl,baseUrl);if(version!==SockJS.version){throw new Error('Incompatible SockJS! Main site uses:'+' "'+version+'", the iframe:'+' "'+SockJS.version+'".')}
if(!urlUtils.isOriginEqual(transUrl,loc.href)||!urlUtils.isOriginEqual(baseUrl,loc.href)){throw new Error('Can\'t connect to different domain from within an '+'iframe. ('+loc.href+', '+transUrl+', '+baseUrl+')')}
facade=new FacadeJS(new transportMap[transport](transUrl,baseUrl));break;case 'm':facade._send(iframeMessage.data);break;case 'c':if(facade){facade._close()}
facade=null;break}};eventUtils.attachEvent('message',onMessage);iframeUtils.postMessage('s')}}}).call(this,{env:{}})},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,"debug":54,"json3":58}],9:[function(require,module,exports){(function(process){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits'),JSON3=require('json3'),objectUtils=require('./utils/object');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:info-ajax')}
function InfoAjax(url,AjaxObject){EventEmitter.call(this);var self=this;var t0=+new Date();this.xo=new AjaxObject('GET',url);this.xo.once('finish',function(status,text){var info,rtt;if(status===200){rtt=(+new Date())-t0;if(text){try{info=JSON3.parse(text)}catch(e){debug('bad json',text)}}
if(!objectUtils.isObject(info)){info={}}}
self.emit('finish',info,rtt);self.removeAllListeners()})}
inherits(InfoAjax,EventEmitter);InfoAjax.prototype.close=function(){this.removeAllListeners();this.xo.close()};module.exports=InfoAjax}).call(this,{env:{}})},{"./utils/object":49,"debug":54,"events":3,"inherits":57,"json3":58}],10:[function(require,module,exports){'use strict';var inherits=require('inherits'),EventEmitter=require('events').EventEmitter,JSON3=require('json3'),XHRLocalObject=require('./transport/sender/xhr-local'),InfoAjax=require('./info-ajax');function InfoReceiverIframe(transUrl){var self=this;EventEmitter.call(this);this.ir=new InfoAjax(transUrl,XHRLocalObject);this.ir.once('finish',function(info,rtt){self.ir=null;self.emit('message',JSON3.stringify([info,rtt]))})}
inherits(InfoReceiverIframe,EventEmitter);InfoReceiverIframe.transportName='iframe-info-receiver';InfoReceiverIframe.prototype.close=function(){if(this.ir){this.ir.close();this.ir=null}
this.removeAllListeners()};module.exports=InfoReceiverIframe},{"./info-ajax":9,"./transport/sender/xhr-local":37,"events":3,"inherits":57,"json3":58}],11:[function(require,module,exports){(function(process,global){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits'),JSON3=require('json3'),utils=require('./utils/event'),IframeTransport=require('./transport/iframe'),InfoReceiverIframe=require('./info-iframe-receiver');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:info-iframe')}
function InfoIframe(baseUrl,url){var self=this;EventEmitter.call(this);var go=function(){var ifr=self.ifr=new IframeTransport(InfoReceiverIframe.transportName,url,baseUrl);ifr.once('message',function(msg){if(msg){var d;try{d=JSON3.parse(msg)}catch(e){debug('bad json',msg);self.emit('finish');self.close();return}
var info=d[0],rtt=d[1];self.emit('finish',info,rtt)}
self.close()});ifr.once('close',function(){self.emit('finish');self.close()})};if(!global.document.body){utils.attachEvent('load',go)}else{go()}}
inherits(InfoIframe,EventEmitter);InfoIframe.enabled=function(){return IframeTransport.enabled()};InfoIframe.prototype.close=function(){if(this.ifr){this.ifr.close()}
this.removeAllListeners();this.ifr=null};module.exports=InfoIframe}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,"debug":54,"events":3,"inherits":57,"json3":58}],12:[function(require,module,exports){(function(process){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits'),urlUtils=require('./utils/url'),XDR=require('./transport/sender/xdr'),XHRCors=require('./transport/sender/xhr-cors'),XHRLocal=require('./transport/sender/xhr-local'),XHRFake=require('./transport/sender/xhr-fake'),InfoIframe=require('./info-iframe'),InfoAjax=require('./info-ajax');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:info-receiver')}
function InfoReceiver(baseUrl,urlInfo){debug(baseUrl);var self=this;EventEmitter.call(this);setTimeout(function(){self.doXhr(baseUrl,urlInfo)},0)}
inherits(InfoReceiver,EventEmitter);InfoReceiver._getReceiver=function(baseUrl,url,urlInfo){if(urlInfo.sameOrigin){return new InfoAjax(url,XHRLocal)}
if(XHRCors.enabled){return new InfoAjax(url,XHRCors)}
if(XDR.enabled&&urlInfo.sameScheme){return new InfoAjax(url,XDR)}
if(InfoIframe.enabled()){return new InfoIframe(baseUrl,url)}
return new InfoAjax(url,XHRFake)};InfoReceiver.prototype.doXhr=function(baseUrl,urlInfo){var self=this,url=urlUtils.addPath(baseUrl,'/info');debug('doXhr',url);this.xo=InfoReceiver._getReceiver(baseUrl,url,urlInfo);this.timeoutRef=setTimeout(function(){debug('timeout');self._cleanup(!1);self.emit('finish')},InfoReceiver.timeout);this.xo.once('finish',function(info,rtt){debug('finish',info,rtt);self._cleanup(!0);self.emit('finish',info,rtt)})};InfoReceiver.prototype._cleanup=function(wasClean){debug('_cleanup');clearTimeout(this.timeoutRef);this.timeoutRef=null;if(!wasClean&&this.xo){this.xo.close()}
this.xo=null};InfoReceiver.prototype.close=function(){debug('close');this.removeAllListeners();this._cleanup(!1)};InfoReceiver.timeout=8000;module.exports=InfoReceiver}).call(this,{env:{}})},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,"debug":54,"events":3,"inherits":57}],13:[function(require,module,exports){(function(global){'use strict';module.exports=global.location||{origin:'http://localhost:80',protocol:'http',host:'localhost',port:80,href:'http://localhost/',hash:''}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],14:[function(require,module,exports){(function(process,global){'use strict';require('./shims');var URL=require('url-parse'),inherits=require('inherits'),JSON3=require('json3'),random=require('./utils/random'),escape=require('./utils/escape'),urlUtils=require('./utils/url'),eventUtils=require('./utils/event'),transport=require('./utils/transport'),objectUtils=require('./utils/object'),browser=require('./utils/browser'),log=require('./utils/log'),Event=require('./event/event'),EventTarget=require('./event/eventtarget'),loc=require('./location'),CloseEvent=require('./event/close'),TransportMessageEvent=require('./event/trans-message'),InfoReceiver=require('./info-receiver');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:main')}
var transports;function SockJS(url,protocols,options){if(!(this instanceof SockJS)){return new SockJS(url,protocols,options)}
if(arguments.length<1){throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present")}
EventTarget.call(this);this.readyState=SockJS.CONNECTING;this.extensions='';this.protocol='';options=options||{};if(options.protocols_whitelist){log.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead.")}
this._transportsWhitelist=options.transports;this._transportOptions=options.transportOptions||{};var sessionId=options.sessionId||8;if(typeof sessionId==='function'){this._generateSessionId=sessionId}else if(typeof sessionId==='number'){this._generateSessionId=function(){return random.string(sessionId)}}else{throw new TypeError('If sessionId is used in the options, it needs to be a number or a function.')}
this._server=options.server||random.numberString(1000);var parsedUrl=new URL(url);if(!parsedUrl.host||!parsedUrl.protocol){throw new SyntaxError("The URL '"+url+"' is invalid")}else if(parsedUrl.hash){throw new SyntaxError('The URL must not contain a fragment')}else if(parsedUrl.protocol!=='http:'&&parsedUrl.protocol!=='https:'){throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+parsedUrl.protocol+"' is not allowed.")}
var secure=parsedUrl.protocol==='https:';if(loc.protocol==='https'&&!secure){throw new Error('SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS')}
if(!protocols){protocols=[]}else if(!Array.isArray(protocols)){protocols=[protocols]}
var sortedProtocols=protocols.sort();sortedProtocols.forEach(function(proto,i){if(!proto){throw new SyntaxError("The protocols entry '"+proto+"' is invalid.")}
if(i<(sortedProtocols.length-1)&&proto===sortedProtocols[i+1]){throw new SyntaxError("The protocols entry '"+proto+"' is duplicated.")}});var o=urlUtils.getOrigin(loc.href);this._origin=o?o.toLowerCase():null;parsedUrl.set('pathname',parsedUrl.pathname.replace(/\/+$/,''));this.url=parsedUrl.href;debug('using url',this.url);this._urlInfo={nullOrigin:!browser.hasDomain(),sameOrigin:urlUtils.isOriginEqual(this.url,loc.href),sameScheme:urlUtils.isSchemeEqual(this.url,loc.href)};this._ir=new InfoReceiver(this.url,this._urlInfo);this._ir.once('finish',this._receiveInfo.bind(this))}
inherits(SockJS,EventTarget);function userSetCode(code){return code===1000||(code>=3000&&code<=4999)}
SockJS.prototype.close=function(code,reason){if(code&&!userSetCode(code)){throw new Error('InvalidAccessError: Invalid code')}
if(reason&&reason.length>123){throw new SyntaxError('reason argument has an invalid length')}
if(this.readyState===SockJS.CLOSING||this.readyState===SockJS.CLOSED){return}
var wasClean=!0;this._close(code||1000,reason||'Normal closure',wasClean)};SockJS.prototype.send=function(data){if(typeof data!=='string'){data=''+data}
if(this.readyState===SockJS.CONNECTING){throw new Error('InvalidStateError: The connection has not been established yet')}
if(this.readyState!==SockJS.OPEN){return}
this._transport.send(escape.quote(data))};SockJS.version=require('./version');SockJS.CONNECTING=0;SockJS.OPEN=1;SockJS.CLOSING=2;SockJS.CLOSED=3;SockJS.prototype._receiveInfo=function(info,rtt){debug('_receiveInfo',rtt);this._ir=null;if(!info){this._close(1002,'Cannot connect to server');return}
this._rto=this.countRTO(rtt);this._transUrl=info.base_url?info.base_url:this.url;info=objectUtils.extend(info,this._urlInfo);debug('info',info);var enabledTransports=transports.filterToEnabled(this._transportsWhitelist,info);this._transports=enabledTransports.main;debug(this._transports.length+' enabled transports');this._connect()};SockJS.prototype._connect=function(){for(var Transport=this._transports.shift();Transport;Transport=this._transports.shift()){debug('attempt',Transport.transportName);if(Transport.needBody){if(!global.document.body||(typeof global.document.readyState!=='undefined'&&global.document.readyState!=='complete'&&global.document.readyState!=='interactive')){debug('waiting for body');this._transports.unshift(Transport);eventUtils.attachEvent('load',this._connect.bind(this));return}}
var timeoutMs=(this._rto*Transport.roundTrips)||5000;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),timeoutMs);debug('using timeout',timeoutMs);var transportUrl=urlUtils.addPath(this._transUrl,'/'+this._server+'/'+this._generateSessionId());var options=this._transportOptions[Transport.transportName];debug('transport url',transportUrl);var transportObj=new Transport(transportUrl,this._transUrl,options);transportObj.on('message',this._transportMessage.bind(this));transportObj.once('close',this._transportClose.bind(this));transportObj.transportName=Transport.transportName;this._transport=transportObj;return}
this._close(2000,'All transports failed',!1)};SockJS.prototype._transportTimeout=function(){debug('_transportTimeout');if(this.readyState===SockJS.CONNECTING){this._transportClose(2007,'Transport timed out')}};SockJS.prototype._transportMessage=function(msg){debug('_transportMessage',msg);var self=this,type=msg.slice(0,1),content=msg.slice(1),payload;switch(type){case 'o':this._open();return;case 'h':this.dispatchEvent(new Event('heartbeat'));debug('heartbeat',this.transport);return}
if(content){try{payload=JSON3.parse(content)}catch(e){debug('bad json',content)}}
if(typeof payload==='undefined'){debug('empty payload',content);return}
switch(type){case 'a':if(Array.isArray(payload)){payload.forEach(function(p){debug('message',self.transport,p);self.dispatchEvent(new TransportMessageEvent(p))})}
break;case 'm':debug('message',this.transport,payload);this.dispatchEvent(new TransportMessageEvent(payload));break;case 'c':if(Array.isArray(payload)&&payload.length===2){this._close(payload[0],payload[1],!0)}
break}};SockJS.prototype._transportClose=function(code,reason){debug('_transportClose',this.transport,code,reason);if(this._transport){this._transport.removeAllListeners();this._transport=null;this.transport=null}
if(!userSetCode(code)&&code!==2000&&this.readyState===SockJS.CONNECTING){this._connect();return}
this._close(code,reason)};SockJS.prototype._open=function(){debug('_open',this._transport.transportName,this.readyState);if(this.readyState===SockJS.CONNECTING){if(this._transportTimeoutId){clearTimeout(this._transportTimeoutId);this._transportTimeoutId=null}
this.readyState=SockJS.OPEN;this.transport=this._transport.transportName;this.dispatchEvent(new Event('open'));debug('connected',this.transport)}else{this._close(1006,'Server lost session')}};SockJS.prototype._close=function(code,reason,wasClean){debug('_close',this.transport,code,reason,wasClean,this.readyState);var forceFail=!1;if(this._ir){forceFail=!0;this._ir.close();this._ir=null}
if(this._transport){this._transport.close();this._transport=null;this.transport=null}
if(this.readyState===SockJS.CLOSED){throw new Error('InvalidStateError: SockJS has already been closed')}
this.readyState=SockJS.CLOSING;setTimeout(function(){this.readyState=SockJS.CLOSED;if(forceFail){this.dispatchEvent(new Event('error'))}
var e=new CloseEvent('close');e.wasClean=wasClean||!1;e.code=code||1000;e.reason=reason;this.dispatchEvent(e);this.onmessage=this.onclose=this.onerror=null;debug('disconnected')}.bind(this),0)};SockJS.prototype.countRTO=function(rtt){if(rtt>100){return 4*rtt}
return 300+rtt};module.exports=function(availableTransports){transports=transport(availableTransports);require('./iframe-bootstrap')(SockJS,availableTransports);return SockJS}}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,"debug":54,"inherits":57,"json3":58,"url-parse":59}],15:[function(require,module,exports){'use strict';var ArrayPrototype=Array.prototype;var ObjectPrototype=Object.prototype;var FunctionPrototype=Function.prototype;var StringPrototype=String.prototype;var array_slice=ArrayPrototype.slice;var _toString=ObjectPrototype.toString;var isFunction=function(val){return ObjectPrototype.toString.call(val)==='[object Function]'};var isArray=function isArray(obj){return _toString.call(obj)==='[object Array]'};var isString=function isString(obj){return _toString.call(obj)==='[object String]'};var supportsDescriptors=Object.defineProperty&&(function(){try{Object.defineProperty({},'x',{});return!0}catch(e){return!1}}());var defineProperty;if(supportsDescriptors){defineProperty=function(object,name,method,forceAssign){if(!forceAssign&&(name in object)){return}
Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:method})}}else{defineProperty=function(object,name,method,forceAssign){if(!forceAssign&&(name in object)){return}
object[name]=method}}
var defineProperties=function(object,map,forceAssign){for(var name in map){if(ObjectPrototype.hasOwnProperty.call(map,name)){defineProperty(object,name,map[name],forceAssign)}}};var toObject=function(o){if(o==null){throw new TypeError("can't convert "+o+' to object')}
return Object(o)};function toInteger(num){var n=+num;if(n!==n){n=0}else if(n!==0&&n!==(1/0)&&n!==-(1/0)){n=(n>0||-1)*Math.floor(Math.abs(n))}
return n}
function ToUint32(x){return x>>>0}
function Empty(){}
defineProperties(FunctionPrototype,{bind:function bind(that){var target=this;if(!isFunction(target)){throw new TypeError('Function.prototype.bind called on incompatible '+target)}
var args=array_slice.call(arguments,1);var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(array_slice.call(arguments)));if(Object(result)===result){return result}
return this}else{return target.apply(that,args.concat(array_slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push('$'+i)}
var bound=Function('binder','return function ('+boundArgs.join(',')+'){ return binder.apply(this, arguments); }')(binder);if(target.prototype){Empty.prototype=target.prototype;bound.prototype=new Empty();Empty.prototype=null}
return bound}});defineProperties(Array,{isArray:isArray});var boxedString=Object('a');var splitString=boxedString[0]!=='a'||!(0 in boxedString);var properlyBoxesContext=function properlyBoxed(method){var properlyBoxesNonStrict=!0;var properlyBoxesStrict=!0;if(method){method.call('foo',function(_,__,context){if(typeof context!=='object'){properlyBoxesNonStrict=!1}});method.call([1],function(){'use strict';properlyBoxesStrict=typeof this==='string'},'x')}
return!!method&&properlyBoxesNonStrict&&properlyBoxesStrict};defineProperties(ArrayPrototype,{forEach:function forEach(fun){var object=toObject(this),self=splitString&&isString(this)?this.split(''):object,thisp=arguments[1],i=-1,length=self.length>>>0;if(!isFunction(fun)){throw new TypeError()}
while(++i<length){if(i in self){fun.call(thisp,self[i],i,object)}}}},!properlyBoxesContext(ArrayPrototype.forEach));var hasFirefox2IndexOfBug=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;defineProperties(ArrayPrototype,{indexOf:function indexOf(sought){var self=splitString&&isString(this)?this.split(''):toObject(this),length=self.length>>>0;if(!length){return-1}
var i=0;if(arguments.length>1){i=toInteger(arguments[1])}
i=i>=0?i:Math.max(0,length+i);for(;i<length;i++){if(i in self&&self[i]===sought){return i}}
return-1}},hasFirefox2IndexOfBug);var string_split=StringPrototype.split;if('ab'.split(/(?:ab)*/).length!==2||'.'.split(/(.?)(.?)/).length!==4||'tesst'.split(/(s)*/)[1]==='t'||'test'.split(/(?:)/,-1).length!==4||''.split(/.?/).length||'.'.split(/()()/).length>1){(function(){var compliantExecNpcg=/()??/.exec('')[1]===void 0;StringPrototype.split=function(separator,limit){var string=this;if(separator===void 0&&limit===0){return[]}
if(_toString.call(separator)!=='[object RegExp]'){return string_split.call(this,separator,limit)}
var output=[],flags=(separator.ignoreCase?'i':'')+(separator.multiline?'m':'')+(separator.extended?'x':'')+(separator.sticky?'y':''),lastLastIndex=0,separator2,match,lastIndex,lastLength;separator=new RegExp(separator.source,flags+'g');string+='';if(!compliantExecNpcg){separator2=new RegExp('^'+separator.source+'$(?!\\s)',flags)}
limit=limit===void 0?-1>>>0:ToUint32(limit);while(match=separator.exec(string)){lastIndex=match.index+match[0].length;if(lastIndex>lastLastIndex){output.push(string.slice(lastLastIndex,match.index));if(!compliantExecNpcg&&match.length>1){match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++){if(arguments[i]===void 0){match[i]=void 0}}})}
if(match.length>1&&match.index<string.length){ArrayPrototype.push.apply(output,match.slice(1))}
lastLength=match[0].length;lastLastIndex=lastIndex;if(output.length>=limit){break}}
if(separator.lastIndex===match.index){separator.lastIndex++}}
if(lastLastIndex===string.length){if(lastLength||!separator.test('')){output.push('')}}else{output.push(string.slice(lastLastIndex))}
return output.length>limit?output.slice(0,limit):output}}())}else if('0'.split(void 0,0).length){StringPrototype.split=function split(separator,limit){if(separator===void 0&&limit===0){return[]}
return string_split.call(this,separator,limit)}}
var ws='\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003'+'\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028'+'\u2029\uFEFF';var zeroWidth='\u200b';var wsRegexChars='['+ws+']';var trimBeginRegexp=new RegExp('^'+wsRegexChars+wsRegexChars+'*');var trimEndRegexp=new RegExp(wsRegexChars+wsRegexChars+'*$');var hasTrimWhitespaceBug=StringPrototype.trim&&(ws.trim()||!zeroWidth.trim());defineProperties(StringPrototype,{trim:function trim(){if(this===void 0||this===null){throw new TypeError("can't convert "+this+' to object')}
return String(this).replace(trimBeginRegexp,'').replace(trimEndRegexp,'')}},hasTrimWhitespaceBug);var string_substr=StringPrototype.substr;var hasNegativeSubstrBug=''.substr&&'0b'.substr(-1)!=='b';defineProperties(StringPrototype,{substr:function substr(start,length){return string_substr.call(this,start<0?((start=this.length+start)<0?0:start):start,length)}},hasNegativeSubstrBug)},{}],16:[function(require,module,exports){'use strict';module.exports=[require('./transport/websocket'),require('./transport/xhr-streaming'),require('./transport/xdr-streaming'),require('./transport/eventsource'),require('./transport/lib/iframe-wrap')(require('./transport/eventsource')),require('./transport/htmlfile'),require('./transport/lib/iframe-wrap')(require('./transport/htmlfile')),require('./transport/xhr-polling'),require('./transport/xdr-polling'),require('./transport/lib/iframe-wrap')(require('./transport/xhr-polling')),require('./transport/jsonp-polling')]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(require,module,exports){(function(process,global){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits'),utils=require('../../utils/event'),urlUtils=require('../../utils/url'),XHR=global.XMLHttpRequest;var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:browser:xhr')}
function AbstractXHRObject(method,url,payload,opts){debug(method,url);var self=this;EventEmitter.call(this);setTimeout(function(){self._start(method,url,payload,opts)},0)}
inherits(AbstractXHRObject,EventEmitter);AbstractXHRObject.prototype._start=function(method,url,payload,opts){var self=this;try{this.xhr=new XHR()}catch(x){}
if(!this.xhr){debug('no xhr');this.emit('finish',0,'no xhr support');this._cleanup();return}
url=urlUtils.addQuery(url,'t='+(+new Date()));this.unloadRef=utils.unloadAdd(function(){debug('unload cleanup');self._cleanup(!0)});try{this.xhr.open(method,url,!0);if(this.timeout&&'timeout' in this.xhr){this.xhr.timeout=this.timeout;this.xhr.ontimeout=function(){debug('xhr timeout');self.emit('finish',0,'');self._cleanup(!1)}}}catch(e){debug('exception',e);this.emit('finish',0,'');this._cleanup(!1);return}
if((!opts||!opts.noCredentials)&&AbstractXHRObject.supportsCORS){debug('withCredentials');this.xhr.withCredentials='true'}
if(opts&&opts.headers){for(var key in opts.headers){this.xhr.setRequestHeader(key,opts.headers[key])}}
this.xhr.onreadystatechange=function(){if(self.xhr){var x=self.xhr;var text,status;debug('readyState',x.readyState);switch(x.readyState){case 3:try{status=x.status;text=x.responseText}catch(e){}
debug('status',status);if(status===1223){status=204}
if(status===200&&text&&text.length>0){debug('chunk');self.emit('chunk',status,text)}
break;case 4:status=x.status;debug('status',status);if(status===1223){status=204}
if(status===12005||status===12029){status=0}
debug('finish',status,x.responseText);self.emit('finish',status,x.responseText);self._cleanup(!1);break}}};try{self.xhr.send(payload)}catch(e){self.emit('finish',0,'');self._cleanup(!1)}};AbstractXHRObject.prototype._cleanup=function(abort){debug('cleanup');if(!this.xhr){return}
this.removeAllListeners();utils.unloadDel(this.unloadRef);this.xhr.onreadystatechange=function(){};if(this.xhr.ontimeout){this.xhr.ontimeout=null}
if(abort){try{this.xhr.abort()}catch(x){}}
this.unloadRef=this.xhr=null};AbstractXHRObject.prototype.close=function(){debug('close');this._cleanup(!0)};AbstractXHRObject.enabled=!!XHR;var axo=['Active'].concat('Object').join('X');if(!AbstractXHRObject.enabled&&(axo in global)){debug('overriding xmlhttprequest');XHR=function(){try{return new global[axo]('Microsoft.XMLHTTP')}catch(e){return null}};AbstractXHRObject.enabled=!!new XHR()}
var cors=!1;try{cors='withCredentials' in new XHR()}catch(ignored){}
AbstractXHRObject.supportsCORS=cors;module.exports=AbstractXHRObject}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/event":46,"../../utils/url":52,"debug":54,"events":3,"inherits":57}],18:[function(require,module,exports){(function(global){module.exports=global.EventSource}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],19:[function(require,module,exports){(function(global){'use strict';var Driver=global.WebSocket||global.MozWebSocket;if(Driver){module.exports=function WebSocketBrowserDriver(url){return new Driver(url)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],20:[function(require,module,exports){'use strict';var inherits=require('inherits'),AjaxBasedTransport=require('./lib/ajax-based'),EventSourceReceiver=require('./receiver/eventsource'),XHRCorsObject=require('./sender/xhr-cors'),EventSourceDriver=require('eventsource');function EventSourceTransport(transUrl){if(!EventSourceTransport.enabled()){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/eventsource',EventSourceReceiver,XHRCorsObject)}
inherits(EventSourceTransport,AjaxBasedTransport);EventSourceTransport.enabled=function(){return!!EventSourceDriver};EventSourceTransport.transportName='eventsource';EventSourceTransport.roundTrips=2;module.exports=EventSourceTransport},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,"eventsource":18,"inherits":57}],21:[function(require,module,exports){'use strict';var inherits=require('inherits'),HtmlfileReceiver=require('./receiver/htmlfile'),XHRLocalObject=require('./sender/xhr-local'),AjaxBasedTransport=require('./lib/ajax-based');function HtmlFileTransport(transUrl){if(!HtmlfileReceiver.enabled){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/htmlfile',HtmlfileReceiver,XHRLocalObject)}
inherits(HtmlFileTransport,AjaxBasedTransport);HtmlFileTransport.enabled=function(info){return HtmlfileReceiver.enabled&&info.sameOrigin};HtmlFileTransport.transportName='htmlfile';HtmlFileTransport.roundTrips=2;module.exports=HtmlFileTransport},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,"inherits":57}],22:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),JSON3=require('json3'),EventEmitter=require('events').EventEmitter,version=require('../version'),urlUtils=require('../utils/url'),iframeUtils=require('../utils/iframe'),eventUtils=require('../utils/event'),random=require('../utils/random');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:transport:iframe')}
function IframeTransport(transport,transUrl,baseUrl){if(!IframeTransport.enabled()){throw new Error('Transport created when disabled')}
EventEmitter.call(this);var self=this;this.origin=urlUtils.getOrigin(baseUrl);this.baseUrl=baseUrl;this.transUrl=transUrl;this.transport=transport;this.windowId=random.string(8);var iframeUrl=urlUtils.addPath(baseUrl,'/iframe.html')+'#'+this.windowId;debug(transport,transUrl,iframeUrl);this.iframeObj=iframeUtils.createIframe(iframeUrl,function(r){debug('err callback');self.emit('close',1006,'Unable to load an iframe ('+r+')');self.close()});this.onmessageCallback=this._message.bind(this);eventUtils.attachEvent('message',this.onmessageCallback)}
inherits(IframeTransport,EventEmitter);IframeTransport.prototype.close=function(){debug('close');this.removeAllListeners();if(this.iframeObj){eventUtils.detachEvent('message',this.onmessageCallback);try{this.postMessage('c')}catch(x){}
this.iframeObj.cleanup();this.iframeObj=null;this.onmessageCallback=this.iframeObj=null}};IframeTransport.prototype._message=function(e){debug('message',e.data);if(!urlUtils.isOriginEqual(e.origin,this.origin)){debug('not same origin',e.origin,this.origin);return}
var iframeMessage;try{iframeMessage=JSON3.parse(e.data)}catch(ignored){debug('bad json',e.data);return}
if(iframeMessage.windowId!==this.windowId){debug('mismatched window id',iframeMessage.windowId,this.windowId);return}
switch(iframeMessage.type){case 's':this.iframeObj.loaded();this.postMessage('s',JSON3.stringify([version,this.transport,this.transUrl,this.baseUrl]));break;case 't':this.emit('message',iframeMessage.data);break;case 'c':var cdata;try{cdata=JSON3.parse(iframeMessage.data)}catch(ignored){debug('bad json',iframeMessage.data);return}
this.emit('close',cdata[0],cdata[1]);this.close();break}};IframeTransport.prototype.postMessage=function(type,data){debug('postMessage',type,data);this.iframeObj.post(JSON3.stringify({windowId:this.windowId,type:type,data:data||''}),this.origin)};IframeTransport.prototype.send=function(message){debug('send',message);this.postMessage('m',message)};IframeTransport.enabled=function(){return iframeUtils.iframeEnabled};IframeTransport.transportName='iframe';IframeTransport.roundTrips=2;module.exports=IframeTransport}).call(this,{env:{}})},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,"debug":54,"events":3,"inherits":57,"json3":58}],23:[function(require,module,exports){(function(global){'use strict';var inherits=require('inherits'),SenderReceiver=require('./lib/sender-receiver'),JsonpReceiver=require('./receiver/jsonp'),jsonpSender=require('./sender/jsonp');function JsonPTransport(transUrl){if(!JsonPTransport.enabled()){throw new Error('Transport created when disabled')}
SenderReceiver.call(this,transUrl,'/jsonp',jsonpSender,JsonpReceiver)}
inherits(JsonPTransport,SenderReceiver);JsonPTransport.enabled=function(){return!!global.document};JsonPTransport.transportName='jsonp-polling';JsonPTransport.roundTrips=1;JsonPTransport.needBody=!0;module.exports=JsonPTransport}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,"inherits":57}],24:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),urlUtils=require('../../utils/url'),SenderReceiver=require('./sender-receiver');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:ajax-based')}
function createAjaxSender(AjaxObject){return function(url,payload,callback){debug('create ajax sender',url,payload);var opt={};if(typeof payload==='string'){opt.headers={'Content-type':'text/plain'}}
var ajaxUrl=urlUtils.addPath(url,'/xhr_send');var xo=new AjaxObject('POST',ajaxUrl,payload,opt);xo.once('finish',function(status){debug('finish',status);xo=null;if(status!==200&&status!==204){return callback(new Error('http status '+status))}
callback()});return function(){debug('abort');xo.close();xo=null;var err=new Error('Aborted');err.code=1000;callback(err)}}}
function AjaxBasedTransport(transUrl,urlSuffix,Receiver,AjaxObject){SenderReceiver.call(this,transUrl,urlSuffix,createAjaxSender(AjaxObject),Receiver,AjaxObject)}
inherits(AjaxBasedTransport,SenderReceiver);module.exports=AjaxBasedTransport}).call(this,{env:{}})},{"../../utils/url":52,"./sender-receiver":28,"debug":54,"inherits":57}],25:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),EventEmitter=require('events').EventEmitter;var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:buffered-sender')}
function BufferedSender(url,sender){debug(url);EventEmitter.call(this);this.sendBuffer=[];this.sender=sender;this.url=url}
inherits(BufferedSender,EventEmitter);BufferedSender.prototype.send=function(message){debug('send',message);this.sendBuffer.push(message);if(!this.sendStop){this.sendSchedule()}};BufferedSender.prototype.sendScheduleWait=function(){debug('sendScheduleWait');var self=this;var tref;this.sendStop=function(){debug('sendStop');self.sendStop=null;clearTimeout(tref)};tref=setTimeout(function(){debug('timeout');self.sendStop=null;self.sendSchedule()},25)};BufferedSender.prototype.sendSchedule=function(){debug('sendSchedule',this.sendBuffer.length);var self=this;if(this.sendBuffer.length>0){var payload='['+this.sendBuffer.join(',')+']';this.sendStop=this.sender(this.url,payload,function(err){self.sendStop=null;if(err){debug('error',err);self.emit('close',err.code||1006,'Sending error: '+err);self._cleanup()}else{self.sendScheduleWait()}});this.sendBuffer=[]}};BufferedSender.prototype._cleanup=function(){debug('_cleanup');this.removeAllListeners()};BufferedSender.prototype.stop=function(){debug('stop');this._cleanup();if(this.sendStop){this.sendStop();this.sendStop=null}};module.exports=BufferedSender}).call(this,{env:{}})},{"debug":54,"events":3,"inherits":57}],26:[function(require,module,exports){(function(global){'use strict';var inherits=require('inherits'),IframeTransport=require('../iframe'),objectUtils=require('../../utils/object');module.exports=function(transport){function IframeWrapTransport(transUrl,baseUrl){IframeTransport.call(this,transport.transportName,transUrl,baseUrl)}
inherits(IframeWrapTransport,IframeTransport);IframeWrapTransport.enabled=function(url,info){if(!global.document){return!1}
var iframeInfo=objectUtils.extend({},info);iframeInfo.sameOrigin=!0;return transport.enabled(iframeInfo)&&IframeTransport.enabled()};IframeWrapTransport.transportName='iframe-'+transport.transportName;IframeWrapTransport.needBody=!0;IframeWrapTransport.roundTrips=IframeTransport.roundTrips+transport.roundTrips-1;IframeWrapTransport.facadeTransport=transport;return IframeWrapTransport}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/object":49,"../iframe":22,"inherits":57}],27:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),EventEmitter=require('events').EventEmitter;var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:polling')}
function Polling(Receiver,receiveUrl,AjaxObject){debug(receiveUrl);EventEmitter.call(this);this.Receiver=Receiver;this.receiveUrl=receiveUrl;this.AjaxObject=AjaxObject;this._scheduleReceiver()}
inherits(Polling,EventEmitter);Polling.prototype._scheduleReceiver=function(){debug('_scheduleReceiver');var self=this;var poll=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);poll.on('message',function(msg){debug('message',msg);self.emit('message',msg)});poll.once('close',function(code,reason){debug('close',code,reason,self.pollIsClosing);self.poll=poll=null;if(!self.pollIsClosing){if(reason==='network'){self._scheduleReceiver()}else{self.emit('close',code||1006,reason);self.removeAllListeners()}}})};Polling.prototype.abort=function(){debug('abort');this.removeAllListeners();this.pollIsClosing=!0;if(this.poll){this.poll.abort()}};module.exports=Polling}).call(this,{env:{}})},{"debug":54,"events":3,"inherits":57}],28:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),urlUtils=require('../../utils/url'),BufferedSender=require('./buffered-sender'),Polling=require('./polling');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:sender-receiver')}
function SenderReceiver(transUrl,urlSuffix,senderFunc,Receiver,AjaxObject){var pollUrl=urlUtils.addPath(transUrl,urlSuffix);debug(pollUrl);var self=this;BufferedSender.call(this,transUrl,senderFunc);this.poll=new Polling(Receiver,pollUrl,AjaxObject);this.poll.on('message',function(msg){debug('poll message',msg);self.emit('message',msg)});this.poll.once('close',function(code,reason){debug('poll close',code,reason);self.poll=null;self.emit('close',code,reason);self.close()})}
inherits(SenderReceiver,BufferedSender);SenderReceiver.prototype.close=function(){debug('close');this.removeAllListeners();if(this.poll){this.poll.abort();this.poll=null}
this.stop()};module.exports=SenderReceiver}).call(this,{env:{}})},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,"debug":54,"inherits":57}],29:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),EventEmitter=require('events').EventEmitter,EventSourceDriver=require('eventsource');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:receiver:eventsource')}
function EventSourceReceiver(url){debug(url);EventEmitter.call(this);var self=this;var es=this.es=new EventSourceDriver(url);es.onmessage=function(e){debug('message',e.data);self.emit('message',decodeURI(e.data))};es.onerror=function(e){debug('error',es.readyState,e);var reason=(es.readyState!==2?'network':'permanent');self._cleanup();self._close(reason)}}
inherits(EventSourceReceiver,EventEmitter);EventSourceReceiver.prototype.abort=function(){debug('abort');this._cleanup();this._close('user')};EventSourceReceiver.prototype._cleanup=function(){debug('cleanup');var es=this.es;if(es){es.onmessage=es.onerror=null;es.close();this.es=null}};EventSourceReceiver.prototype._close=function(reason){debug('close',reason);var self=this;setTimeout(function(){self.emit('close',null,reason);self.removeAllListeners()},200)};module.exports=EventSourceReceiver}).call(this,{env:{}})},{"debug":54,"events":3,"eventsource":18,"inherits":57}],30:[function(require,module,exports){(function(process,global){'use strict';var inherits=require('inherits'),iframeUtils=require('../../utils/iframe'),urlUtils=require('../../utils/url'),EventEmitter=require('events').EventEmitter,random=require('../../utils/random');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:receiver:htmlfile')}
function HtmlfileReceiver(url){debug(url);EventEmitter.call(this);var self=this;iframeUtils.polluteGlobalNamespace();this.id='a'+random.string(6);url=urlUtils.addQuery(url,'c='+decodeURIComponent(iframeUtils.WPrefix+'.'+this.id));debug('using htmlfile',HtmlfileReceiver.htmlfileEnabled);var constructFunc=HtmlfileReceiver.htmlfileEnabled?iframeUtils.createHtmlfile:iframeUtils.createIframe;global[iframeUtils.WPrefix][this.id]={start:function(){debug('start');self.iframeObj.loaded()},message:function(data){debug('message',data);self.emit('message',data)},stop:function(){debug('stop');self._cleanup();self._close('network')}};this.iframeObj=constructFunc(url,function(){debug('callback');self._cleanup();self._close('permanent')})}
inherits(HtmlfileReceiver,EventEmitter);HtmlfileReceiver.prototype.abort=function(){debug('abort');this._cleanup();this._close('user')};HtmlfileReceiver.prototype._cleanup=function(){debug('_cleanup');if(this.iframeObj){this.iframeObj.cleanup();this.iframeObj=null}
delete global[iframeUtils.WPrefix][this.id]};HtmlfileReceiver.prototype._close=function(reason){debug('_close',reason);this.emit('close',null,reason);this.removeAllListeners()};HtmlfileReceiver.htmlfileEnabled=!1;var axo=['Active'].concat('Object').join('X');if(axo in global){try{HtmlfileReceiver.htmlfileEnabled=!!new global[axo]('htmlfile')}catch(x){}}
HtmlfileReceiver.enabled=HtmlfileReceiver.htmlfileEnabled||iframeUtils.iframeEnabled;module.exports=HtmlfileReceiver}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,"debug":54,"events":3,"inherits":57}],31:[function(require,module,exports){(function(process,global){'use strict';var utils=require('../../utils/iframe'),random=require('../../utils/random'),browser=require('../../utils/browser'),urlUtils=require('../../utils/url'),inherits=require('inherits'),EventEmitter=require('events').EventEmitter;var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:receiver:jsonp')}
function JsonpReceiver(url){debug(url);var self=this;EventEmitter.call(this);utils.polluteGlobalNamespace();this.id='a'+random.string(6);var urlWithId=urlUtils.addQuery(url,'c='+encodeURIComponent(utils.WPrefix+'.'+this.id));global[utils.WPrefix][this.id]=this._callback.bind(this);this._createScript(urlWithId);this.timeoutId=setTimeout(function(){debug('timeout');self._abort(new Error('JSONP script loaded abnormally (timeout)'))},JsonpReceiver.timeout)}
inherits(JsonpReceiver,EventEmitter);JsonpReceiver.prototype.abort=function(){debug('abort');if(global[utils.WPrefix][this.id]){var err=new Error('JSONP user aborted read');err.code=1000;this._abort(err)}};JsonpReceiver.timeout=35000;JsonpReceiver.scriptErrorTimeout=1000;JsonpReceiver.prototype._callback=function(data){debug('_callback',data);this._cleanup();if(this.aborting){return}
if(data){debug('message',data);this.emit('message',data)}
this.emit('close',null,'network');this.removeAllListeners()};JsonpReceiver.prototype._abort=function(err){debug('_abort',err);this._cleanup();this.aborting=!0;this.emit('close',err.code,err.message);this.removeAllListeners()};JsonpReceiver.prototype._cleanup=function(){debug('_cleanup');clearTimeout(this.timeoutId);if(this.script2){this.script2.parentNode.removeChild(this.script2);this.script2=null}
if(this.script){var script=this.script;script.parentNode.removeChild(script);script.onreadystatechange=script.onerror=script.onload=script.onclick=null;this.script=null}
delete global[utils.WPrefix][this.id]};JsonpReceiver.prototype._scriptError=function(){debug('_scriptError');var self=this;if(this.errorTimer){return}
this.errorTimer=setTimeout(function(){if(!self.loadedOkay){self._abort(new Error('JSONP script loaded abnormally (onerror)'))}},JsonpReceiver.scriptErrorTimeout)};JsonpReceiver.prototype._createScript=function(url){debug('_createScript',url);var self=this;var script=this.script=global.document.createElement('script');var script2;script.id='a'+random.string(8);script.src=url;script.type='text/javascript';script.charset='UTF-8';script.onerror=this._scriptError.bind(this);script.onload=function(){debug('onload');self._abort(new Error('JSONP script loaded abnormally (onload)'))};script.onreadystatechange=function(){debug('onreadystatechange',script.readyState);if(/loaded|closed/.test(script.readyState)){if(script&&script.htmlFor&&script.onclick){self.loadedOkay=!0;try{script.onclick()}catch(x){}}
if(script){self._abort(new Error('JSONP script loaded abnormally (onreadystatechange)'))}}};if(typeof script.async==='undefined'&&global.document.attachEvent){if(!browser.isOpera()){try{script.htmlFor=script.id;script.event='onclick'}catch(x){}
script.async=!0}else{script2=this.script2=global.document.createElement('script');script2.text="try{var a = document.getElementById('"+script.id+"'); if(a)a.onerror();}catch(x){};";script.async=script2.async=!1}}
if(typeof script.async!=='undefined'){script.async=!0}
var head=global.document.getElementsByTagName('head')[0];head.insertBefore(script,head.firstChild);if(script2){head.insertBefore(script2,head.firstChild)}};module.exports=JsonpReceiver}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,"debug":54,"events":3,"inherits":57}],32:[function(require,module,exports){(function(process){'use strict';var inherits=require('inherits'),EventEmitter=require('events').EventEmitter;var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:receiver:xhr')}
function XhrReceiver(url,AjaxObject){debug(url);EventEmitter.call(this);var self=this;this.bufferPosition=0;this.xo=new AjaxObject('POST',url,null);this.xo.on('chunk',this._chunkHandler.bind(this));this.xo.once('finish',function(status,text){debug('finish',status,text);self._chunkHandler(status,text);self.xo=null;var reason=status===200?'network':'permanent';debug('close',reason);self.emit('close',null,reason);self._cleanup()})}
inherits(XhrReceiver,EventEmitter);XhrReceiver.prototype._chunkHandler=function(status,text){debug('_chunkHandler',status);if(status!==200||!text){return}
for(var idx=-1;;this.bufferPosition+=idx+1){var buf=text.slice(this.bufferPosition);idx=buf.indexOf('\n');if(idx===-1){break}
var msg=buf.slice(0,idx);if(msg){debug('message',msg);this.emit('message',msg)}}};XhrReceiver.prototype._cleanup=function(){debug('_cleanup');this.removeAllListeners()};XhrReceiver.prototype.abort=function(){debug('abort');if(this.xo){this.xo.close();debug('close');this.emit('close',null,'user');this.xo=null}
this._cleanup()};module.exports=XhrReceiver}).call(this,{env:{}})},{"debug":54,"events":3,"inherits":57}],33:[function(require,module,exports){(function(process,global){'use strict';var random=require('../../utils/random'),urlUtils=require('../../utils/url');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:sender:jsonp')}
var form,area;function createIframe(id){debug('createIframe',id);try{return global.document.createElement('<iframe name="'+id+'">')}catch(x){var iframe=global.document.createElement('iframe');iframe.name=id;return iframe}}
function createForm(){debug('createForm');form=global.document.createElement('form');form.style.display='none';form.style.position='absolute';form.method='POST';form.enctype='application/x-www-form-urlencoded';form.acceptCharset='UTF-8';area=global.document.createElement('textarea');area.name='d';form.appendChild(area);global.document.body.appendChild(form)}
module.exports=function(url,payload,callback){debug(url,payload);if(!form){createForm()}
var id='a'+random.string(8);form.target=id;form.action=urlUtils.addQuery(urlUtils.addPath(url,'/jsonp_send'),'i='+id);var iframe=createIframe(id);iframe.id=id;iframe.style.display='none';form.appendChild(iframe);try{area.value=payload}catch(e){}
form.submit();var completed=function(err){debug('completed',id,err);if(!iframe.onerror){return}
iframe.onreadystatechange=iframe.onerror=iframe.onload=null;setTimeout(function(){debug('cleaning up',id);iframe.parentNode.removeChild(iframe);iframe=null},500);area.value='';callback(err)};iframe.onerror=function(){debug('onerror',id);completed()};iframe.onload=function(){debug('onload',id);completed()};iframe.onreadystatechange=function(e){debug('onreadystatechange',id,iframe.readyState,e);if(iframe.readyState==='complete'){completed()}};return function(){debug('aborted',id);completed(new Error('Aborted'))}}}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/random":50,"../../utils/url":52,"debug":54}],34:[function(require,module,exports){(function(process,global){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits'),eventUtils=require('../../utils/event'),browser=require('../../utils/browser'),urlUtils=require('../../utils/url');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:sender:xdr')}
function XDRObject(method,url,payload){debug(method,url);var self=this;EventEmitter.call(this);setTimeout(function(){self._start(method,url,payload)},0)}
inherits(XDRObject,EventEmitter);XDRObject.prototype._start=function(method,url,payload){debug('_start');var self=this;var xdr=new global.XDomainRequest();url=urlUtils.addQuery(url,'t='+(+new Date()));xdr.onerror=function(){debug('onerror');self._error()};xdr.ontimeout=function(){debug('ontimeout');self._error()};xdr.onprogress=function(){debug('progress',xdr.responseText);self.emit('chunk',200,xdr.responseText)};xdr.onload=function(){debug('load');self.emit('finish',200,xdr.responseText);self._cleanup(!1)};this.xdr=xdr;this.unloadRef=eventUtils.unloadAdd(function(){self._cleanup(!0)});try{this.xdr.open(method,url);if(this.timeout){this.xdr.timeout=this.timeout}
this.xdr.send(payload)}catch(x){this._error()}};XDRObject.prototype._error=function(){this.emit('finish',0,'');this._cleanup(!1)};XDRObject.prototype._cleanup=function(abort){debug('cleanup',abort);if(!this.xdr){return}
this.removeAllListeners();eventUtils.unloadDel(this.unloadRef);this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null;if(abort){try{this.xdr.abort()}catch(x){}}
this.unloadRef=this.xdr=null};XDRObject.prototype.close=function(){debug('close');this._cleanup(!0)};XDRObject.enabled=!!(global.XDomainRequest&&browser.hasDomain());module.exports=XDRObject}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,"debug":54,"events":3,"inherits":57}],35:[function(require,module,exports){'use strict';var inherits=require('inherits'),XhrDriver=require('../driver/xhr');function XHRCorsObject(method,url,payload,opts){XhrDriver.call(this,method,url,payload,opts)}
inherits(XHRCorsObject,XhrDriver);XHRCorsObject.enabled=XhrDriver.enabled&&XhrDriver.supportsCORS;module.exports=XHRCorsObject},{"../driver/xhr":17,"inherits":57}],36:[function(require,module,exports){'use strict';var EventEmitter=require('events').EventEmitter,inherits=require('inherits');function XHRFake(){var self=this;EventEmitter.call(this);this.to=setTimeout(function(){self.emit('finish',200,'{}')},XHRFake.timeout)}
inherits(XHRFake,EventEmitter);XHRFake.prototype.close=function(){clearTimeout(this.to)};XHRFake.timeout=2000;module.exports=XHRFake},{"events":3,"inherits":57}],37:[function(require,module,exports){'use strict';var inherits=require('inherits'),XhrDriver=require('../driver/xhr');function XHRLocalObject(method,url,payload){XhrDriver.call(this,method,url,payload,{noCredentials:!0})}
inherits(XHRLocalObject,XhrDriver);XHRLocalObject.enabled=XhrDriver.enabled;module.exports=XHRLocalObject},{"../driver/xhr":17,"inherits":57}],38:[function(require,module,exports){(function(process){'use strict';var utils=require('../utils/event'),urlUtils=require('../utils/url'),inherits=require('inherits'),EventEmitter=require('events').EventEmitter,WebsocketDriver=require('./driver/websocket');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:websocket')}
function WebSocketTransport(transUrl,ignore,options){if(!WebSocketTransport.enabled()){throw new Error('Transport created when disabled')}
EventEmitter.call(this);debug('constructor',transUrl);var self=this;var url=urlUtils.addPath(transUrl,'/websocket');if(url.slice(0,5)==='https'){url='wss'+url.slice(5)}else{url='ws'+url.slice(4)}
this.url=url;this.ws=new WebsocketDriver(this.url,[],options);this.ws.onmessage=function(e){debug('message event',e.data);self.emit('message',e.data)};this.unloadRef=utils.unloadAdd(function(){debug('unload');self.ws.close()});this.ws.onclose=function(e){debug('close event',e.code,e.reason);self.emit('close',e.code,e.reason);self._cleanup()};this.ws.onerror=function(e){debug('error event',e);self.emit('close',1006,'WebSocket connection broken');self._cleanup()}}
inherits(WebSocketTransport,EventEmitter);WebSocketTransport.prototype.send=function(data){var msg='['+data+']';debug('send',msg);this.ws.send(msg)};WebSocketTransport.prototype.close=function(){debug('close');if(this.ws){this.ws.close()}
this._cleanup()};WebSocketTransport.prototype._cleanup=function(){debug('_cleanup');var ws=this.ws;if(ws){ws.onmessage=ws.onclose=ws.onerror=null}
utils.unloadDel(this.unloadRef);this.unloadRef=this.ws=null;this.removeAllListeners()};WebSocketTransport.enabled=function(){debug('enabled');return!!WebsocketDriver};WebSocketTransport.transportName='websocket';WebSocketTransport.roundTrips=2;module.exports=WebSocketTransport}).call(this,{env:{}})},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,"debug":54,"events":3,"inherits":57}],39:[function(require,module,exports){'use strict';var inherits=require('inherits'),AjaxBasedTransport=require('./lib/ajax-based'),XdrStreamingTransport=require('./xdr-streaming'),XhrReceiver=require('./receiver/xhr'),XDRObject=require('./sender/xdr');function XdrPollingTransport(transUrl){if(!XDRObject.enabled){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/xhr',XhrReceiver,XDRObject)}
inherits(XdrPollingTransport,AjaxBasedTransport);XdrPollingTransport.enabled=XdrStreamingTransport.enabled;XdrPollingTransport.transportName='xdr-polling';XdrPollingTransport.roundTrips=2;module.exports=XdrPollingTransport},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,"inherits":57}],40:[function(require,module,exports){'use strict';var inherits=require('inherits'),AjaxBasedTransport=require('./lib/ajax-based'),XhrReceiver=require('./receiver/xhr'),XDRObject=require('./sender/xdr');function XdrStreamingTransport(transUrl){if(!XDRObject.enabled){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/xhr_streaming',XhrReceiver,XDRObject)}
inherits(XdrStreamingTransport,AjaxBasedTransport);XdrStreamingTransport.enabled=function(info){if(info.cookie_needed||info.nullOrigin){return!1}
return XDRObject.enabled&&info.sameScheme};XdrStreamingTransport.transportName='xdr-streaming';XdrStreamingTransport.roundTrips=2;module.exports=XdrStreamingTransport},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"inherits":57}],41:[function(require,module,exports){'use strict';var inherits=require('inherits'),AjaxBasedTransport=require('./lib/ajax-based'),XhrReceiver=require('./receiver/xhr'),XHRCorsObject=require('./sender/xhr-cors'),XHRLocalObject=require('./sender/xhr-local');function XhrPollingTransport(transUrl){if(!XHRLocalObject.enabled&&!XHRCorsObject.enabled){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/xhr',XhrReceiver,XHRCorsObject)}
inherits(XhrPollingTransport,AjaxBasedTransport);XhrPollingTransport.enabled=function(info){if(info.nullOrigin){return!1}
if(XHRLocalObject.enabled&&info.sameOrigin){return!0}
return XHRCorsObject.enabled};XhrPollingTransport.transportName='xhr-polling';XhrPollingTransport.roundTrips=2;module.exports=XhrPollingTransport},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,"inherits":57}],42:[function(require,module,exports){(function(global){'use strict';var inherits=require('inherits'),AjaxBasedTransport=require('./lib/ajax-based'),XhrReceiver=require('./receiver/xhr'),XHRCorsObject=require('./sender/xhr-cors'),XHRLocalObject=require('./sender/xhr-local'),browser=require('../utils/browser');function XhrStreamingTransport(transUrl){if(!XHRLocalObject.enabled&&!XHRCorsObject.enabled){throw new Error('Transport created when disabled')}
AjaxBasedTransport.call(this,transUrl,'/xhr_streaming',XhrReceiver,XHRCorsObject)}
inherits(XhrStreamingTransport,AjaxBasedTransport);XhrStreamingTransport.enabled=function(info){if(info.nullOrigin){return!1}
if(browser.isOpera()){return!1}
return XHRCorsObject.enabled};XhrStreamingTransport.transportName='xhr-streaming';XhrStreamingTransport.roundTrips=2;XhrStreamingTransport.needBody=!!global.document;module.exports=XhrStreamingTransport}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,"inherits":57}],43:[function(require,module,exports){(function(global){'use strict';if(global.crypto&&global.crypto.getRandomValues){module.exports.randomBytes=function(length){var bytes=new Uint8Array(length);global.crypto.getRandomValues(bytes);return bytes}}else{module.exports.randomBytes=function(length){var bytes=new Array(length);for(var i=0;i<length;i++){bytes[i]=Math.floor(Math.random()*256)}
return bytes}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],44:[function(require,module,exports){(function(global){'use strict';module.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document){return!0}
try{return!!global.document.domain}catch(e){return!1}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],45:[function(require,module,exports){'use strict';var JSON3=require('json3');var extraEscapable=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,extraLookup;var unrollLookup=function(escapable){var i;var unrolled={};var c=[];for(i=0;i<65536;i++){c.push(String.fromCharCode(i))}
escapable.lastIndex=0;c.join('').replace(escapable,function(a){unrolled[a]='\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);return''});escapable.lastIndex=0;return unrolled};module.exports={quote:function(string){var quoted=JSON3.stringify(string);extraEscapable.lastIndex=0;if(!extraEscapable.test(quoted)){return quoted}
if(!extraLookup){extraLookup=unrollLookup(extraEscapable)}
return quoted.replace(extraEscapable,function(a){return extraLookup[a]})}}},{"json3":58}],46:[function(require,module,exports){(function(global){'use strict';var random=require('./random');var onUnload={},afterUnload=!1,isChromePackagedApp=global.chrome&&global.chrome.app&&global.chrome.app.runtime;module.exports={attachEvent:function(event,listener){if(typeof global.addEventListener!=='undefined'){global.addEventListener(event,listener,!1)}else if(global.document&&global.attachEvent){global.document.attachEvent('on'+event,listener);global.attachEvent('on'+event,listener)}},detachEvent:function(event,listener){if(typeof global.addEventListener!=='undefined'){global.removeEventListener(event,listener,!1)}else if(global.document&&global.detachEvent){global.document.detachEvent('on'+event,listener);global.detachEvent('on'+event,listener)}},unloadAdd:function(listener){if(isChromePackagedApp){return null}
var ref=random.string(8);onUnload[ref]=listener;if(afterUnload){setTimeout(this.triggerUnloadCallbacks,0)}
return ref},unloadDel:function(ref){if(ref in onUnload){delete onUnload[ref]}},triggerUnloadCallbacks:function(){for(var ref in onUnload){onUnload[ref]();delete onUnload[ref]}}};var unloadTriggered=function(){if(afterUnload){return}
afterUnload=!0;module.exports.triggerUnloadCallbacks()};if(!isChromePackagedApp){module.exports.attachEvent('unload',unloadTriggered)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./random":50}],47:[function(require,module,exports){(function(process,global){'use strict';var eventUtils=require('./event'),JSON3=require('json3'),browser=require('./browser');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:utils:iframe')}
module.exports={WPrefix:'_jp',currentWindowId:null,polluteGlobalNamespace:function(){if(!(module.exports.WPrefix in global)){global[module.exports.WPrefix]={}}},postMessage:function(type,data){if(global.parent!==global){global.parent.postMessage(JSON3.stringify({windowId:module.exports.currentWindowId,type:type,data:data||''}),'*')}else{debug('Cannot postMessage, no parent window.',type,data)}},createIframe:function(iframeUrl,errorCallback){var iframe=global.document.createElement('iframe');var tref,unloadRef;var unattach=function(){debug('unattach');clearTimeout(tref);try{iframe.onload=null}catch(x){}
iframe.onerror=null};var cleanup=function(){debug('cleanup');if(iframe){unattach();setTimeout(function(){if(iframe){iframe.parentNode.removeChild(iframe)}
iframe=null},0);eventUtils.unloadDel(unloadRef)}};var onerror=function(err){debug('onerror',err);if(iframe){cleanup();errorCallback(err)}};var post=function(msg,origin){debug('post',msg,origin);try{setTimeout(function(){if(iframe&&iframe.contentWindow){iframe.contentWindow.postMessage(msg,origin)}},0)}catch(x){}};iframe.src=iframeUrl;iframe.style.display='none';iframe.style.position='absolute';iframe.onerror=function(){onerror('onerror')};iframe.onload=function(){debug('onload');clearTimeout(tref);tref=setTimeout(function(){onerror('onload timeout')},2000)};global.document.body.appendChild(iframe);tref=setTimeout(function(){onerror('timeout')},15000);unloadRef=eventUtils.unloadAdd(cleanup);return{post:post,cleanup:cleanup,loaded:unattach}},createHtmlfile:function(iframeUrl,errorCallback){var axo=['Active'].concat('Object').join('X');var doc=new global[axo]('htmlfile');var tref,unloadRef;var iframe;var unattach=function(){clearTimeout(tref);iframe.onerror=null};var cleanup=function(){if(doc){unattach();eventUtils.unloadDel(unloadRef);iframe.parentNode.removeChild(iframe);iframe=doc=null;CollectGarbage()}};var onerror=function(r){debug('onerror',r);if(doc){cleanup();errorCallback(r)}};var post=function(msg,origin){try{setTimeout(function(){if(iframe&&iframe.contentWindow){iframe.contentWindow.postMessage(msg,origin)}},0)}catch(x){}};doc.open();doc.write('<html><s'+'cript>'+'document.domain="'+global.document.domain+'";'+'</s'+'cript></html>');doc.close();doc.parentWindow[module.exports.WPrefix]=global[module.exports.WPrefix];var c=doc.createElement('div');doc.body.appendChild(c);iframe=doc.createElement('iframe');c.appendChild(iframe);iframe.src=iframeUrl;iframe.onerror=function(){onerror('onerror')};tref=setTimeout(function(){onerror('timeout')},15000);unloadRef=eventUtils.unloadAdd(cleanup);return{post:post,cleanup:cleanup,loaded:unattach}}};module.exports.iframeEnabled=!1;if(global.document){module.exports.iframeEnabled=(typeof global.postMessage==='function'||typeof global.postMessage==='object')&&(!browser.isKonqueror())}}).call(this,{env:{}},typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./browser":44,"./event":46,"debug":54,"json3":58}],48:[function(require,module,exports){(function(global){'use strict';var logObject={};['log','debug','warn'].forEach(function(level){var levelExists;try{levelExists=global.console&&global.console[level]&&global.console[level].apply}catch(e){}
logObject[level]=levelExists?function(){return global.console[level].apply(global.console,arguments)}:(level==='log'?function(){}:logObject.log)});module.exports=logObject}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],49:[function(require,module,exports){'use strict';module.exports={isObject:function(obj){var type=typeof obj;return type==='function'||type==='object'&&!!obj},extend:function(obj){if(!this.isObject(obj)){return obj}
var source,prop;for(var i=1,length=arguments.length;i<length;i++){source=arguments[i];for(prop in source){if(Object.prototype.hasOwnProperty.call(source,prop)){obj[prop]=source[prop]}}}
return obj}}},{}],50:[function(require,module,exports){'use strict';var crypto=require('crypto');var _randomStringChars='abcdefghijklmnopqrstuvwxyz012345';module.exports={string:function(length){var max=_randomStringChars.length;var bytes=crypto.randomBytes(length);var ret=[];for(var i=0;i<length;i++){ret.push(_randomStringChars.substr(bytes[i]%max,1))}
return ret.join('')},number:function(max){return Math.floor(Math.random()*max)},numberString:function(max){var t=(''+(max-1)).length;var p=new Array(t+1).join('0');return(p+this.number(max)).slice(-t)}}},{"crypto":43}],51:[function(require,module,exports){(function(process){'use strict';var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:utils:transport')}
module.exports=function(availableTransports){return{filterToEnabled:function(transportsWhitelist,info){var transports={main:[],facade:[]};if(!transportsWhitelist){transportsWhitelist=[]}else if(typeof transportsWhitelist==='string'){transportsWhitelist=[transportsWhitelist]}
availableTransports.forEach(function(trans){if(!trans){return}
if(trans.transportName==='websocket'&&info.websocket===!1){debug('disabled from server','websocket');return}
if(transportsWhitelist.length&&transportsWhitelist.indexOf(trans.transportName)===-1){debug('not in whitelist',trans.transportName);return}
if(trans.enabled(info)){debug('enabled',trans.transportName);transports.main.push(trans);if(trans.facadeTransport){transports.facade.push(trans.facadeTransport)}}else{debug('disabled',trans.transportName)}});return transports}}}}).call(this,{env:{}})},{"debug":54}],52:[function(require,module,exports){(function(process){'use strict';var URL=require('url-parse');var debug=function(){};if(process.env.NODE_ENV!=='production'){debug=require('debug')('sockjs-client:utils:url')}
module.exports={getOrigin:function(url){if(!url){return null}
var p=new URL(url);if(p.protocol==='file:'){return null}
var port=p.port;if(!port){port=(p.protocol==='https:')?'443':'80'}
return p.protocol+'//'+p.hostname+':'+port},isOriginEqual:function(a,b){var res=this.getOrigin(a)===this.getOrigin(b);debug('same',a,b,res);return res},isSchemeEqual:function(a,b){return(a.split(':')[0]===b.split(':')[0])},addPath:function(url,path){var qs=url.split('?');return qs[0]+path+(qs[1]?'?'+qs[1]:'')},addQuery:function(url,q){return url+(url.indexOf('?')===-1?('?'+q):('&'+q))}}}).call(this,{env:{}})},{"debug":54,"url-parse":59}],53:[function(require,module,exports){module.exports='1.1.1'},{}],54:[function(require,module,exports){exports=module.exports=require('./debug');exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=['lightseagreen','forestgreen','goldenrod','dodgerblue','darkorchid','crimson'];function useColors(){return('WebkitAppearance' in document.documentElement.style)||(window.console&&(console.firebug||(console.exception&&console.table)))||(navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31)}
exports.formatters.j=function(v){return JSON.stringify(v)};function formatArgs(){var args=arguments;var useColors=this.useColors;args[0]=(useColors?'%c':'')+this.namespace+(useColors?' %c':' ')+args[0]+(useColors?'%c ':' ')+'+'+exports.humanize(this.diff);if(!useColors)return args;var c='color: '+this.color;args=[args[0],c,'color: inherit'].concat(Array.prototype.slice.call(args,1));var index=0;var lastC=0;args[0].replace(/%[a-z%]/g,function(match){if('%%'===match)return;index++;if('%c'===match){lastC=index}});args.splice(lastC,0,c);return args}
function log(){return'object'===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}
function save(namespaces){try{if(null==namespaces){exports.storage.removeItem('debug')}else{exports.storage.debug=namespaces}}catch(e){}}
function load(){var r;try{r=exports.storage.debug}catch(e){}
return r}
exports.enable(load());function localstorage(){try{return window.localStorage}catch(e){}}},{"./debug":55}],55:[function(require,module,exports){exports=module.exports=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=require('ms');exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0;var prevTime;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}
function debug(namespace){function disabled(){}
disabled.enabled=!1;function enabled(){var self=enabled;var curr=+new Date();var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;if(null==self.useColors)self.useColors=exports.useColors();if(null==self.color&&self.useColors)self.color=selectColor();var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]);if('string'!==typeof args[0]){args=['%o'].concat(args)}
var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if(match==='%%')return match;index++;var formatter=exports.formatters[format];if('function'===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}
return match});if('function'===typeof exports.formatArgs){args=exports.formatArgs.apply(self,args)}
var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}
enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn}
function enable(namespaces){exports.save(namespaces);var split=(namespaces||'').split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/\*/g,'.*?');if(namespaces[0]==='-'){exports.skips.push(new RegExp('^'+namespaces.substr(1)+'$'))}else{exports.names.push(new RegExp('^'+namespaces+'$'))}}}
function disable(){exports.enable('')}
function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return!1}}
for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return!0}}
return!1}
function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}},{"ms":56}],56:[function(require,module,exports){var s=1000;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};if('string'==typeof val)return parse(val);return options.long?long(val):short(val)};function parse(str){str=''+str;if(str.length>10000)return;var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);var type=(match[2]||'ms').toLowerCase();switch(type){case 'years':case 'year':case 'yrs':case 'yr':case 'y':return n*y;case 'days':case 'day':case 'd':return n*d;case 'hours':case 'hour':case 'hrs':case 'hr':case 'h':return n*h;case 'minutes':case 'minute':case 'mins':case 'min':case 'm':return n*m;case 'seconds':case 'second':case 'secs':case 'sec':case 's':return n*s;case 'milliseconds':case 'millisecond':case 'msecs':case 'msec':case 'ms':return n}}
function short(ms){if(ms>=d)return Math.round(ms/d)+'d';if(ms>=h)return Math.round(ms/h)+'h';if(ms>=m)return Math.round(ms/m)+'m';if(ms>=s)return Math.round(ms/s)+'s';return ms+'ms'}
function long(ms){return plural(ms,d,'day')||plural(ms,h,'hour')||plural(ms,m,'minute')||plural(ms,s,'second')||ms+' ms'}
function plural(ms,n,name){if(ms<n)return;if(ms<n*1.5)return Math.floor(ms/n)+' '+name;return Math.ceil(ms/n)+' '+name+'s'}},{}],57:[function(require,module,exports){if(typeof Object.create==='function'){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor
ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor
var TempCtor=function(){}
TempCtor.prototype=superCtor.prototype
ctor.prototype=new TempCtor()
ctor.prototype.constructor=ctor}}},{}],58:[function(require,module,exports){(function(global){
/*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org */
;(function(){var isLoader=typeof define==="function"&&define.amd;var objectTypes={"function":!0,"object":!0};var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var root=objectTypes[typeof window]&&window||this,freeGlobal=freeExports&&objectTypes[typeof module]&&module&&!module.nodeType&&typeof global=="object"&&global;if(freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal)){root=freeGlobal}
function runInContext(context,exports){context||(context=root.Object());exports||(exports=root.Object());var Number=context.Number||root.Number,String=context.String||root.String,Object=context.Object||root.Object,Date=context.Date||root.Date,SyntaxError=context.SyntaxError||root.SyntaxError,TypeError=context.TypeError||root.TypeError,Math=context.Math||root.Math,nativeJSON=context.JSON||root.JSON;if(typeof nativeJSON=="object"&&nativeJSON){exports.stringify=nativeJSON.stringify;exports.parse=nativeJSON.parse}
var objectProto=Object.prototype,getClass=objectProto.toString,isProperty,forEach,undef;var isExtended=new Date(-3509827334573292);try{isExtended=isExtended.getUTCFullYear()==-109252&&isExtended.getUTCMonth()===0&&isExtended.getUTCDate()===1&&isExtended.getUTCHours()==10&&isExtended.getUTCMinutes()==37&&isExtended.getUTCSeconds()==6&&isExtended.getUTCMilliseconds()==708}catch(exception){}
function has(name){if(has[name]!==undef){return has[name]}
var isSupported;if(name=="bug-string-char-index"){isSupported="a"[0]!="a"}else if(name=="json"){isSupported=has("json-stringify")&&has("json-parse")}else{var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(name=="json-stringify"){var stringify=exports.stringify,stringifySupported=typeof stringify=="function"&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported=stringify(0)==="0"&&stringify(new Number())==="0"&&stringify(new String())=='""'&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&stringify(value)==="1"&&stringify([value])=="[1]"&&stringify([undef])=="[null]"&&stringify(null)=="null"&&stringify([undef,getClass,null])=="[null,null,null]"&&stringify({"a":[value,!0,!1,null,"\x00\b\n\f\r\t"]})==serialized&&stringify(null,value)==="1"&&stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&stringify(new Date(-8.64e15))=='"-271821-04-20T00:00:00.000Z"'&&stringify(new Date(8.64e15))=='"+275760-09-13T00:00:00.000Z"'&&stringify(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(exception){stringifySupported=!1}}
isSupported=stringifySupported}
if(name=="json-parse"){var parse=exports.parse;if(typeof parse=="function"){try{if(parse("0")===0&&!parse(!1)){value=parse(serialized);var parseSupported=value.a.length==5&&value.a[0]===1;if(parseSupported){try{parseSupported=!parse('"\t"')}catch(exception){}
if(parseSupported){try{parseSupported=parse("01")!==1}catch(exception){}}
if(parseSupported){try{parseSupported=parse("1.")!==1}catch(exception){}}}}}catch(exception){parseSupported=!1}}
isSupported=parseSupported}}
return has[name]=!!isSupported}
if(!has("json")){var functionClass="[object Function]",dateClass="[object Date]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",booleanClass="[object Boolean]";var charIndexBuggy=has("bug-string-char-index");if(!isExtended){var floor=Math.floor;var Months=[0,31,59,90,120,151,181,212,243,273,304,334];var getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)}}
if(!(isProperty=objectProto.hasOwnProperty)){isProperty=function(property){var members={},constructor;if((members.__proto__=null,members.__proto__={"toString":1},members).toString!=getClass){isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);this.__proto__=original;return result}}else{constructor=members.constructor;isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}}
members=null;return isProperty.call(this,property)}}
forEach=function(object,callback){var size=0,Properties,members,property;(Properties=function(){this.valueOf=0}).prototype.valueOf=0;members=new Properties();for(property in members){if(isProperty.call(members,property)){size++}}
Properties=members=null;if(!size){members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,length;var hasProperty=!isFunction&&typeof object.constructor!="function"&&objectTypes[typeof object.hasOwnProperty]&&object.hasOwnProperty||isProperty;for(property in object){if(!(isFunction&&property=="prototype")&&hasProperty.call(object,property)){callback(property)}}
for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}}else if(size==2){forEach=function(object,callback){var members={},isFunction=getClass.call(object)==functionClass,property;for(property in object){if(!(isFunction&&property=="prototype")&&!isProperty.call(members,property)&&(members[property]=1)&&isProperty.call(object,property)){callback(property)}}}}else{forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,isConstructor;for(property in object){if(!(isFunction&&property=="prototype")&&isProperty.call(object,property)&&!(isConstructor=property==="constructor")){callback(property)}}
if(isConstructor||isProperty.call(object,(property="constructor"))){callback(property)}}}
return forEach(object,callback)};if(!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var leadingZeroes="000000";var toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)};var unicodePrefix="\\u00";var quote=function(value){var result='"',index=0,length=value.length,useCharIndex=!charIndexBuggy||length>10;var symbols=useCharIndex&&(charIndexBuggy?value.split(""):value);for(;index<length;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(charCode<32){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}
result+=useCharIndex?symbols[index]:value.charAt(index)}}
return result+'"'};var serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}
if(typeof value=="object"&&value){className=getClass.call(value);if(className==dateClass&&!isProperty.call(value,"toJSON")){if(value>-1/0&&value<1/0){if(getDay){date=floor(value/864e5);for(year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month);time=(value%864e5+864e5)%864e5;hours=floor(time/36e5)%24;minutes=floor(time/6e4)%60;seconds=floor(time/1e3)%60;milliseconds=time%1e3}else{year=value.getUTCFullYear();month=value.getUTCMonth();date=value.getUTCDate();hours=value.getUTCHours();minutes=value.getUTCMinutes();seconds=value.getUTCSeconds();milliseconds=value.getUTCMilliseconds()}
value=(year<=0||year>=1e4?(year<0?"-":"+")+toPaddedString(6,year<0?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else{value=null}}else if(typeof value.toJSON=="function"&&((className!=numberClass&&className!=stringClass&&className!=arrayClass)||isProperty.call(value,"toJSON"))){value=value.toJSON(property)}}
if(callback){value=callback.call(object,property,value)}
if(value===null){return"null"}
className=getClass.call(value);if(className==booleanClass){return""+value}else if(className==numberClass){return value>-1/0&&value<1/0?""+value:"null"}else if(className==stringClass){return quote(""+value)}
if(typeof value=="object"){for(length=stack.length;length--;){if(stack[length]===value){throw TypeError()}}
stack.push(value);results=[];prefix=indentation;indentation+=whitespace;if(className==arrayClass){for(index=0,length=value.length;index<length;index++){element=serialize(index,value,callback,properties,whitespace,indentation,stack);results.push(element===undef?"null":element)}
result=results.length?(whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":("["+results.join(",")+"]")):"[]"}else{forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);if(element!==undef){results.push(quote(property)+":"+(whitespace?" ":"")+element)}});result=results.length?(whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":("{"+results.join(",")+"}")):"{}"}
stack.pop();return result}};exports.stringify=function(source,filter,width){var whitespace,callback,properties,className;if(objectTypes[typeof filter]&&filter){if((className=getClass.call(filter))==functionClass){callback=filter}else if(className==arrayClass){properties={};for(var index=0,length=filter.length,value;index<length;value=filter[index++],((className=getClass.call(value)),className==stringClass||className==numberClass)&&(properties[value]=1));}}
if(width){if((className=getClass.call(width))==numberClass){if((width-=width%1)>0){for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}}else if(className==stringClass){whitespace=width.length<=10?width:width.slice(0,10)}}
return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}
if(!has("json-parse")){var fromCharCode=String.fromCharCode;var Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"};var Index,Source;var abort=function(){Index=Source=null;throw SyntaxError()};var lex=function(){var source=Source,length=source.length,value,begin,position,isSigned,charCode;while(Index<length){charCode=source.charCodeAt(Index);switch(charCode){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:value=charIndexBuggy?source.charAt(Index):source[Index];Index++;return value;case 34:for(value="@",Index++;Index<length;){charCode=source.charCodeAt(Index);if(charCode<32){abort()}else if(charCode==92){charCode=source.charCodeAt(++Index);switch(charCode){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode];Index++;break;case 117:begin=++Index;for(position=Index+4;Index<position;Index++){charCode=source.charCodeAt(Index);if(!(charCode>=48&&charCode<=57||charCode>=97&&charCode<=102||charCode>=65&&charCode<=70)){abort()}}
value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}}else{if(charCode==34){break}
charCode=source.charCodeAt(Index);begin=Index;while(charCode>=32&&charCode!=92&&charCode!=34){charCode=source.charCodeAt(++Index)}
value+=source.slice(begin,Index)}}
if(source.charCodeAt(Index)==34){Index++;return value}
abort();default:begin=Index;if(charCode==45){isSigned=!0;charCode=source.charCodeAt(++Index)}
if(charCode>=48&&charCode<=57){if(charCode==48&&((charCode=source.charCodeAt(Index+1)),charCode>=48&&charCode<=57)){abort()}
isSigned=!1;for(;Index<length&&((charCode=source.charCodeAt(Index)),charCode>=48&&charCode<=57);Index++);if(source.charCodeAt(Index)==46){position=++Index;for(;position<length&&((charCode=source.charCodeAt(position)),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}
Index=position}
charCode=source.charCodeAt(Index);if(charCode==101||charCode==69){charCode=source.charCodeAt(++Index);if(charCode==43||charCode==45){Index++}
for(position=Index;position<length&&((charCode=source.charCodeAt(position)),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}
Index=position}
return+source.slice(begin,Index)}
if(isSigned){abort()}
if(source.slice(Index,Index+4)=="true"){Index+=4;return!0}else if(source.slice(Index,Index+5)=="false"){Index+=5;return!1}else if(source.slice(Index,Index+4)=="null"){Index+=4;return null}
abort()}}
return"$"};var get=function(value){var results,hasMembers;if(value=="$"){abort()}
if(typeof value=="string"){if((charIndexBuggy?value.charAt(0):value[0])=="@"){return value.slice(1)}
if(value=="["){results=[];for(;;hasMembers||(hasMembers=!0)){value=lex();if(value=="]"){break}
if(hasMembers){if(value==","){value=lex();if(value=="]"){abort()}}else{abort()}}
if(value==","){abort()}
results.push(get(value))}
return results}else if(value=="{"){results={};for(;;hasMembers||(hasMembers=!0)){value=lex();if(value=="}"){break}
if(hasMembers){if(value==","){value=lex();if(value=="}"){abort()}}else{abort()}}
if(value==","||typeof value!="string"||(charIndexBuggy?value.charAt(0):value[0])!="@"||lex()!=":"){abort()}
results[value.slice(1)]=get(lex())}
return results}
abort()}
return value};var update=function(source,property,callback){var element=walk(source,property,callback);if(element===undef){delete source[property]}else{source[property]=element}};var walk=function(source,property,callback){var value=source[property],length;if(typeof value=="object"&&value){if(getClass.call(value)==arrayClass){for(length=value.length;length--;){update(value,length,callback)}}else{forEach(value,function(property){update(value,property,callback)})}}
return callback.call(source,property,value)};exports.parse=function(source,callback){var result,value;Index=0;Source=""+source;result=get(lex());if(lex()!="$"){abort()}
Index=Source=null;return callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}
exports.runInContext=runInContext;return exports}
if(freeExports&&!isLoader){runInContext(root,freeExports)}else{var nativeJSON=root.JSON,previousJSON=root.JSON3,isRestored=!1;var JSON3=runInContext(root,(root.JSON3={"noConflict":function(){if(!isRestored){isRestored=!0;root.JSON=nativeJSON;root.JSON3=previousJSON;nativeJSON=previousJSON=null}
return JSON3}}));root.JSON={"parse":JSON3.parse,"stringify":JSON3.stringify}}
if(isLoader){define(function(){return JSON3})}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],59:[function(require,module,exports){'use strict';var required=require('requires-port'),lolcation=require('./lolcation'),qs=require('querystringify'),relativere=/^\/(?!\/)/,protocolre=/^([a-z0-9.+-]+:)?(\/\/)?(.*)$/i;var instructions=[['#','hash'],['?','query'],['/','pathname'],['@','auth',1],[NaN,'host',undefined,1,1],[/\:(\d+)$/,'port'],[NaN,'hostname',undefined,1,1]];function extractProtocol(address){var match=protocolre.exec(address);return{protocol:match[1]?match[1].toLowerCase():'',slashes:!!match[2],rest:match[3]?match[3]:''}}
function URL(address,location,parser){if(!(this instanceof URL)){return new URL(address,location,parser)}
var relative=relativere.test(address),parse,instruction,index,key,type=typeof location,url=this,i=0;if('object'!==type&&'string'!==type){parser=location;location=null}
if(parser&&'function'!==typeof parser){parser=qs.parse}
location=lolcation(location);var extracted=extractProtocol(address);url.protocol=extracted.protocol||location.protocol||'';url.slashes=extracted.slashes||location.slashes;address=extracted.rest;for(;i<instructions.length;i++){instruction=instructions[i];parse=instruction[0];key=instruction[1];if(parse!==parse){url[key]=address}else if('string'===typeof parse){if(~(index=address.indexOf(parse))){if('number'===typeof instruction[2]){url[key]=address.slice(0,index);address=address.slice(index+instruction[2])}else{url[key]=address.slice(index);address=address.slice(0,index)}}}else if(index=parse.exec(address)){url[key]=index[1];address=address.slice(0,address.length-index[0].length)}
url[key]=url[key]||(instruction[3]||('port'===key&&relative)?location[key]||'':'');if(instruction[4]){url[key]=url[key].toLowerCase()}}
if(parser)url.query=parser(url.query);if(!required(url.port,url.protocol)){url.host=url.hostname;url.port=''}
url.username=url.password='';if(url.auth){instruction=url.auth.split(':');url.username=instruction[0]||'';url.password=instruction[1]||''}
url.href=url.toString()}
URL.prototype.set=function set(part,value,fn){var url=this;if('query'===part){if('string'===typeof value&&value.length){value=(fn||qs.parse)(value)}
url[part]=value}else if('port'===part){url[part]=value;if(!required(value,url.protocol)){url.host=url.hostname;url[part]=''}else if(value){url.host=url.hostname+':'+value}}else if('hostname'===part){url[part]=value;if(url.port)value+=':'+url.port;url.host=value}else if('host'===part){url[part]=value;if(/\:\d+/.test(value)){value=value.split(':');url.hostname=value[0];url.port=value[1]}}else if('protocol'===part){url.protocol=value;url.slashes=!fn}else{url[part]=value}
url.href=url.toString();return url};URL.prototype.toString=function toString(stringify){if(!stringify||'function'!==typeof stringify)stringify=qs.stringify;var query,url=this,protocol=url.protocol;if(protocol&&protocol.charAt(protocol.length-1)!==':')protocol+=':';var result=protocol+(url.slashes?'//':'');if(url.username){result+=url.username;if(url.password)result+=':'+url.password;result+='@'}
result+=url.hostname;if(url.port)result+=':'+url.port;result+=url.pathname;query='object'===typeof url.query?stringify(url.query):url.query;if(query)result+='?'!==query.charAt(0)?'?'+query:query;if(url.hash)result+=url.hash;return result};URL.qs=qs;URL.location=lolcation;module.exports=URL},{"./lolcation":60,"querystringify":61,"requires-port":62}],60:[function(require,module,exports){(function(global){'use strict';var slashes=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//;var ignore={hash:1,query:1},URL;module.exports=function lolcation(loc){loc=loc||global.location||{};URL=URL||require('./');var finaldestination={},type=typeof loc,key;if('blob:'===loc.protocol){finaldestination=new URL(unescape(loc.pathname),{})}else if('string'===type){finaldestination=new URL(loc,{});for(key in ignore)delete finaldestination[key]}else if('object'===type){for(key in loc){if(key in ignore)continue;finaldestination[key]=loc[key]}
if(finaldestination.slashes===undefined){finaldestination.slashes=slashes.test(loc.href)}}
return finaldestination}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./":59}],61:[function(require,module,exports){'use strict';var has=Object.prototype.hasOwnProperty;function querystring(query){var parser=/([^=?&]+)=([^&]*)/g,result={},part;for(;part=parser.exec(query);result[decodeURIComponent(part[1])]=decodeURIComponent(part[2]));return result}
function querystringify(obj,prefix){prefix=prefix||'';var pairs=[];if('string'!==typeof prefix)prefix='?';for(var key in obj){if(has.call(obj,key)){pairs.push(encodeURIComponent(key)+'='+encodeURIComponent(obj[key]))}}
return pairs.length?prefix+pairs.join('&'):''}
exports.stringify=querystringify;exports.parse=querystring},{}],62:[function(require,module,exports){'use strict';module.exports=function required(port,protocol){protocol=protocol.split(':')[0];port=+port;if(!port)return!1;switch(protocol){case 'http':case 'ws':return port!==80;case 'https':case 'wss':return port!==443;case 'ftp':return port!==21;case 'gopher':return port!==70;case 'file':return!1}
return port!==0}},{}]},{},[1])(1)});var PushClient=function(provider){provider.pushClient=this;this.provider=provider;this.isConnected=function(){return this.provider.isConnected()};this.isConnecting=function(){return this.provider.isConnecting()};this.connect=function(config){if(!this.isConnected()&&!this.isConnecting()){this.provider.connect()}};this.subscribe=function(channelName,callback){var self=this;self.provider.subscribe(channelName,callback)};this.publish=function(channelName,data){this.provider.publish(channelName,data)};this.unsubscribe=function(channelName){this.provider.unsubscribe(channelName)};this.onConnect=function(handler,force){if(this.provider.socket&&this.provider.isConnected()){handler.call()}
this.provider.addEventListener('open',function(){handler.call()})};this.onDisconnect=function(handler){if(this.provider.socket&&this.provider.isClosed()){handler.call()}
this.provider.addEventListener('close',function(){handler.call()})};this.ping=function(){this.provider.ping()};this.send=function(action,channel,data){this.provider.send(action,channel,data)};var self=this;var pingTimer=null;this.onConnect(function(){if(!pingTimer){pingTimer=setInterval(function(){self.ping()},10000)}})};var PushSockJSProvider=function(config){this.socket=null;this.config=config;this.callbacks={};this.closeTimer=null;this.urlsIndex=null;this.noUrlChange=!1;this.autoReconnect=!0;this.handlers={};this.name='sockjs';this.failConnects=0;this.isConnected=function(){return this.socket&&this.socket.readyState==SockJS.OPEN};this.isConnecting=function(){return this.socket&&this.socket.readyState==SockJS.CONNECTING};this.isClosed=function(){return this.socket&&this.socket.readyState==SockJS.CLOSED};this.onDisconnect=function(){$(document).trigger('comet:disconnected')};this.addEventListener=function(event,handler){this.handlers[event]=this.handlers[event]||[];this.handlers[event].push(handler)};this.connect=function(){if(this.isConnecting())return;if(this.isConnected()){this.noUrlChange=!0;if(this.socket){this.socket.close();delete(this.socket);this.socket=null}
this.onDisconnect();return}
if(this.urlsIndex==null){this.urlsIndex=Math.floor(Math.random()*(this.config.urls.length/2))*2}else{if(!this.noUrlChange){this.urlsIndex=(this.urlsIndex+1)%this.config.urls.length}else{this.noUrlChange=!1}}
var url=this.config.urls[this.urlsIndex];url=this.config.unified_url;this.socket=new SockJS(url);var self=this;this.socket.onopen=function(){self.failConnects=0;for(var c in self.callbacks){if(self.callbacks.hasOwnProperty(c)){self.send("join",c)}}
$(document).trigger('comet:connected');if(self.handlers.open){for(var i=0;i<self.handlers.open.length;i++){self.handlers.open[i].call()}}};this.socket.onmessage=function(e){if(e.type=="message"){var data=JSON.parse(e.data);if(data.c){self.runCallbacks(data)}else if(data.d=="pong"){$(document).trigger('comet:pong',[data])}}};this.socket.onclose=function(){if(self.handlers.close){for(var i=0;i<self.handlers.close.length;i++){self.handlers.close[i].call()}}
self.onDisconnect();if(self.autoReconnect){self.failConnects=(self.failConnects+1)%7;setTimeout(function(){self.connect()},1000+(self.failConnects-1)*1000)}};var ht=null;this.socket.onheartbeat=function(){if(ht)clearTimeout(ht);ht=setTimeout(function(){if(App&&App.gaEvent){App.gaEvent('CometHBReconnect',cs_user.login,location.href)}
self.connect()},30000)}};this.subscribe=function(channelName,callback){this.callbacks[channelName]=this.callbacks[channelName]||[];this.callbacks[channelName].push(callback);this.send("join",channelName)};this.unsubscribe=function(channelName){this.send("leave",channelName);delete this.callbacks[channelName];this.callbacks[channelName]=[]};this.publish=function(channelName,data){this.send("msg",channelName,data)};this.send=function(action,channel,data){if(this.isConnected()){try{this.socket.send(JSON.stringify({a:action,c:channel,d:data}))}catch(e){this.connect()}}};this.ping=function(){$(document).trigger('comet:ping');this.send("ping",null,{p:location.href})};this.runCallbacks=function(data){if(data.c&&this.callbacks[data.c]&&this.callbacks[data.c].length){for(var i=0;i<this.callbacks[data.c].length;i++){this.callbacks[data.c][i].call(this,data.d,data.c,data.t)}}};this.close=function(){if(this.socket){this.autoReconnect=!1;this.socket.close()}};this.connect()};function _getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}
return null}
var pushClient=new PushClient(new PushSocketIOProvider(sio_params));(function(d,w){"function"===typeof define&&define.amd?define(["jquery"],function(){return w.apply(d,arguments)}):"object"===typeof module&&module.exports?module.exports=w.call(d,require("jquery")):w.call(d,d.jQuery)})("object"===typeof global?global:this,function(d){function w(a,b,k,c){if("d"!=k&&D(a)){var f=K.exec(b),e="auto"===a.css(k)?0:a.css(k),e="string"==typeof e?A(e):e;"string"==typeof b&&A(b);c=!0===c?0:e;var g=a.is(":hidden"),n=a.translation();"left"==k&&(c=parseInt(e,10)+n.x);"right"==k&&(c=parseInt(e,10)+n.x);"top"==k&&(c=parseInt(e,10)+n.y);"bottom"==k&&(c=parseInt(e,10)+n.y);if(f||"show"!=b)f||"hide"!=b||(c=0);else if(c=1,g)elem=a[0],elem.style&&(display=elem.style.display,d._data(elem,"olddisplay")||"none"!==display||(display=elem.style.display=""),""===display&&"none"===d.css(elem,"display")&&d._data(elem,"olddisplay",L(elem.tagName)),""===display||"none"===display)&&(elem.style.display=d._data(elem,"olddisplay")||""),a.css("opacity",0);return f?(a=parseFloat(f[2]),f[1]&&(a=("-="===f[1]?-1:1)*a+parseInt(c,10)),f[3]&&"px"!=f[3]&&(a+=f[3]),a):c}}function M(a,b,k,c,f,e,g,n){var m=a.data(r),m=m&&!q(m)?m:d.extend(!0,{},N),s=f;if(-1<d.inArray(b,B)){var l=m.meta,p=A(a.css(b))||0,t=b+"_o",s=f-p;l[b]=s;l[t]="auto"==a.css(b)?0+s:p+s||0;m.meta=l;g&&0===s&&(s=0-l[t],l[b]=s,l[t]=0)}return a.data(r,O(a,m,b,k,c,s,e,g,n))}function O(a,b,d,c,f,e,g,n,m){var s=!1;g=!0===g&&!0===n;b=b||{};b.original||(b.original={},s=!0);b.properties=b.properties||{};b.secondary=b.secondary||{};n=b.meta;for(var r=b.original,p=b.properties,t=b.secondary,h=l.length-1;0<=h;h--){var u=l[h]+"transition-property",v=l[h]+"transition-duration",q=l[h]+"transition-timing-function";d=g?l[h]+"transform":d;s&&(r[u]=a.css(u)||"",r[v]=a.css(v)||"",r[q]=a.css(q)||"");var P=t,w=d,x;if(g){x=n.left;var E=n.top;x=!0===m||!0===C&&!1!==m&&F?"translate3d("+x+"px, "+E+"px, 0)":"translate("+x+"px,"+E+"px)"}else x=e;P[w]=x;p[u]=(p[u]?p[u]+",":"")+d;p[v]=(p[v]?p[v]+",":"")+c+"ms";p[q]=(p[q]?p[q]+",":"")+f}return b}function Q(a){for(var b in a)if(!("width"!=b&&"height"!=b||"show"!=a[b]&&"hide"!=a[b]&&"toggle"!=a[b]))return!0;return!1}function q(a){for(var b in a)return!1;return!0}function L(a){a=a.toUpperCase();var b={LI:"list-item",TR:"table-row",TD:"table-cell",TH:"table-cell",CAPTION:"table-caption",COL:"table-column",COLGROUP:"table-column-group",TFOOT:"table-footer-group",THEAD:"table-header-group",TBODY:"table-row-group"};return"string"==typeof b[a]?b[a]:"block"}function A(a){return parseFloat(a.replace(a.match(/\D+$/),""))}function D(a){var b=!0;a.each(function(a,d){return b=b&&d.ownerDocument});return b}function R(a,b,k){if(!D(k))return!1;var c=-1<d.inArray(a,S);"width"!=a&&"height"!=a&&"opacity"!=a||parseFloat(b)!==parseFloat(k.css(a))||(c=!1);return c}var G=d.fn.animate,H=d.fn.stop,S="top right bottom left opacity height width".split(" "),B=["top","right","bottom","left"],l=["-webkit-","-moz-","-o-",""],T=["avoidTransforms","useTranslate3d","leaveTransforms"],K=/^([+-]=)?([\d+-.]+)(.*)$/,U=/([A-Z])/g,N={secondary:{},meta:{top:0,right:0,bottom:0,left:0}},r="jQe",I=null,y=!1,z=(document.body||document.documentElement).style,J=void 0!==z.WebkitTransition||void 0!==z.MozTransition||void 0!==z.OTransition||void 0!==z.transition,F="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,C=F;d.expr&&d.expr.filters&&(I=d.expr.filters.animated,d.expr.filters.animated=function(a){return d(a).data("events")&&d(a).data("events")["webkitTransitionEnd oTransitionEnd transitionend"]?!0:I.call(this,a)});d.extend({toggle3DByDefault:function(){return C=!C},toggleDisabledByDefault:function(){return y=!y},setDisabledByDefault:function(a){return y=a}});d.fn.translation=function(){if(!this[0])return null;var a=window.getComputedStyle(this[0],null),b={x:0,y:0};if(a)for(var d=l.length-1;0<=d;d--){var c=a.getPropertyValue(l[d]+"transform");if(c&&/matrix/i.test(c)){a=c.replace(/^matrix\(/i,"").split(/, |\)$/g);b={x:parseInt(a[4],10),y:parseInt(a[5],10)};break}}return b};d.fn.animate=function(a,b,k,c){a=a||{};var f=!("undefined"!==typeof a.bottom||"undefined"!==typeof a.right),e=d.speed(b,k,c),g=0,n=function(){g--;0===g&&"function"===typeof e.complete&&e.complete.apply(this,arguments)};return!0===("undefined"!==typeof a.avoidCSSTransitions?a.avoidCSSTransitions:y)||!J||q(a)||Q(a)||0>=e.duration||e.step?G.apply(this,arguments):this[!0===e.queue?"queue":"each"](function(){var b=d(this),c=d.extend({},e),k=function(c){var e=b.data(r)||{original:{}},g={};if(2==c.eventPhase){if(!0!==a.leaveTransforms){for(c=l.length-1;0<=c;c--)g[l[c]+"transform"]="";if(f&&"undefined"!==typeof e.meta){c=0;for(var h;h=B[c];++c){var k=e.meta[h+"_o"];"undefined"!==typeof k&&(g[h]=k+"px",d(this).css(h,g[h]))}}}b.unbind("webkitTransitionEnd oTransitionEnd transitionend").css(e.original).css(g).data(r,null);"hide"===a.opacity&&(elem=b[0],elem.style&&(display=d.css(elem,"display"),"none"===display||d._data(elem,"olddisplay")||d._data(elem,"olddisplay",display),elem.style.display="none"),b.css("opacity",""));n.call(this)}},p={bounce:"cubic-bezier(0.0, 0.35, .5, 1.3)",linear:"linear",swing:"ease-in-out",easeInQuad:"cubic-bezier(0.550, 0.085, 0.680, 0.530)",easeInCubic:"cubic-bezier(0.550, 0.055, 0.675, 0.190)",easeInQuart:"cubic-bezier(0.895, 0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755, 0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470, 0.000, 0.745, 0.715)",easeInExpo:"cubic-bezier(0.950, 0.050, 0.795, 0.035)",easeInCirc:"cubic-bezier(0.600, 0.040, 0.980, 0.335)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeOutQuad:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",easeOutCubic:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",easeOutQuart:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeOutExpo:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.320, 1.275)",easeInOutQuad:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1.000)",easeInOutQuart:"cubic-bezier(0.770, 0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860, 0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",easeInOutExpo:"cubic-bezier(1.000, 0.000, 0.000, 1.000)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.150, 0.860)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},t={},p=p[c.easing||"swing"]?p[c.easing||"swing"]:c.easing||"swing",h;for(h in a)if(-1===d.inArray(h,T)){var u=-1<d.inArray(h,B),v=w(b,a[h],h,u&&!0!==a.avoidTransforms);R(h,v,b)?M(b,h,c.duration,p,v,u&&!0!==a.avoidTransforms,f,a.useTranslate3d):t[h]=a[h]}b.unbind("webkitTransitionEnd oTransitionEnd transitionend");h=b.data(r);if(!h||q(h)||q(h.secondary))c.queue=!1;else{g++;b.css(h.properties);var y=h.secondary;setTimeout(function(){b.bind("webkitTransitionEnd oTransitionEnd transitionend",k).css(y)})}q(t)||(g++,G.apply(b,[t,{duration:c.duration,easing:d.easing[c.easing]?c.easing:d.easing.swing?"swing":"linear",complete:n,queue:c.queue}]));return!0})};d.fn.animate.defaults={};d.fn.stop=function(a,b,k){if(!J)return H.apply(this,[a,b]);a&&this.queue([]);this.each(function(){var c=d(this),f=c.data(r);if(f&&!q(f)){var e,g={};if(b){if(g=f.secondary,!k&&void 0!==typeof f.meta.left_o||void 0!==typeof f.meta.top_o)for(g.left=void 0!==typeof f.meta.left_o?f.meta.left_o:"auto",g.top=void 0!==typeof f.meta.top_o?f.meta.top_o:"auto",e=l.length-1;0<=e;e--)g[l[e]+"transform"]=""}else if(!q(f.secondary)){var n=window.getComputedStyle(c[0],null);if(n)for(var m in f.secondary)if(f.secondary.hasOwnProperty(m)&&(m=m.replace(U,"-$1").toLowerCase(),g[m]=n.getPropertyValue(m),!k&&/matrix/i.test(g[m])))for(e=g[m].replace(/^matrix\(/i,"").split(/, |\)$/g),g.left=parseFloat(e[4])+parseFloat(c.css("left"))+"px"||"auto",g.top=parseFloat(e[5])+parseFloat(c.css("top"))+"px"||"auto",e=l.length-1;0<=e;e--)g[l[e]+"transform"]=""}c.unbind("webkitTransitionEnd oTransitionEnd transitionend");c.css(f.original).css(g).data(r,null)}else H.apply(c,[a,b])});return this}});var swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=!1,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=!1,isExpressInstallActive=!1,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=!0,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,ie=!+"\v1",playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=!0;ie=!1;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){d=a.GetVariable("$version");if(d){ie=!0;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}}catch(e){}}
return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac}}(),onDomLoad=function(){if(!ua.w3){return}
if((typeof doc.readyState!=UNDEF&&doc.readyState=="complete")||(typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))){callDomLoadFunctions()}
if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,!1)}
if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions()}});if(win==top){(function(){if(isDomLoaded){return}
try{doc.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}
callDomLoadFunctions()})()}}
if(ua.wk){(function(){if(isDomLoaded){return}
if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return}
callDomLoadFunctions()})()}
addLoadEvent(callDomLoadFunctions)}}();function callDomLoadFunctions(){if(isDomLoaded){return}
try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t)}catch(e){return}
isDomLoaded=!0;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]()}}
function addDomLoadEvent(fn){if(isDomLoaded){fn()}else{domLoadFnArr[domLoadFnArr.length]=fn}}
function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,!1)}else if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,!1)}else if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn)}else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn()}}else{win.onload=fn}}
function main(){if(plugin){testPlayerVersion()}else{matchVersions()}}
function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d=t.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}else if(counter<10){counter++;setTimeout(arguments.callee,10);return}
b.removeChild(o);t=null;matchVersions()})()}else{matchVersions()}}
function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:!1,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,!0);if(cb){cbObj.success=!0;cbObj.ref=getObjectById(id);cb(cbObj)}}else if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class")}
if(obj.getAttribute("align")){att.align=obj.getAttribute("align")}
var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value")}}
showExpressInstall(att,par,id,cb)}else{displayAltContent(obj);if(cb){cb(cbObj)}}}}else{setVisibility(id,!0);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=!0;cbObj.ref=o}
cb(cbObj)}}}}}
function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o}else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n}}}
return r}
function canExpressInstall(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312)}
function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=!0;storedCallbackFn=callbackFn||null;storedCallbackObj={success:!1,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null}else{storedAltContent=obj;storedAltContentId=replaceElemIdStr}
att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||(!/%$/.test(att.width)&&parseInt(att.width,10)<310)){att.width="310"}
if(typeof att.height==UNDEF||(!/%$/.test(att.height)&&parseInt(att.height,10)<137)){att.height="137"}
doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv}else{par.flashvars=fv}
if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}
createSWF(att,par,replaceElemIdStr)}}
function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.replaceChild(abstractAltContent(obj),obj)}}
function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML}else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(!0))}}}}}
return ac}
function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r}
if(el){if(typeof attObj.id==UNDEF){attObj.id=id}
if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i]}else if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"'}else if(i.toLowerCase()!="classid"){att+=' '+i+'="'+attObj[i]+'"'}}}
var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />'}}
el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+'>'+par+'</object>';objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id)}else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m])}else if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m])}}}
for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n])}}
el.parentNode.replaceChild(o,el);r=o}}
return r}
function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p)}
function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id)}else{setTimeout(arguments.callee,10)}})()}else{obj.parentNode.removeChild(obj)}}}
function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null}}
obj.parentNode.removeChild(obj)}}
function getElementById(id){var el=null;try{el=doc.getElementById(id)}catch(e){}
return el}
function createElement(el){return doc.createElement(el)}
function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn]}
function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:!1}
function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return}
var h=doc.getElementsByTagName("head")[0];if(!h){return}
var m=(media&&typeof media=="string")?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null}
if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1]}
dynamicStylesheetMedia=m}
if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl)}}else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"))}}}
function setVisibility(id,isVisible){if(!autoHideShow){return}
var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v}else{createCSS("#"+id,"visibility:"+v)}}
function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s}
var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2])}
var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j])}
for(var k in ua){ua[k]=null}
ua=null;for(var l in swfobject){swfobject[l]=null}
swfobject=null})}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,!1)}else if(callbackFn){callbackFn({success:!1,id:objectIdStr})}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr)}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:!1,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,!1);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i]}}
att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j]}}
if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k]}else{par.flashvars=k+"="+flashvarsObj[k]}}}
if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,!0)}
callbackObj.success=!0;callbackObj.ref=obj}else if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return}else{setVisibility(replaceElemIdStr,!0)}
if(callbackFn){callbackFn(callbackObj)}})}else if(callbackFn){callbackFn(callbackObj)}},switchOffAutoHideShow:function(){autoHideShow=!1},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]}},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr)}else{return undefined}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn)}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr)}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean)}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1]}
if(param==null){return urlEncodeIfNecessary(q)}
var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)))}}}
return""},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,!0);if(ua.ie&&ua.win){storedAltContent.style.display="block"}}
if(storedCallbackFn){storedCallbackFn(storedCallbackObj)}}
isExpressInstallActive=!1}}}}();(function(){if(window.google&&google.gears){return}
var F=null;if(typeof GearsFactory!='undefined'){F=new GearsFactory()}else{try{F=new ActiveXObject('Gears.Factory');if(F.getBuildInfo().indexOf('ie_mobile')!=-1){F.privateSetGlobalObject(this)}}catch(e){if((typeof navigator.mimeTypes!='undefined')&&navigator.mimeTypes["application/x-googlegears"]){F=document.createElement("object");F.style.display="none";F.width=0;F.height=0;F.type="application/x-googlegears";document.documentElement.appendChild(F)}}}
if(!F){return}
if(!window.google){google={}}
if(!google.gears){google.gears={factory:F}}})();Persist=(function(){var VERSION='0.3.1',P,B,esc,init,empty,ec;ec=(function(){var EPOCH='Thu, 01-Jan-1970 00:00:01 GMT',RATIO=1000*60*60*24,KEYS=['expires','path','domain'],esc=escape,un=unescape,doc=document,me;var get_now=function(){var r=new Date();r.setTime(r.getTime());return r};var cookify=function(c_key,c_val){var i,key,val,r=[],opt=(arguments.length>2)?arguments[2]:{};r.push(esc(c_key)+'='+esc(c_val));for(var idx=0;idx<KEYS.length;idx++){key=KEYS[idx];val=opt[key];if(val){r.push(key+'='+val)}}
if(opt.secure){r.push('secure')}
return r.join('; ')};var alive=function(){var k='__EC_TEST__',v=new Date();v=v.toGMTString();this.set(k,v);this.enabled=(this.remove(k)==v);return this.enabled};me={set:function(key,val){var opt=(arguments.length>2)?arguments[2]:{},now=get_now(),expire_at,cfg={};if(opt.expires){if(opt.expires==-1){cfg.expires=-1}else{var expires=opt.expires*RATIO;cfg.expires=new Date(now.getTime()+expires);cfg.expires=cfg.expires.toGMTString()}}
var keys=['path','domain','secure'];for(var i=0;i<keys.length;i++){if(opt[keys[i]]){cfg[keys[i]]=opt[keys[i]]}}
var r=cookify(key,val,cfg);doc.cookie=r;return val},has:function(key){key=esc(key);var c=doc.cookie,ofs=c.indexOf(key+'='),len=ofs+key.length+1,sub=c.substring(0,key.length);return((!ofs&&key!=sub)||ofs<0)?false:!0},get:function(key){key=esc(key);var c=doc.cookie,ofs=c.indexOf(key+'='),len=ofs+key.length+1,sub=c.substring(0,key.length),end;if((!ofs&&key!=sub)||ofs<0){return null}
end=c.indexOf(';',len);if(end<0){end=c.length}
return un(c.substring(len,end))},remove:function(k){var r=me.get(k),opt={expires:EPOCH};doc.cookie=cookify(k,'',opt);return r},keys:function(){var c=doc.cookie,ps=c.split('; '),i,p,r=[];for(var idx=0;idx<ps.length;idx++){p=ps[idx].split('=');r.push(un(p[0]))}
return r},all:function(){var c=doc.cookie,ps=c.split('; '),i,p,r=[];for(var idx=0;idx<ps.length;idx++){p=ps[idx].split('=');r.push([un(p[0]),un(p[1])])}
return r},version:'0.2.1',enabled:!1};me.enabled=alive.call(me);return me}());var index_of=(function(){if(Array.prototype.indexOf){return function(ary,val){return Array.prototype.indexOf.call(ary,val)}}else{return function(ary,val){var i,l;for(var idx=0,len=ary.length;idx<len;idx++){if(ary[idx]==val){return idx}}
return-1}}})();empty=function(){};esc=function(str){return'PS'+str.replace(/_/g,'__').replace(/ /g,'_s')};var C={search_order:['localstorage','globalstorage','gears','cookie','ie','flash'],name_re:/^[a-z][a-z0-9_ \-]+$/i,methods:['init','get','set','remove','load','save','iterate'],sql:{version:'1',create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?",keys:"SELECT * FROM persist_data"},flash:{div_id:'_persist_flash_wrap',id:'_persist_flash',path:'persist.swf',size:{w:1,h:1},params:{autostart:!0}}};B={gears:{size:-1,test:function(){return(window.google&&window.google.gears)?true:!1},methods:{init:function(){var db;db=this.db=google.gears.factory.create('beta.database');db.open(esc(this.name));db.execute(C.sql.create).close()},get:function(key){var r,sql=C.sql.get;var db=this.db;var ret;db.execute('BEGIN').close();r=db.execute(sql,[key]);ret=r.isValidRow()?r.field(0):null;r.close();db.execute('COMMIT').close();return ret},set:function(key,val){var rm_sql=C.sql.remove,sql=C.sql.set,r;var db=this.db;var ret;db.execute('BEGIN').close();db.execute(rm_sql,[key]).close();db.execute(sql,[key,val]).close();db.execute('COMMIT').close();return val},remove:function(key){var get_sql=C.sql.get,sql=C.sql.remove,r,val=null,is_valid=!1;var db=this.db;db.execute('BEGIN').close();db.execute(sql,[key]).close();db.execute('COMMIT').close();return!0},iterate:function(fn,scope){var key_sql=C.sql.keys;var r;var db=this.db;r=db.execute(key_sql);while(r.isValidRow()){fn.call(scope||this,r.field(0),r.field(1));r.next()}
r.close()}}},globalstorage:{size:5*1024*1024,test:function(){if(window.globalStorage){var domain='127.0.0.1';if(this.o&&this.o.domain){domain=this.o.domain}
try{var dontcare=globalStorage[domain];return!0}catch(e){if(window.console&&window.console.warn){console.warn("globalStorage exists, but couldn't use it because your browser is running on domain:",domain)}
return!1}}else{return!1}},methods:{key:function(key){return esc(this.name)+esc(key)},init:function(){this.store=globalStorage[this.o.domain]},get:function(key){key=this.key(key);return this.store.getItem(key)},set:function(key,val){key=this.key(key);this.store.setItem(key,val);return val},remove:function(key){var val;key=this.key(key);val=this.store.getItem[key];this.store.removeItem(key);return val}}},localstorage:{size:-1,test:function(){try{if(window.localStorage&&window.localStorage.setItem("test",null)==undefined){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var ffVersion=RegExp.$1;if(ffVersion>=9){return!0}
if(window.location.protocol=='file:'){return!1}}else{return!0}}else{return!1}
return window.localStorage?true:!1}catch(e){return!1}},methods:{key:function(key){return this.name+'>'+key},init:function(){this.store=localStorage},get:function(key){key=this.key(key);return this.store.getItem(key)},set:function(key,val){key=this.key(key);this.store.setItem(key,val);return val},remove:function(key){var val;key=this.key(key);val=this.store.getItem(key);this.store.removeItem(key);return val},iterate:function(fn,scope){var l=this.store,key,keys;for(var i=0;i<l.length;i++){key=l.key(i);keys=key.split('>');if((keys.length==2)&&(keys[0]==this.name)){fn.call(scope||this,keys[1],l.getItem(key))}}}}},ie:{prefix:'_persist_data-',size:64*1024,test:function(){return window.ActiveXObject?true:!1},make_userdata:function(id){var el=document.createElement('div');el.id=id;el.style.display='none';el.addBehavior('#default#userdata');document.body.appendChild(el);return el},methods:{init:function(){var id=B.ie.prefix+esc(this.name);this.el=B.ie.make_userdata(id);if(this.o.defer){this.load()}},get:function(key){var val;key=esc(key);if(!this.o.defer){this.load()}
val=this.el.getAttribute(key);return val},set:function(key,val){key=esc(key);this.el.setAttribute(key,val);if(!this.o.defer){this.save()}
return val},remove:function(key){var val;key=esc(key);if(!this.o.defer){this.load()}
val=this.el.getAttribute(key);this.el.removeAttribute(key);if(!this.o.defer){this.save()}
return val},load:function(){this.el.load(esc(this.name))},save:function(){this.el.save(esc(this.name))}}},cookie:{delim:':',size:4000,test:function(){return P.Cookie.enabled?true:!1},methods:{key:function(key){return this.name+B.cookie.delim+key},get:function(key,fn){var val;key=this.key(key);val=ec.get(key);return val},set:function(key,val,fn){key=this.key(key);ec.set(key,val,this.o);return val},remove:function(key,val){var val;key=this.key(key);val=ec.remove(key);return val}}},flash:{test:function(){try{if(!swfobject){return!1}}catch(e){return!1}
var major=swfobject.getFlashPlayerVersion().major;return(major>=8)?true:!1},methods:{init:function(){if(!B.flash.el){var key,el,fel,cfg=C.flash;el=document.createElement('div');el.id=cfg.div_id;fel=document.createElement('div');fel.id=cfg.id;el.appendChild(fel);document.body.appendChild(el);B.flash.el=swfobject.createSWF({id:cfg.id,data:this.o.swf_path||cfg.path,width:cfg.size.w,height:cfg.size.h},cfg.params,cfg.id)}
this.el=B.flash.el},get:function(key){var val;key=esc(key);val=this.el.get(this.name,key);return val},set:function(key,val){var old_val;key=esc(key);old_val=this.el.set(this.name,key,val);return old_val},remove:function(key){var val;key=esc(key);val=this.el.remove(this.name,key);return val}}}};init=function(){var i,l,b,key,fns=C.methods,keys=C.search_order;for(var idx=0,len=fns.length;idx<len;idx++){P.Store.prototype[fns[idx]]=empty}
P.type=null;P.size=-1;for(var idx2=0,len2=keys.length;!P.type&&idx2<len2;idx2++){b=B[keys[idx2]];if(b.test()){P.type=keys[idx2];P.size=b.size;for(key in b.methods){P.Store.prototype[key]=b.methods[key]}}}
P._init=!0};P={VERSION:VERSION,type:null,size:0,add:function(o){B[o.id]=o;C.search_order=[o.id].concat(C.search_order);init()},remove:function(id){var ofs=index_of(C.search_order,id);if(ofs<0){return}
C.search_order.splice(ofs,1);delete B[id];init()},Cookie:ec,Store:function(name,o){if(!C.name_re.exec(name)){throw new Error("Invalid name")}
if(!P.type){throw new Error("No suitable storage found")}
o=o||{};this.name=name;o.domain=o.domain||location.hostname||'localhost';o.domain=o.domain.replace(/:\d+$/,'');o.domain=(o.domain=='localhost')?'':o.domain;this.o=o;o.expires=o.expires||365*2;o.path=o.path||'/';if(this.o.search_order){C.search_order=this.o.search_order;init()}
this.init()}};init();return P})();var _chess_small_board_domain=document.domain;var _chess_small_board_draw_requests=[];var _chess_small_board_lang='ru';(function(){var newscript=document.createElement('script');newscript.type='text/javascript';newscript.async=!0;newscript.src=location.protocol+"//"+_chess_small_board_domain+"/js/smallboard_body.js?3";(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(newscript)})();drawSmallBoard=function(){_chess_small_board_draw_requests.push(arguments)};/*!
* Bootstrap.js by @fat & @mdo
* Copyright 2013 Twitter, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(".dropdown-backdrop").remove(),e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",r),s.toggleClass("open")),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);var ua=navigator.userAgent.toLowerCase();var isIE=(ua.indexOf("msie")!=-1&&ua.indexOf("opera")==-1&&ua.indexOf("webtv")==-1);var isOpera=(ua.indexOf("opera")!=-1);var isFF=(ua.indexOf("gecko")!=-1);var isSafari=(ua.indexOf("safari")!=-1);var isKonqueror=(ua.indexOf("konqueror")!=-1);var isAndroid=ua.indexOf("android")>-1;var IE6=!1;var App=App||{};App.piecesImages={};App.dataUriSupported=!isAndroid;App.windowLoaded=!1;App.showNewGamePopup=!1;App.urlTo=function(url,params,use_ext){use_ext=typeof use_ext=='undefined'?!0:use_ext;if(use_ext&&url.substr(url.length-1,1)!="/"){url+="."+file_ext}
if(params){if(typeof params=='object'){params=$.param(params)}
url+="?"+params}
return url};App.redirectInternal=function(url,params,use_ext){location.href=App.urlTo(url,params,use_ext)};App.winOpen=function(url,width,height){return window.open(url,"","tollbar=0,location=0,menubar=0,width="+width+",height="+height)};App.getParam=function(variable){var query=window.location.search.substring(1);var vars=query.split('&');for(var i=0;i<vars.length;i++){var pair=vars[i].split('=');if(decodeURIComponent(pair[0])==variable){return decodeURIComponent(pair[1])}}
return null};App.isMobile=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i);App.onload=function(callback){if(App.isMobile||isIE){if(App.windowLoaded){callback.call(window)}else{$(window).bind("load",callback)}}else{$(callback)}};App.gaEvent=function(category,action,label){if(typeof ga!='undefined'){ga('send','event',category,action,label)}else{}};App.gaPageView=function(page){if(typeof ga!='undefined'){ga('send','pageview',page)}};App.gaEventWithParams=function(category,action,params){var t=[];for(var key in params){if(params.hasOwnProperty(key)){t.push(key+'='+params[key])}}
App.gaEvent(category,action,t.join(' | '))};App.socket=null;App.sounds={};var mouseX=0,mouseY=0;var timer1=null;function uInfoOver(uid,login){if(!login)login='';clearTimeout(timer1);$("#uInfo").html('<div">...</div>').css({left:mouseX-50,top:mouseY+20}).show();$("#uInfo").load(App.urlTo("/user/shortinfo",{user_login:login,user_id:uid,cnt:Math.random()}),function(){initTooltips("#uInfo")})}
function uInfoOut(){timer1=setTimeout(uInfoClose,500)}
function uInfoClose(){$("#uInfo").html('').hide()}
function initTooltips(cnt){cnt=cnt||document;$(cnt).tooltip({selector:"a[rel=tooltip]"});$(".tooltip-above",cnt).tooltip({placement:"top"});$(".tooltip-under",cnt).tooltip({placement:"bottom"});$(".tooltip-left",cnt).tooltip({placement:"left"});$(".tooltip-right",cnt).tooltip({placement:"right"})}
$(window).bind("load",function(){App.windowLoaded=!0});App.sounds={};App.playSound=function(sound,force){if(sounds_on||force){if(App.sounds&&App.sounds[sound]){App.sounds[sound].play()}}};App.playSoundOnce=function(sound){if(sounds_on){var name="sound_"+sound;var d=200;setTimeout(function(){var val=parseInt(App.storage.get(name))||0;var now=new Date().getTime();if(Math.abs(now-val)>2000){App.storage.set(name,new Date().getTime());App.sounds[sound].play();App.storage.set(name,0)}},Math.round(Math.random()*d))}};App.reportError=function(error_type,error_name,details){App.gaEvent(error_type,error_name,details)};App.storage=new Persist.Store('CS',{swf_path:'/i/swf/persist.swf'});App.storageSet=function(key,val){if(App.storage){App.storage.set(key,JSON.stringify(val))}};App.storageGet=function(key){if(App.storage){var val=App.storage.get(key);if(val){return JSON.parse(val)}else{return null}}};App.hideAdBlockMessage=function(){$(".adBlockMessage").hide();var d=new Date();d.setMinutes(d.getMinutes()+5);setCookie('adb','1',d.toString(),"/");App.gaEvent('AdBlockMsg',"hide",cs_user.login)};function uInfoMove(){}(function($){if(isOpera){$(".modal.fade").removeClass("fade");$("html").addClass('opera')}
$(document).mousemove(function(e){mouseX=e.pageX;mouseY=e.pageY});App.onload(function(){var authtoken=App.storage.get("authtoken");var cookietoken=getCookie("authtoken");if(!authtoken||authtoken=="null"){if(cookietoken){App.storage.set("authtoken",cookietoken)}}else{if(authtoken!=cookietoken&&authtoken.length<20){var expire=new Date();expire.setFullYear(expire.getFullYear()+1);setCookie("authtoken",authtoken,expire.toString(),"/")}else{App.storage.set("authtoken",cookietoken)}}
var newGameForm=$("#newGameForm");if(newGameForm&&newGameForm.modal){newGameForm.modal({show:!1});if(App.isMobile){newGameForm.css("top","285px")}}
initTooltips();$("a[data-toggle=popover]").popover({html:!0}).click(function(e){if($(this).hasClass('preventDefault'))e.preventDefault()});if(App.isMobile)App.showNewGamePopup=!1;$(document).delegate(".create-new-game","click",function(){if(App.showNewGamePopup){newGameForm.modal("show");var $this=$(this);var showAdditions=!1;if($this.data("users")){showAdditions=!0;$("#new_game_users").val($this.data("users"))}
if(showAdditions){$("#newGameAdditions").slideDown()}
return!1}});$('body').delegate('a[data-confirm], button[data-confirm], input[data-confirm]','click',function(){return confirm($(this).data('confirm'))});$("a[data-toggle=slide]").click(function(){var target=$(this.hash);target.slideToggle("fast");return!1});$("#create_new_game_form").live('submit',function(){return!1});$(document).on("mouseover",".user-link",function(){var $this=$(this);uInfoOver($this.data("userid"),$this.data("login"))});$(document).on("mouseout",".user-link",function(){uInfoOut()});var abuseForm=$("#abuse_form");var abuseData=null;$("a.report_abuse").live("click",function(){$("#abuse_comment").val('');var link=$(this);if(!abuseData){abuseData={item_type:link.data("type"),item_id:link.data("id"),text:$("#"+link.data("container-id")).html(),guilty_user_id:link.data("guilty-id"),reporter_user_id:link.data("reporter-id")}}else{abuseData=null}
abuseForm.modal();return!1});$("#send_abuse").click(function(){abuseData.comment=$("#abuse_comment").val();abuseData.action="report";var $this=$(this);if(!$this.hasClass("disabled")){$this.addClass("disabled");$.post(App.urlTo("/report/abuse"),abuseData,function(data){abuseForm.modal("hide");if(data.success){alert("Жалоба отправлена. В ближайшее время она будет рассмотрена.")}else{if(data.errors){var errorMsg=data.errors.join('\n');alert("При отправке жалобы возникли ошибки:\n"+errorMsg)}else{alert("Данные не получены, проверьте соединение c интернетом.")}}
abuseData=null},"json").always(function(){$this.removeClass("disabled")})}
return!1});$("#cancel_abuse").click(function(){abuseData=null});if(App.onloadHandlers&&App.onloadHandlers.length>0){for(var a in App.onloadHandlers){if(App.onloadHandlers.hasOwnProperty(a)){App.onloadHandlers[a].call(document)}}};if(!App.isMobile){var fixedHeaderShowed=!1;var fixedHeader=$(".fixed-header");var maxD=20;var showFixedHeader=function(){var d=$("header").height()-$(document).scrollTop();if(d>0){if(d<maxD){fixedHeader.fadeTo(0,(maxD-d)/maxD)}else{fixedHeader.fadeTo(0,0);fixedHeader.hide()}}else{fixedHeader.fadeTo(0,1)}};$(window).scroll(showFixedHeader);showFixedHeader()}
var lastPingTime=null;$(document).bind("comet:ping",function(){lastPingTime=new Date().getTime()});App.lastResponseTimes=[];$(document).bind("comet:pong",function(){App.responseTime=new Date().getTime()-lastPingTime;$("#response_time").html(App.responseTime+(App.chessCool?'ms':" мс"));App.logResponseTime(App.responseTime)});$(document).bind("comet:disconnected",function(){$("#response_time").html("-");App.responseTimer=setTimeout(function(){App.logResponseTime('-')},20000)});$(document).bind("comet:connected",function(){if(App.responseTimer)clearTimeout(App.responseTimer);pushClient.ping();setTimeout(function(){pushClient.ping()},2000)});pushClient.ping();App.logResponseTime=function(val){App.lastResponseTimes.push(App.responseTime);if(App.lastResponseTimes.length>3)
App.lastResponseTimes.shift()};App.getAverageResponeTime=function(){if(App.lastResponseTimes.length<3){return 0}
var sum=0;for(var i=0;i<App.lastResponseTimes.length;i++){if(App.lastResponseTimes[i]=='-'&&i==2){return 9999}else{sum+=App.lastResponseTimes[i]}}
return Math.round(sum/App.lastResponseTimes.length)};if(($.browser.msie&&parseFloat($.browser.version)<9)||($.browser.opera&&$.browser.version<10)){$("html").addClass("oldIE");setTimeout(function(){$("#oldBrowser").show()},0)}
App.sounds.step1=new Howl({src:['/i/sounds/step_1.ogg','/i/sounds/step_1.mp3','/i/sounds/step_1.aac','/i/sounds/step_1.wav'],html5:!0});App.sounds.step2=new Howl({src:['/i/sounds/step_2.ogg','/i/sounds/step_2.mp3','/i/sounds/step_2.aac','/i/sounds/step_2.wav'],html5:!0});App.sounds.start1=new Howl({src:['/i/sounds/start_1.ogg','/i/sounds/start_1.mp3','/i/sounds/start_1.aac','/i/sounds/start_1.wav'],html5:!0});App.sounds.gamestart=new Howl({src:['/i/sounds/start_2.ogg','/i/sounds/start_2.mp3','/i/sounds/start_2.aac','/i/sounds/start_2.wav'],html5:!0});App.sounds.msg=new Howl({src:['/i/sounds/msg.ogg','/i/sounds/msg.mp3','/i/sounds/msg.aac','/i/sounds/msg.wav'],html5:!0});if($.browser.opera){var originalAnimate=jQuery.fn.animate;jQuery.fn.animate=function(props,time,easingOrFn,fn){if(typeof time=='number'){var realFn=typeof easingOrFn=='function'?easingOrFn:(typeof fn=='function'?fn:null);if(realFn){if(typeof easingOrFn=='function')arguments[2]=undefined;else arguments[3]=undefined;setTimeout(realFn,time)}}
originalAnimate.apply(this,arguments)}}
if(App.isMobile){$(".float-nav").removeClass('float-nav');$(".site-menu .icon-chevron-right").hide()}
setCookie("window_width",$(window).width());var processBlackListToggleButtons=function(){$(".black-list-toggler").each(function(){var $this=$(this);var text=$this.data("added")?'Убрать из "Черного списка"':'Добавить в "Черный список"';$this.text(text)})};$(".black-list-toggler").click(function(){var $this=$(this);$.post(App.urlTo("/user/black_list",{action:'add_remove'}),{user_id:$this.data("user-id")}).done(function(data){if(data.success){var text=data.type=='added'?'Пользователь добавлен в Черный список.':'Пользователь удален из Черного списка';alert(text);$this.data("added",data.type=='added');processBlackListToggleButtons()}else{if(data.error_msg){alert(data.error_msg)}else{alert('Ошибка, попробуйте позже.')}}}).failure(function(){alert('Ошибка, попробуйте позже.')});return!1});processBlackListToggleButtons();$(".post-request").click(function(){var f=document.createElement("form");f.setAttribute('method',"post");f.setAttribute('action',$(this).attr('href'));$(document.body).append(f);f.submit();return!1});$("a[data-confirm]").click(function(){if(confirm($(this).data("confirm"))){location.href=$(this).attr("href")}
return!1});$('input, textarea').placeholder();$(document).on("click",".add-remove-friend",function(){var self=this;var $this=$(this);var action=$this.data('action'),userId=$this.data('user-id'),userLogin=$this.data('login'),postAction=$this.data('post-action'),confirmText=$this.data('confirm-text');var msg='Добавить в друзья пользователя '+userLogin+'?';if(action=='remove')msg='Убрать из друзей пользователя '+userLogin+'?';if(confirmText)msg=confirmText;if(confirm(msg)){$.post(App.urlTo('/user/friends',{action:action}),{user_id:userId},function(data){if(data.error){alert(data.error)}else if(action=='add'){if(data.already_exists)alert('Этот пользователь уже у вас в друзьях.');else{alert(userLogin+' добавлен в друзья.');if(postAction)(function(){eval(postAction)}).call(self);else{$this.data('action','remove');$this.html('убрать из друзей')}}}else if(action=='remove'){if(data.success){alert(userLogin+" удален из друзей.");if(postAction)(function(){eval(postAction)}).call(self);else{$this.data('action','add');$this.html('добавить в друзья')}}else alert("Пользователь не найден в друзьях")}})}});var chatLoaded=0;$('#chat_dialog_link').click(function(){if(chatLoaded==0){chatLoaded=1;var $this=$(this);$this.append("<i class='icn-loader'></i>")
$.cachedScript(['/js/knockout.js?'+src_version,'/js/jqueryui/jquery-ui-1.10.3.custom.min.js?'+src_version,'/js/chat.js?'+src_version]).done(function(){startSiteChat();chatLoaded=2;$this.find(".icn-loader").remove()}).fail(function(){chatLoaded=0})}else{if(chatLoaded==2)startSiteChat()}});function adBlockDetected(){var c=getCookie('adb');if(c!=1){var d=new Date();d.setDate(d.getDate()+1);setCookie('adb','1',d.toString(),"/");App.gaEvent('AdBlockMsg',"detected",cs_user.login||'(guest)')}
$(document).trigger("adblock");$(".adBlockMessage").removeClass('hide');$(".forgood").click(function(e){$("#forgood_popup").modal();e.stopPropagation();return!1})}
function adBlockNotDetected(){var c=getCookie('adb');if(c>0){var d=new Date();d.setDate(d.getDate()+30);setCookie('adb','0',d.toString(),"/");App.gaEvent('AdBlockMsg',"disabled",cs_user.login||'(guest)')}}
$(document).on("ab:detected",function(){App.adblockDetected=!0;checkAdb()});var adbAlreadyChecked=!1;function checkAdb(){if(!App.chessCool){if(!adbAlreadyChecked){if(App.adblockDetected){adbAlreadyChecked=!0;if(!cs_user.advanced){adBlockDetected()}}else{adBlockNotDetected()}}}}
checkAdb();$(".signin-btn a").click(function(){$(".signin-btn").hide();$(".head-span").hide();$(".signin-controls").show()});App.checkSmallBoards=function(){$(".show-smallboard").each(function(){var $el=$(this);if(!$el.hasClass('smallboard-processed')){var fen=$el.data('fen');var hideAnalyzeLink=$el.data('hideAnalyzeLink');var id=$el.attr('id');if(id&&fen){drawSmallBoard(fen,id,null,{hide_analyze_link:hideAnalyzeLink})}
$el.addClass('smallboard-processed')}})};setTimeout(function(){App.checkSmallBoards();App.countTimeLeft()},1)});window.onbeforeunload=function(){if(pushClient&&pushClient.provider){pushClient.provider.close()}};$(document).on("click",'div.btn-group[data-toggle="buttons-radio"] button',function(){var button=$(this);var group=button.parent('.btn-group');var form=group.parents('form').eq(0);var name=group.attr('data-toggle-name');var hidden=$('input[name="'+name+'"]',form);hidden.val(button.val()).trigger('change')});var $rightBlock=$('.a-right-sticky');if($rightBlock.length===1){var rightAdvShown=null;var rBlockWidth=$rightBlock.width();var minWidthForRightAdv=1010+(rBlockWidth<160?160:rBlockWidth);function changeLayoutForRightAdv(){var windowW=$(window).width();if(windowW>=minWidthForRightAdv){if(rightAdvShown===!1||rightAdvShown===null){var padding=rBlockWidth>240?240:rBlockWidth;$(".a-layout").css("padding-right",padding);$rightBlock.removeClass('hide');rightAdvShown=!0}}else if(rightAdvShown===!0||rightAdvShown===null){$(".a-layout").css("padding-right",'0');$rightBlock.addClass('hide');rightAdvShown=!1}}
if($(window).width()>=minWidthForRightAdv){changeLayoutForRightAdv();$(window).resize(changeLayoutForRightAdv);$(function(){setCookie('layout','big')})}else{changeLayoutForRightAdv();$(".a-right-sticky").addClass('hide');$(function(){setCookie('layout','small')})}}else{$(".a-layout").css("padding-right",'0')}
var showContent=function(){$(".center-content-block").removeClass('vis-hide');$(".content-loading").hide()};if(cs_user&&cs_user.id==="18"){$(document).on("headline:render",function(){showContent()});$(function(){setTimeout(function(){showContent()},1000)})}else{showContent()}})(jQuery);function smile(t,field){addArticleCode("","",field+"_id",t,!0)}
function InsertCode(code,field,text){addArticleCode(code,code,field+"_id")}
function InsertColor(color,field){addArticleCode("color="+color,"color",field+"_id")}
function InsertLink(type,field){App.winOpen(App.urlTo("/forum/link",{field:field,action:type}),350,120)}
function InsertOneTag(code,field){addArticleCode("","",field,"["+code+"]",!0)}
function addArticleCode(code_start,code_end,tid,text,simple){var myArea=document.getElementById(tid);var begin="";var selection="";var end="";if(isFF==!0){if(myArea.selectionStart!=undefined){begin=myArea.value.substr(0,myArea.selectionStart);selection=myArea.value.substr(myArea.selectionStart,myArea.selectionEnd-myArea.selectionStart);end=myArea.value.substr(myArea.selectionEnd)}}else{if(window.getSelection){selection=window.getSelection()}else if(document.getSelection){selection=document.getSelection()}else if(document.selection){selection=document.selection.createRange().text}
var startPos=myArea.value.indexOf(selection);if(startPos!=-1&&selection!=""){var endPos=myArea.value.indexOf(selection)+selection.length;begin=myArea.value.substr(0,startPos);end=myArea.value.substr(endPos,myArea.value.length)}else begin=myArea.value}
if(text)selection=text;var txt=selection;if(!simple)
var txt="["+code_start+"]"+selection+"[/"+code_end+"]";if(document.selection){myArea.focus();sel=document.selection.createRange();sel.text=txt}else myArea.value=begin+txt+end;myArea.focus()};var ge=function(id){return document.getElementById(id)}
function gameopen(win,width,height){App.winOpen(win,width,height)}
function entergame(id){gameopen(site_url+"/play/game/index."+file_ext+"?id="+id)}
function GetRandomStr(){var ss="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM";var str="";for(var i=0;i<35;i++)str=str+""+ss.charAt(Math.random()*ss.length);return str}
function InvertDisplay(obj){if(ge(obj).style.display=='')ge(obj).style.display='none';else ge(obj).style.display=''}
function ConfirmDelAct(act_id,force){ConfirmDel("Вы действительно хотите удалить эту заявку?",'?function=del_active&active_id='+act_id,force)}
function ConfirmDelMes(m_id,t_id,page){ConfirmDel("Вы действительно хотите удалить это сообщение?",'?action=delete&id='+m_id+'&t='+t_id+'&page='+page)}
function ConfirmDel(txt,url,force){if(force||confirm(txt))location.href=url}
if(typeof $!='undefined'){$(document).mousemove(function(e){mouseX=e.pageX;mouseY=e.pageY});jQuery.fn.outerScrollHeight=function(includeMargin){var element=this[0];var jElement=$(element);var totalHeight=element.scrollHeight;totalHeight+=jElement.outerHeight(includeMargin)-jElement.innerHeight();return totalHeight};jQuery.fn.outerScrollWidth=function(includeMargin){var element=this[0];var jElement=$(element);var totalWidth=element.scrollWidth;totalWidth+=jElement.outerWidth(includeMargin)-jElement.innerWidth();return totalWidth}}
function urlencode(str){str=escape(str);str=str.replace('+','%2B').replace('%20','+').replace('*','%2A').replace('/','%2F').replace('@','%40');return str}
function urldecode(str){str=str.replace('+',' ');str=unescape(str);return str}
function getDocumentHeight(){var D=document;return Math.max(Math.max(D.body.scrollHeight,D.documentElement.scrollHeight),Math.max(D.body.offsetHeight,D.documentElement.offsetHeight),Math.max(D.body.clientHeight,D.documentElement.clientHeight))}
function getDocumentWidth(){return(document.body.scrollWidth>document.body.offsetWidth)?document.body.scrollWidth:document.body.offsetWidth}
function getClientWidth(){return document.compatMode=='CSS1Compat'&&!window.opera?document.documentElement.clientWidth:document.body.clientWidth}
function getClientHeight(){return document.compatMode=='CSS1Compat'&&!window.opera?document.documentElement.clientHeight:document.body.clientHeight}
function toNewWindow(pid){var a=document.getElementById(pid);if(a){var ch=a.getElementsByTagName("a");for(var i=0;i<ch.length;i++)ch[i].target="_blank"}}
function getScrollXY(){var scrOfX=0,scrOfY=0;if(typeof(window.pageYOffset)=='number'){scrOfY=window.pageYOffset;scrOfX=window.pageXOffset}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){scrOfY=document.body.scrollTop;scrOfX=document.body.scrollLeft}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){scrOfY=document.documentElement.scrollTop;scrOfX=document.documentElement.scrollLeft}
return[scrOfX,scrOfY]}
String.prototype.replaceAll=function(search,replace){return this.replace(new RegExp(search,'g'),replace)}
String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")}
parseTpl=function(tpl,vars){var res=tpl;for(var a in vars){if(vars.hasOwnProperty(a)){res=res.replaceAll("{"+a+"}",vars[a])}}
return res}
function loadCSS(filename){var fileref=document.createElement("link")
fileref.setAttribute("rel","stylesheet")
fileref.setAttribute("type","text/css")
fileref.setAttribute("href",filename+"?v="+src_version+"&"+Math.random());if(typeof fileref!="undefined")
document.getElementsByTagName("head")[0].appendChild(fileref)}
function unloadCSS(filename){var targetElement="link";var targetAttr="href";var allCtrl=document.getElementsByTagName(targetElement);for(var i=allCtrl.length;i>=0;i--){if(allCtrl[i]&&allCtrl[i].getAttribute(targetAttr)!=null&&allCtrl[i].getAttribute(targetAttr).indexOf(filename)!=-1)
allCtrl[i].parentNode.removeChild(allCtrl[i])}}
function loadJavascript(src){(function(){var newscript=document.createElement('script');newscript.type='text/javascript';newscript.async=!0;newscript.src=src;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(newscript)})()}
function setCookie(name,value,expires,path,domain,secure){path="/";var cookieString=name+"="+escape(value)+((expires)?"; expires="+expires:"")+((path)?"; path="+path:"")+((domain)?"; domain="+domain:"")+((secure)?"; secure":"");document.cookie=cookieString}
function getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}
return null}
function eraseCookie(name){setCookie(name,"",-1)}
var CS=CS||{};CS.define=function(ns,data){if(ns===undefined||ns===null||ns.length==0){throw new Error('Namespace is not defined')}
var idx=ns.indexOf('.');if(idx>-1){var subns=ns.substr(idx+1);ns=ns.substr(0,idx);if(!this.hasOwnProperty(ns)){this[ns]={}}
CS.define.apply(this[ns],[subns,data])}else{if(this.hasOwnProperty(ns)&&(typeof this[ns]=='object')&&(typeof data=='object')){for(var k in data){if(data.hasOwnProperty(k)){this[ns][k]=data[k]}}}else{this[ns]=data}}
return this};function leadZero(n){return n>9?n:"0"+n};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0)
from+=len;for(;from<len;from++){if(from in this&&this[from]===elt)
return from}
return-1}}
function touchHandler(event){var touches=event.changedTouches,first=touches[0],type="";switch(event.type){case "touchstart":type="mousedown";break;case "touchmove":type="mousemove";break;case "touchend":type="mouseup";break;default:return}
var simulatedEvent=new MouseEvent(type,{view:window,bubbles:!0,cancelable:!0,detail:1,screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});first.target.dispatchEvent(simulatedEvent);event.preventDefault()}
function initTouch(container){if(App&&App.isMobile){var cnt=null;if(container)cnt=$(container);$(".draggable",cnt).each(function(){this.addEventListener("touchstart",touchHandler,!0);this.addEventListener("touchmove",touchHandler,!0);this.addEventListener("touchend",touchHandler,!0);this.addEventListener("touchcancel",touchHandler,!0)})}}
if(!Object.keys){Object.keys=function(obj){var keys=[],k;for(k in obj){if(Object.prototype.hasOwnProperty.call(obj,k)){keys.push(k)}}
return keys}}
function applyBoardStyles(container,size,btype,ftype,hl_type){var loadedCss=container.data("loadedCss");if(!loadedCss)loadedCss={board:null,figures:null,size:null,hl_type:null};var basePath={board:css_url+"/boards/",figures:css_url+"/figures/",size:css_url+"/game/"};var changed=!1;if(size!=loadedCss.size){changed=!0;container.addClass("layout_"+size);container.removeClass("layout_"+loadedCss.size);loadedCss.size=size}
if(btype!=loadedCss.board){container.addClass("board_"+btype);container.removeClass("board_"+loadedCss.board);changed=!0;loadedCss.board=btype}
if(ftype!=loadedCss.figures){container.addClass("figures_"+ftype);container.removeClass("figures_"+loadedCss.figures);changed=!0;loadedCss.figures=ftype}
if(hl_type&&hl_type!=loadedCss.hl_type){container.addClass(hl_type);container.removeClass(loadedCss.hl_type);changed=!0;loadedCss.hl_type=hl_type}
container.data("loadedCss",loadedCss);container.addClass('layout-details');return changed}
var currentAjaxRequests=[];var networkStatus=null;$(function(){$(document).ajaxSend(function(event,xhr,ajaxOptions){currentAjaxRequests.push(ajaxOptions.url)});$(document).ajaxComplete(function(event,xhr,ajaxOptions){for(var i=0;i<currentAjaxRequests.length;i++){if(currentAjaxRequests[i]==ajaxOptions.url){currentAjaxRequests.splice(i,1);break}}})});var DEBUG_ENABLED=!1;function dbg(){if(DEBUG_ENABLED&&console&&console.log)console.log.apply(console,arguments)}
var DBG_LAST_TIMEPOINT=null;function dbg_tp(){if(DEBUG_ENABLED){var diff=DBG_LAST_TIMEPOINT?new Date().getTime()-DBG_LAST_TIMEPOINT:0;var params=[];params.push("["+diff+" ms]");for(var i=0;i<arguments.length;i++)params.push(arguments[i]);dbg.apply(this,params);DBG_LAST_TIMEPOINT=new Date().getTime()}}
function dbg_tp_reset(){DBG_LAST_TIMEPOINT=null}
function getWordForm(count,ed,mn,mnRod){var t=count%100;var tt=count%10;if((t>=5&&t<=20)||(tt==0)||(tt>=5&&tt<=9)){return mnRod}else if(t%10==1){return ed}else{return mn}}
var __loadedJsFiles=[];jQuery.cachedScript=function(urls,options){urls=typeof urls=='string'?[urls]:urls;var urlsToLoad=[];for(var i=0;i<urls.length;i++){if(__loadedJsFiles.indexOf(urls[i])==-1)urlsToLoad.push(urls[i])}
return jQuery.serialAjax(urlsToLoad,{dataType:'script',cache:!0})};jQuery.serialAjax=function(urls,options){urls=typeof urls=='string'?[urls]:urls;var df=$.Deferred();var loadNext=function(i){if(urls[i]){var opts=$.extend(options||{},{url:urls[i]});jQuery.ajax(opts).done(function(){loadNext(i+1)})}else{df.resolve()}};loadNext(0);return df.promise()};var App=App||{};App.activateTab=function(){var hash=location.hash;if(hash){var tab=$(".tab-pane"+hash),link=$('a[href="'+hash+'"]');if(tab.length>0&&link.length>0)link.click()}};App.safeApply=function($s,fn){var phase=$s.$root.$$phase;if(phase=='$apply'||phase=='$digest'){if(fn&&(typeof(fn)==='function'))fn()}else $s.$apply(fn)};if(!jQuery.support.cors&&window.XDomainRequest){var httpRegEx=/^https?:\/\//i;var getOrPostRegEx=/^get|post$/i;var sameSchemeRegEx=new RegExp('^'+location.protocol,'i');var xmlRegEx=/\/xml/i;jQuery.ajaxTransport('text html xml json',function(options,userOptions,jqXHR){if(options.crossDomain&&options.async&&getOrPostRegEx.test(options.type)&&httpRegEx.test(userOptions.url)&&sameSchemeRegEx.test(userOptions.url)){var xdr=null;var userType=(userOptions.dataType||'').toLowerCase();return{send:function(headers,complete){xdr=new XDomainRequest();if(/^\d+$/.test(userOptions.timeout)){xdr.timeout=userOptions.timeout}
xdr.ontimeout=function(){complete(500,'timeout')};xdr.onload=function(){var allResponseHeaders='Content-Length: '+xdr.responseText.length+'\r\nContent-Type: '+xdr.contentType;var status={code:200,message:'success'};var responses={text:xdr.responseText};try{if(userType==='json'){try{responses.json=JSON.parse(xdr.responseText)}catch(e){status.code=500;status.message='parseerror'}}else if((userType==='xml')||((userType!=='text')&&xmlRegEx.test(xdr.contentType))){var doc=new ActiveXObject('Microsoft.XMLDOM');doc.async=!1;try{doc.loadXML(xdr.responseText)}catch(e){doc=undefined}
if(!doc||!doc.documentElement||doc.getElementsByTagName('parsererror').length){status.code=500;status.message='parseerror';throw 'Invalid XML: '+xdr.responseText}
responses.xml=doc}}catch(parseMessage){throw parseMessage}finally{complete(status.code,status.message,responses,allResponseHeaders)}};xdr.onerror=function(){complete(500,'error',{text:xdr.responseText})};xdr.open(options.type,options.url);xdr.send()},abort:function(){if(xdr){xdr.abort()}}}}})};String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};(function(window){try{new MouseEvent('test');return!1}catch(e){}
var MouseEvent=function(eventType,params){params=params||{bubbles:!1,cancelable:!1};var mouseEvent=document.createEvent('MouseEvent');mouseEvent.initMouseEvent(eventType,params.bubbles,params.cancelable,window,1,params.screenX,params.screenY,params.clientX,params.clientY,!1,!1,!1,!1,0,null);return mouseEvent};MouseEvent.prototype=Event.prototype;window.MouseEvent=MouseEvent})(window);function getRightString(count,ed,mn,mnRod){var t=count%100;var tt=count%10;if(((t>=5)&&(t<=20))||(tt==0)||((tt>=5)&&(tt<=9))){return mnRod}else if(t%10==1){return ed}else{return mn}}
function scrollSpy(id,offsetTop,offsetBottom){var $el=$("#"+id);var $parent=$el.parent();var fixmeLeft=$parent.offset().left;var blockHeight=$el.height();var $win=$(window);var $doc=$(document);if(blockHeight>$parent.height())$parent.height(blockHeight);var handler=function(){var fixmeTop=$parent.offset().top;var currentScroll=$win.scrollTop();var scrollLeft=$win.scrollLeft();var docHeight=$doc.height();var blockHeight=$el.height();var scrollLimit=(docHeight-(blockHeight+offsetBottom));if(currentScroll>=scrollLimit){$el.css({position:'absolute',top:scrollLimit-fixmeTop+offsetTop,left:0})}else if(currentScroll>=(fixmeTop-offsetTop)){$el.css({position:'fixed',top:offsetTop,left:fixmeLeft-scrollLeft})}else{$el.css({position:'static'})}};$win.scroll(handler);$win.resize(function(){fixmeLeft=$parent.offset().left;handler()})}
App.countTimeLeft=function(){$(".time-left-count:not(.processed)").each(function(){var $this=$(this),el=this;var now=new Date().getTime();var onTimeEnd=$this.data('on-time-end');var initValue=$this.data('value'),perHour=60*60,perDay=24*perHour;var worker=function(){var value=Math.round(initValue-(new Date().getTime()-now)/1000),days=Math.floor(value/perDay),hours=Math.floor((value-days*perDay)/perHour),minutes=Math.floor((value-days*perDay-hours*perHour)/60),seconds=value%60;if(value>=0){if(days>0){if(hours<10)hours='0'+hours;if(minutes<10)minutes='0'+minutes;if(seconds<10)seconds='0'+seconds;var daysS=getRightString(days,"день","дня","дней");$this.html(days+' '+daysS+' '+hours+':'+minutes+':'+seconds)}else{if($this.data('words')){var hS=getRightString(hours,"час","часа","часов");var mS=getRightString(minutes,"минуту","минуты","минут");var sS=getRightString(seconds,"секунду","секунды","секунд");var s='';if(hours>0){s+=hours+' '+hS+' '}
if(minutes>0){s+=minutes+' '+mS+' и '}
s+=seconds+' '+sS;$this.html(s)}else{if(hours<10)hours='0'+hours;if(minutes<10)minutes='0'+minutes;if(seconds<10)seconds='0'+seconds;$this.html(hours+':'+minutes+':'+seconds)}}}else{if(onTimeEnd){var handler=function(){eval(onTimeEnd)};handler.call(el)}
clearInterval(inter)}};var inter=setInterval(worker,1000);worker();$this.addClass('processed')})};App.confirm=function(text,onDone,options){var $overlay=$("#app-overlay"),$body=$("body"),$confirmWin=$("#app-confirm"),yesText=_i('Да'),cancelText=_i('Отмена');if($overlay.length===0){$overlay=$('<div class="overlay hide" id="app-overlay"></div>');$body.append($overlay)}
if($confirmWin.length===0){$confirmWin=$('<div class="app-confirm hide dialogWithDropShadow" id="app-confirm"><div class="text"></div><div class="buttons"><a href="#" class="btn-confirm-yes btn btn-success">'+yesText+'</a><a href="#" class="btn-confirm-cancel btn">'+cancelText+'</a></div></div>');$body.append($confirmWin)}
var onYesHandler=function(e){onDone();removeHandlers();hideWindow();e.preventDefault();return!1};var onCancelHandler=function(e){removeHandlers();hideWindow();e.preventDefault();return!1};var hideWindow=function(){$overlay.fadeOut('fast');$confirmWin.fadeOut('fast')};var removeHandlers=function(){$confirmWin.find('.btn-confirm-yes').unbind('click',onYesHandler);$confirmWin.find('.btn-confirm-cancel').unbind('click',onCancelHandler)};$confirmWin.find(".text").html(text);$confirmWin.find('.btn-confirm-yes').on("click",onYesHandler);$confirmWin.find('.btn-confirm-cancel').on("click",onCancelHandler);$overlay.fadeIn('fast');$confirmWin.fadeIn('fast')};var JSON;if(!JSON){JSON={}}(function(){'use strict';function f(n){return n<10?'0'+n:n}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key)}
if(typeof rep==='function'){value=rep.call(holder,key,value)}
switch(typeof value){case 'string':return quote(value);case 'number':return isFinite(value)?String(value):'null';case 'boolean':case 'null':return String(value);case 'object':if(!value){return'null'}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' '}}else if(typeof space==='string'){indent=space}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify')}
return str('',{'':value})}}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}
return reviver.call(holder,key,value)}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j}
throw new SyntaxError('JSON.parse')}}}());(function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(){this.translate=r(this.translate,this);this.data={values:{},contexts:[]};this.globalContext={}}e.prototype.translate=function(e,t,n,r,i){var s,o,u,a;if(i==null){i=this.globalContext}u=function(e){var t;t=typeof e;return t==="function"||t==="object"&&!!e};if(u(t)){s=null;a=null;o=t;i=n||this.globalContext}else{if(typeof t==="number"){s=null;a=t;o=n;i=r||this.globalContext}else{s=t;if(typeof n==="number"){a=n;o=r;i=i}else{a=null;o=n;i=r||this.globalContext}}}if(u(e)){if(u(e.i18n)){e=e.i18n}return this.translateHash(e,i)}else{return this.translateText(e,a,o,i,s)}};e.prototype.add=function(e){var t,n,r,i,s,o,u,a;if(e.values!=null){o=e.values;for(n in o){r=o[n];this.data.values[n]=r}}if(e.contexts!=null){u=e.contexts;a=[];for(i=0,s=u.length;i<s;i++){t=u[i];a.push(this.data.contexts.push(t))}return a}};e.prototype.setContext=function(e,t){return this.globalContext[e]=t};e.prototype.clearContext=function(e){return this.lobalContext[e]=null};e.prototype.reset=function(){this.data={values:{},contexts:[]};return this.globalContext={}};e.prototype.resetData=function(){return this.data={values:{},contexts:[]}};e.prototype.resetContext=function(){return this.globalContext={}};e.prototype.translateHash=function(e,t){var n,r;for(n in e){r=e[n];if(typeof r==="string"){e[n]=this.translateText(r,null,null,t)}}return e};e.prototype.translateText=function(e,t,n,r,i){var s,o;if(r==null){r=this.globalContext}if(this.data==null){return this.useOriginalText(i||e,t,n)}s=this.getContextData(this.data,r);if(s!=null){o=this.findTranslation(e,t,n,s.values,i)}if(o==null){o=this.findTranslation(e,t,n,this.data.values,i)}if(o==null){return this.useOriginalText(i||e,t,n)}return o};e.prototype.findTranslation=function(e,t,n,r){var i,s,o,u,a;o=r[e];if(o==null){return null}if(t==null){if(typeof o==="string"){return this.applyFormatting(o,t,n)}}else{if(o instanceof Array||o.length){for(u=0,a=o.length;u<a;u++){s=o[u];if((t>=s[0]||s[0]===null)&&(t<=s[1]||s[1]===null)){i=this.applyFormatting(s[2].replace("-%n",String(-t)),t,n);return this.applyFormatting(i.replace("%n",String(t)),t,n)}}}}return null};e.prototype.getContextData=function(e,t){var n,r,i,s,o,u,a,f;if(e.contexts==null){return null}a=e.contexts;for(o=0,u=a.length;o<u;o++){n=a[o];r=!0;f=n.matches;for(i in f){s=f[i];r=r&&s===t[i]}if(r){return n}}return null};e.prototype.useOriginalText=function(e,t,n){if(t==null){return this.applyFormatting(e,t,n)}return this.applyFormatting(e.replace("%n",String(t)),t,n)};e.prototype.applyFormatting=function(e,t,n){var r,i;for(r in n){i=new RegExp("%{"+r+"}","g");e=e.replace(i,n[r])}return e};return e}();n=new e;t=n.translate;t.translator=n;t.create=function(n){var r;r=new e;if(n!=null){r.add(n)}r.translate.create=t.create;return r.translate};(typeof module!=="undefined"&&module!==null?module.exports=t:void 0)||(this.i18n=t)}).call(this)
window._i=i18n;var App=App||{};App.limitsLang={1:'1м/ход',2:'3м/ход',3:'5м/ход',4:'10м/ход',5:'1д/ход',6:'3д/ход',7:'5д/ход',8:'7д/ход',9:'30м/ход',10:'5м/игра +10с/ход',11:'15м/игра +30с/ход',12:'30м/игра +1м/ход',13:'45м/игра +3м/ход',14:'3д/игра +2ч/ход',15:'7д/игра +6ч/ход',16:'1ч/игра +5м/ход',17:'10м/игра +20с/ход',18:'2м/игра +5с/ход',19:'4м/игра +1с/ход',20:'1ч/игра +3с/ход',22:'15д/игра +5с/ход',23:'2д/ход',24:'3м/игра +3с/ход',25:'45д/игра +5с/ход',26:'1,5ч/игра +0с/ход',27:'1м/игра +15с/ход',28:'6м/игра +1с/ход',29:'5м/игра +0с/ход',30:'1м/игра +3с/ход',31:'3м/игра +1с/ход',32:'1м/игра +1с/ход',33:'2м/игра +1с/ход',34:'3м/игра +0с/ход',35:'10м/игра +0с/ход',36:'15м/игра +0с/ход',37:'20м/игра +0с/ход',38:'4м/игра +0с/ход',39:'5м/игра +1с/ход',40:'6м/игра +0с/ход'};var CS=CS||{};CS.Notify=CS.Notify||{};CS.define("Notify",{show:function(head,msg,config){if(getCookie("instant_notices_disabled")!="1"){config=config||{};var defConfig={closerTemplate:'<div> [ '+_i('Закрыть все')+' ] </div>',life:30000,header:head};return StickyNotes.show(msg,$.extend(defConfig,config))}},userLink:function(login){return'<a class="user-link" data-login="'+login+'" href="'+App.urlTo('/users/'+login,null,!1)+'">'+login+'</a>'},showImportant:function(head,msg,config){config=config||{};var defConfig={life:30000,header:head,important:!0};return StickyNotes.show(msg,$.extend(defConfig,config))},actcreated:function(data){var chess960=data.chess960?' '+_i('Шахматы Фишера'):'';var no_rating=data.no_rating?" "+_i("без учета рейтинга"):'';var advance=data.advance?' '+_i('Адванс'):'';var limit=App.limitsLang?App.limitsLang[data.limit_id]:data.limit;CS.Notify.show(_i("Приглашение на игру"),''+data.user+' '+(data.return_match?_i('предлагает <strong>реванш</strong>'):_i('приглашает Вас сыграть с ним'))+'. <br />'+(no_rating?_i('Игра')+no_rating+'. <br />':'')+(chess960||advance?_i('Тип игры')+' '+advance+chess960+'. <br />':'')+_i('Ваш цвет')+' - '+_i(data.color)+', '+_i('контроль')+' - '+limit+''+'<br /> '+'<div class="hmargin-small"><span class="btn-group"><a href="'+data.confirm_url+'" class="btn btn-mini btn-success">'+_i('Принять вызов')+'</a>'+'<a href="'+data.reject_url+'" class="btn btn-mini">'+_i('Отказаться от игры')+'</a></span></div> <div class="clearfix"></div>')},gamestart:function(data){var info=data.notification;var user=cs_user.id==info.p1?info.p2_link:info.p1_link;var color=cs_user.id==info.p1?_i('белый'):_i('чёрный');var t=info.tournament_id>0;var name=info.battle_position_id>0?_i('схватка'):_i('игра');var s=_i('Началась %{what} с пользователем %{opponent}. Ваш цвет - %{color}, контроль - %{limit}.',{what:(t>0?_i('турнирная партия'):_i('Ваша %{what}',{what:name})),opponent:user,color:color,limit:App.limitsLang[info.limit_id]}).capitalizeFirstLetter();s+='<br /><a class="btn btn-mini" href="'+info.game_url+'">'+_i('Перейти в партию')+'</a>';App.playSoundOnce("gamestart");if(!CS.Game||data.gameid!=CS.Game.id){CS.Notify.show(_i("Началась %{what}",{what:name}).capitalizeFirstLetter(),s,{id:'g'+data.gameid})}},gamestep:function(data){var info=data.notification;if(info){var msg="",opts={};var limit=App.limitsLang?App.limitsLang[info.limit_id]:info.limit;if(!CS.Game||data.gameid!=CS.Game.id){var login=info.opp_login?CS.Notify.userLink(info.opp_login):info.opponent;msg=_i('В партии №%{gameid} с %{opponent} наступил Ваш ход.',{gameid:info.id,opponent:login})+'<br />'+_i('Ваш цвет')+' - '+_i(info.color)+', '+_i('контроль')+' - '+limit+'<br /><a class="btn btn-mini" href="'+info.game_url+'">'+_i('Перейти в партию')+'</a>';CS.Notify.show(_i("Ваш ход"),msg,opts)}}},counters:function(data){var map={"game_turns_count":"my-games-menu-item","new_messages_count":"my-messages-menu-item"};if(data.counter){if(CS.Game&&CS.Game.id&&data.gameId&&CS.Game.id==data.gameId){if(CS.Game.turnOnLoad&&data.d<0){CS.Game.turnOnLoad=!1}else{return}}
var cls=map[data.counter];var el=$("."+cls).find("span.label");var d=parseInt(data.d);var cnt=parseInt(el.html())+d;if(data.counter=='new_messages_count'&&cnt>parseInt(el.html())){App.playSoundOnce("msg")}
el.html(cnt);App.updateCounters();if(cnt>0&&d>0){CS.Notify.blinkLabel(el)}}},battlecreated:function(data){var s=_i('Игрок %{user} %{action}',{user:data.user,action:(data.return_match?_i('предлагает <strong>реванш</strong> в схавтку'):_i('приглашает Вас сыграть с ним в схватку'))});CS.Notify.show(_i("Приглашение на схватку"),s+'. <br />'+'<br /> '+'<div class="hmargin-small"><a href="'+data.info_url+'" class="btn btn-mini ">'+_i('Посмотреть детали схватки')+'</a>'+'</div> <div class="clearfix"></div>')},pchallenge:function(data){var show=!0;if(typeof CS!='undefined'&&CS.ProblemChallenge&&CS.ProblemChallenge.id==data.id){show=!1}
if(show){var s=_i('Начался <a href="%{url}">турнир по решение шахматных задач</a> с Вашим участием!',{url:data.challenge_url});CS.Notify.show(_i("Турнир по решению задач"),s+' <br />'+'<div class="hmargin-small"><a href="'+data.challenge_url+'" class="btn btn-mini ">'+_i('Перейти в турнир')+'</a>'+'</div> <div class="clearfix"></div>')}},blinkLabel:function(el){var k=7;var timer=setInterval(function(){el.toggleClass("label-success");el.toggleClass("label-important");k--;if(k==0){clearInterval(timer);el.removeClass("label-important");el.addClass("label-success")}},150)},quest_partially_done:function(data){CS.Notify.show(data.title,_i("Выполнено: ")+data.done_count+" / "+data.expected_count)},quest_done:function(data){CS.Notify.show(_i('Задание выполнено!'),'<div class="hmargin"><strong>'+data.title+"</strong></div>"+'<div class="hmargin-top">'+_i("Вы получили <i class='fas fa-star'></i> <strong>%{score}</strong>",{score:data.score})+' </div>')},new_quest:function(data){CS.Notify.show(_i('Новое задание'),'<div class="hmargin"><strong>'+data.title+'</strong></div>'+'<div class="hmargin">'+_i('Очков за выполнение:')+' <i class="fas fa-star"></i> <strong>'+data.score+'</strong></div>'+'<div class="hmargin-top"><a href="'+data.url+'" class="btn btn-mini">'+_i('Посмотреть детали')+'</a></div>')},current_quests_count:function(data){var $el=$("#current_quests_count");$el.html(data.value);$el.toggleClass('hide',data.value==0);if(data.value>0)CS.Notify.blinkLabel($el)},quest_competition_finished:function(data){if(data.isRandom){CS.Notify.show(_i('Соревнование завершено!'),'<div class="hmargin">'+_i('В прошедшем соревновании по выполнению ежедневных заданий Вы стали одним из нескольких случайно выбранных призеров.')+'</div>'+'<div class="hmargin-top"><a class="btn btn-mini" href="'+data.url+'">'+_i('Получить приз')+'</a></div>')}else{CS.Notify.show(_i('Соревнование завершено!'),'<div class="hmargin">'+_i('Вы заняли %{place} место.',{place:data.place})+'</div>'+'<div class="hmargin-top"><a class="btn btn-mini" href="'+data.url+'">'+_i('Получить приз')+'</a></div>')}}});App=App||{};App.updateCounters=function(){var sum=0;$(".menu-counter").each(function(){sum+=parseInt($(this).html())});$(".counters-sum span.label").html(sum);$(".my-games-menu-item, .my-messages-menu-item, .counters-sum").each(function(){var label=$(this).find(".label");label.toggleClass("hide",label.html()=="0")})};$(function(){App.updateCounters();var allowGuests=['pchallenge'];pushClient.subscribe(uChannel,function(data){if(data.actionType&&CS.Notify.hasOwnProperty(data.actionType)){if(cs_user.id!='0'||CS.Game||allowGuests.indexOf(data.actionType)>=0){CS.Notify[data.actionType](data)}}})});Date.formats={simple:"D MMM YYYY, HH:mm",simpleWithoutYear:"D MMM, HH:mm",date:"D MMM YYYY",fullDate:"D MMMM YYYY",fullDateTime:"D MMMM YYYY HH:mm",time:'HH:mm',db:'YYYY-MM-DD HH:mm:ss'};Date.prototype.format=function(format){var returnStr='';var replace=Date.replaceChars;for(var i=0;i<format.length;i++){var curChar=format.charAt(i);if(i-1>=0&&format.charAt(i-1)=="\\"){returnStr+=curChar}else if(replace[curChar]){returnStr+=replace[curChar].call(this)}else if(curChar!="\\"){returnStr+=curChar}}
return returnStr};if(!App.dateStrings||!App.dateStrings.current){App.dateStrings=App.dateStrings||{};App.dateStrings.current={shortMonths:['Янв','Фев','Мар','Апр','Май','Июн','Июл','Авг','Сен','Окт','Ноя','Дек'],longMonths:['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'],shortDays:['Вс','Пн','Вт','Ср','Чт','Пт','Сб'],longDays:['Воскресение','Понедельник','Вторник','Среда','Четверг','Пятница','Суббота']}}
Date.replaceChars={shortMonths:App.dateStrings.current.shortMonths,longMonths:App.dateStrings.current.longMonths,shortDays:App.dateStrings.current.shortDays,longDays:App.dateStrings.current.longDays,d:function(){return(this.getDate()<10?'0':'')+this.getDate()},D:function(){return Date.replaceChars.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.replaceChars.longDays[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return(this.getDate()%10==1&&this.getDate()!=11?'st':(this.getDate()%10==2&&this.getDate()!=12?'nd':(this.getDate()%10==3&&this.getDate()!=13?'rd':'th')))},w:function(){return this.getDay()},z:function(){var d=new Date(this.getFullYear(),0,1);return Math.ceil((this-d)/86400000)},W:function(){var d=new Date(this.getFullYear(),0,1);return Math.ceil((((this-d)/86400000)+d.getDay()+1)/7)},F:function(){return Date.replaceChars.longMonths[this.getMonth()]},m:function(){return(this.getMonth()<9?'0':'')+(this.getMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){var d=new Date();return new Date(d.getFullYear(),d.getMonth(),0).getDate()},L:function(){var year=this.getFullYear();return(year%400==0||(year%100!=0&&year%4==0))},o:function(){var d=new Date(this.valueOf());d.setDate(d.getDate()-((this.getDay()+6)%7)+3);return d.getFullYear()},Y:function(){return this.getFullYear()},y:function(){return(''+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?'am':'pm'},A:function(){return this.getHours()<12?'AM':'PM'},B:function(){return Math.floor((((this.getUTCHours()+1)%24)+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)*1000/24)},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?'0':'')+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?'0':'')+this.getHours()},i:function(){return(this.getMinutes()<10?'0':'')+this.getMinutes()},s:function(){return(this.getSeconds()<10?'0':'')+this.getSeconds()},u:function(){var m=this.getMilliseconds();return(m<10?'00':(m<100?'0':''))+m},e:function(){return"Not Yet Supported"},I:function(){return"Not Yet Supported"},O:function(){return(-this.getTimezoneOffset()<0?'-':'+')+(Math.abs(this.getTimezoneOffset()/60)<10?'0':'')+(Math.abs(this.getTimezoneOffset()/60))+'00'},P:function(){return(-this.getTimezoneOffset()<0?'-':'+')+(Math.abs(this.getTimezoneOffset()/60)<10?'0':'')+(Math.abs(this.getTimezoneOffset()/60))+':00'},T:function(){var m=this.getMonth();this.setMonth(0);var result=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,'$1');this.setMonth(m);return result},Z:function(){return-this.getTimezoneOffset()*60},c:function(){return this.format("Y-m-d\\TH:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1000}};var App=App||{};App.styleDates=function(container){return $(".date",container).each(function(){var $this=$(this);var format=$this.data("format");var val=$this.html();var originalDate=$this.data("original-date");if(originalDate)val=originalDate;$this.attr("original-date",val);var notLocal=!1;if(cs_user&&cs_user.timezone&&!$this.hasClass('not-local')){$this.addClass('local-date');if(!App.CHESS_COOL)$this.attr("title",'Местное время ('+cs_user.timezoneTitle+')')}else{if(!App.CHESS_COOL)$this.attr("title",'Время сервера ('+serverTimeZone+')');notLocal=!0}
var res=App.formatDate(val,format,notLocal);$this.html(res)})};App.localDateEnabled=function(){return(cs_user&&cs_user.timezone)};App.checkUserTimezone=function(){if(cs_user.timezone){try{moment.tz(cs_user.timezone)}catch(e){cs_user.timezone=null}}};App.formatDate=function(val,format,notLocal){var res=val;val=val.trim();if(val.match(/^\d+?[\.-]\d+?[\.-]\d+?\s\d+?:\d+?:?(\d+)?$/)){var ar=val.split(" ");if(ar.length>1){var dt=ar[0].split(/\.|-/);var tm=ar[1].split(":");if(parseInt(dt[0])>31){dt.reverse()}
var date=new Date(dt[2],dt[1]-1,dt[0],tm[0],tm[1],tm[2]?tm[2]:null);var dateString=dt[2]+'-'+dt[1]+'-'+dt[0]+' '+tm[0]+':'+tm[1]+(tm[2]?':'+tm[2]:'');date=moment.tz(dateString,serverTimeZone);if(cs_user&&cs_user.timezone&&!notLocal){date=date.tz(cs_user.timezone)}
var today=new Date();res="";if(format=='plain'){return date}else if(format){res=date.format(Date.formats[format])}else{if(today.getFullYear()==date.year()){res=date.format(Date.formats.simpleWithoutYear)}else{res=date.format(Date.formats.simple)}}}}
return res};App.localDateToServerZone=function(date,format){var dt=moment.tz(date,cs_user.timezone);return dt.tz(serverTimeZone).format(format||Date.formats.db)};String.prototype.toHHMMSS=function(){var sec_numb=parseInt(this,10);var hours=Math.floor(sec_numb/3600);var minutes=Math.floor((sec_numb-(hours*3600))/60);var seconds=sec_numb-(hours*3600)-(minutes*60);if(hours<10){hours="0"+hours}
if(minutes<10){minutes="0"+minutes}
if(seconds<10){seconds="0"+seconds}
var time=hours+':'+minutes+':'+seconds;return time};App.onSetTimezone=function(timezone){cs_user.timezone=timezone;App.checkUserTimezone();App.styleDates()};App.onloadHandlers.push(function(){moment.locale('ru');App.checkUserTimezone();App.styleDates()});/*! howler.js v2.0.4 | (c) 2013-2017, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var o=this||n;if(e=parseFloat(e),o.ctx||_(),void 0!==e&&e>=0&&e<=1){if(o._volume=e,o._muted)return o;o.usingWebAudio&&(o.masterGain.gain.value=e);for(var t=0;t<o._howls.length;t++)if(!o._howls[t]._webAudio)for(var r=o._howls[t]._getSoundIds(),a=0;a<r.length;a++){var u=o._howls[t]._soundById(r[a]);u&&u._node&&(u._node.volume=u._volume*e)}return o}return o._volume},mute:function(e){var o=this||n;o.ctx||_(),o._muted=e,o.usingWebAudio&&(o.masterGain.gain.value=e?0:o._volume);for(var t=0;t<o._howls.length;t++)if(!o._howls[t]._webAudio)for(var r=o._howls[t]._getSoundIds(),a=0;a<r.length;a++){var u=o._howls[t]._soundById(r[a]);u&&u._node&&(u._node.muted=!!e||u._muted)}return o},unload:function(){for(var e=this||n,o=e._howls.length-1;o>=0;o--)e._howls[o].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var o=new Audio;void 0===o.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{var o=new Audio;o.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,o=null;try{o="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!o||"function"!=typeof o.canPlayType)return e;var t=o.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!t&&!o.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!t,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!o.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||n,o=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),t=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(o||t)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){n._autoResume();var o=e.ctx.createBufferSource();o.buffer=e._scratchBuffer,o.connect(e.ctx.destination),void 0===o.start?o.noteOn(0):o.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),o.onended=function(){o.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var o=0;o<e._howls.length;o++)if(e._howls[o]._webAudio)for(var t=0;t<e._howls[o]._sounds.length;t++)if(!e._howls[o]._sounds[t]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,o=function(e){var n=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");n.init(e)};o.prototype={init:function(e){var o=this;return n.ctx||_(),o._autoplay=e.autoplay||!1,o._format="string"!=typeof e.format?e.format:[e.format],o._html5=e.html5||!1,o._muted=e.mute||!1,o._loop=e.loop||!1,o._pool=e.pool||5,o._preload="boolean"!=typeof e.preload||e.preload,o._rate=e.rate||1,o._sprite=e.sprite||{},o._src="string"!=typeof e.src?e.src:[e.src],o._volume=void 0!==e.volume?e.volume:1,o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._onend=e.onend?[{fn:e.onend}]:[],o._onfade=e.onfade?[{fn:e.onfade}]:[],o._onload=e.onload?[{fn:e.onload}]:[],o._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],o._onpause=e.onpause?[{fn:e.onpause}]:[],o._onplay=e.onplay?[{fn:e.onplay}]:[],o._onstop=e.onstop?[{fn:e.onstop}]:[],o._onmute=e.onmute?[{fn:e.onmute}]:[],o._onvolume=e.onvolume?[{fn:e.onvolume}]:[],o._onrate=e.onrate?[{fn:e.onrate}]:[],o._onseek=e.onseek?[{fn:e.onseek}]:[],o._onresume=[],o._webAudio=n.usingWebAudio&&!o._html5,void 0!==n.ctx&&n.ctx&&n.mobileAutoEnable&&n._enableMobileAudio(),n._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o.load(),o},load:function(){var e=this,o=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var u,i;if(e._format&&e._format[r])u=e._format[r];else{if("string"!=typeof(i=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(i),u||(u=/\.([^.]+)$/.exec(i.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&n.codecs(u)){o=e._src[r];break}}return o?(e._src=o,e._state="loading","https:"===window.location.protocol&&"http:"===o.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new t(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,o){var t=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===t._state&&!t._sprite[e])return null;if(void 0===e){e="__default";for(var a=0,u=0;u<t._sounds.length;u++)t._sounds[u]._paused&&!t._sounds[u]._ended&&(a++,r=t._sounds[u]._id);1===a?e=null:r=null}}var i=r?t._soundById(r):t._inactiveSound();if(!i)return null;if(r&&!e&&(e=i._sprite||"__default"),"loaded"!==t._state){i._sprite=e,i._ended=!1;var d=i._id;return t._queue.push({event:"play",action:function(){t.play(d)}}),d}if(r&&!i._paused)return o||setTimeout(function(){t._emit("play",i._id)},0),i._id;t._webAudio&&n._autoResume();var _=Math.max(0,i._seek>0?i._seek:t._sprite[e][0]/1e3),s=Math.max(0,(t._sprite[e][0]+t._sprite[e][1])/1e3-_),l=1e3*s/Math.abs(i._rate);i._paused=!1,i._ended=!1,i._sprite=e,i._seek=_,i._start=t._sprite[e][0]/1e3,i._stop=(t._sprite[e][0]+t._sprite[e][1])/1e3,i._loop=!(!i._loop&&!t._sprite[e][2]);var c=i._node;if(t._webAudio){var f=function(){t._refreshBuffer(i);var e=i._muted||t._muted?0:i._volume;c.gain.setValueAtTime(e,n.ctx.currentTime),i._playStart=n.ctx.currentTime,void 0===c.bufferSource.start?i._loop?c.bufferSource.noteGrainOn(0,_,86400):c.bufferSource.noteGrainOn(0,_,s):i._loop?c.bufferSource.start(0,_,86400):c.bufferSource.start(0,_,s),l!==1/0&&(t._endTimers[i._id]=setTimeout(t._ended.bind(t,i),l)),o||setTimeout(function(){t._emit("play",i._id)},0)},p="running"===n.state;if("loaded"===t._state&&p)f();else{var v=p||"loaded"!==t._state?"load":"resume";t.once(v,f,p?i._id:null),t._clearTimer(i._id)}}else{var m=function(){c.currentTime=_,c.muted=i._muted||t._muted||n._muted||c.muted,c.volume=i._volume*n.volume(),c.playbackRate=i._rate,c.play(),l!==1/0&&(t._endTimers[i._id]=setTimeout(t._ended.bind(t,i),l)),o||t._emit("play",i._id)},h="loaded"===t._state&&(window&&window.ejecta||!c.readyState&&n._navigator.isCocoonJS);if(4===c.readyState||h)m();else{var g=function(){m(),c.removeEventListener(n._canPlayEvent,g,!1)};c.addEventListener(n._canPlayEvent,g,!1),t._clearTimer(i._id)}}return i._id},pause:function(e){var n=this;if("loaded"!==n._state)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var o=n._getSoundIds(e),t=0;t<o.length;t++){n._clearTimer(o[t]);var r=n._soundById(o[t]);if(r&&!r._paused&&(r._seek=n.seek(o[t]),r._rateSeek=0,r._paused=!0,n._stopFade(o[t]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var o=this;if("loaded"!==o._state)return o._queue.push({event:"stop",action:function(){o.stop(e)}}),o;for(var t=o._getSoundIds(e),r=0;r<t.length;r++){o._clearTimer(t[r]);var a=o._soundById(t[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,o._stopFade(t[r]),a._node&&(o._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),o._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause())),n||o._emit("stop",a._id))}return o},mute:function(e,o){var t=this;if("loaded"!==t._state)return t._queue.push({event:"mute",action:function(){t.mute(e,o)}}),t;if(void 0===o){if("boolean"!=typeof e)return t._muted;t._muted=e}for(var r=t._getSoundIds(o),a=0;a<r.length;a++){var u=t._soundById(r[a]);u&&(u._muted=e,t._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,n.ctx.currentTime):u._node&&(u._node.muted=!!n._muted||e),t._emit("mute",u._id))}return t},volume:function(){var e,o,t=this,r=arguments;if(0===r.length)return t._volume;if(1===r.length||2===r.length&&void 0===r[1]){t._getSoundIds().indexOf(r[0])>=0?o=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),o=parseInt(r[1],10));var a;if(!(void 0!==e&&e>=0&&e<=1))return a=o?t._soundById(o):t._sounds[0],a?a._volume:0;if("loaded"!==t._state)return t._queue.push({event:"volume",action:function(){t.volume.apply(t,r)}}),t;void 0===o&&(t._volume=e),o=t._getSoundIds(o);for(var u=0;u<o.length;u++)(a=t._soundById(o[u]))&&(a._volume=e,r[2]||t._stopFade(o[u]),t._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*n.volume()),t._emit("volume",a._id));return t},fade:function(e,o,t,r){var a=this,u=Math.abs(e-o),i=e>o?"out":"in",d=u/.01,_=d>0?t/d:t;if(_<4&&(d=Math.ceil(d/(4/_)),_=4),"loaded"!==a._state)return a._queue.push({event:"fade",action:function(){a.fade(e,o,t,r)}}),a;a.volume(e,r);for(var s=a._getSoundIds(r),l=0;l<s.length;l++){var c=a._soundById(s[l]);if(c){if(r||a._stopFade(s[l]),a._webAudio&&!c._muted){var f=n.ctx.currentTime,p=f+t/1e3;c._volume=e,c._node.gain.setValueAtTime(e,f),c._node.gain.linearRampToValueAtTime(o,p)}var v=e;c._interval=setInterval(function(n,t){d>0&&(v+="in"===i?.01:-.01),v=Math.max(0,v),v=Math.min(1,v),v=Math.round(100*v)/100,a._webAudio?(void 0===r&&(a._volume=v),t._volume=v):a.volume(v,n,!0),(o<e&&v<=o||o>e&&v>=o)&&(clearInterval(t._interval),t._interval=null,a.volume(o,n),a._emit("fade",n))}.bind(a,s[l],c),_)}}return a},_stopFade:function(e){var o=this,t=o._soundById(e);return t&&t._interval&&(o._webAudio&&t._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(t._interval),t._interval=null,o._emit("fade",e)),o},loop:function(){var e,n,o,t=this,r=arguments;if(0===r.length)return t._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(o=t._soundById(parseInt(r[0],10)))&&o._loop;e=r[0],t._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=t._getSoundIds(n),u=0;u<a.length;u++)(o=t._soundById(a[u]))&&(o._loop=e,t._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=e,e&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop)));return t},rate:function(){var e,o,t=this,r=arguments;if(0===r.length)o=t._sounds[0]._id;else if(1===r.length){var a=t._getSoundIds(),u=a.indexOf(r[0]);u>=0?o=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));var i;if("number"!=typeof e)return i=t._soundById(o),i?i._rate:t._rate;if("loaded"!==t._state)return t._queue.push({event:"rate",action:function(){t.rate.apply(t,r)}}),t;void 0===o&&(t._rate=e),o=t._getSoundIds(o);for(var d=0;d<o.length;d++)if(i=t._soundById(o[d])){i._rateSeek=t.seek(o[d]),i._playStart=t._webAudio?n.ctx.currentTime:i._playStart,i._rate=e,t._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.value=e:i._node&&(i._node.playbackRate=e);var _=t.seek(o[d]),s=(t._sprite[i._sprite][0]+t._sprite[i._sprite][1])/1e3-_,l=1e3*s/Math.abs(i._rate);!t._endTimers[o[d]]&&i._paused||(t._clearTimer(o[d]),t._endTimers[o[d]]=setTimeout(t._ended.bind(t,i),l)),t._emit("rate",i._id)}return t},seek:function(){var e,o,t=this,r=arguments;if(0===r.length)o=t._sounds[0]._id;else if(1===r.length){var a=t._getSoundIds(),u=a.indexOf(r[0]);u>=0?o=parseInt(r[0],10):(o=t._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));if(void 0===o)return t;if("loaded"!==t._state)return t._queue.push({event:"seek",action:function(){t.seek.apply(t,r)}}),t;var i=t._soundById(o);if(i){if(!("number"==typeof e&&e>=0)){if(t._webAudio){var d=t.playing(o)?n.ctx.currentTime-i._playStart:0,_=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(_+d*Math.abs(i._rate))}return i._node.currentTime}var s=t.playing(o);s&&t.pause(o,!0),i._seek=e,i._ended=!1,t._clearTimer(o),s&&t.play(o,!0),!t._webAudio&&i._node&&(i._node.currentTime=e),t._emit("seek",o)}return t},playing:function(e){var n=this;if("number"==typeof e){var o=n._soundById(e);return!!o&&!o._paused}for(var t=0;t<n._sounds.length;t++)if(!n._sounds[t]._paused)return!0;return!1},duration:function(e){var n=this,o=n._duration,t=n._soundById(e);return t&&(o=n._sprite[t._sprite][1]/1e3),o},state:function(){return this._state},unload:function(){for(var e=this,o=e._sounds,t=0;t<o.length;t++){if(o[t]._paused||e.stop(o[t]._id),!e._webAudio){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(o[t]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),o[t]._node.removeEventListener("error",o[t]._errorFn,!1),o[t]._node.removeEventListener(n._canPlayEvent,o[t]._loadFn,!1)}delete o[t]._node,e._clearTimer(o[t]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1)}var u=!0;for(t=0;t<n._howls.length;t++)if(n._howls[t]._src===e._src){u=!1;break}return r&&u&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,o,t){var r=this,a=r["_on"+e];return"function"==typeof n&&a.push(t?{id:o,fn:n,once:t}:{id:o,fn:n}),r},off:function(e,n,o){var t=this,r=t["_on"+e],a=0;if("number"==typeof n&&(o=n,n=null),n||o)for(a=0;a<r.length;a++){var u=o===r[a].id;if(n===r[a].fn&&u||!n&&u){r.splice(a,1);break}}else if(e)t["_on"+e]=[];else{var i=Object.keys(t);for(a=0;a<i.length;a++)0===i[a].indexOf("_on")&&Array.isArray(t[i[a]])&&(t[i[a]]=[])}return t},once:function(e,n,o){var t=this;return t.on(e,n,o,1),t},_emit:function(e,n,o){for(var t=this,r=t["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,o)}.bind(t,r[a].fn),0),r[a].once&&t.off(e,r[a].fn,r[a].id));return t},_loadQueue:function(){var e=this;if(e._queue.length>0){var n=e._queue[0];e.once(n.event,function(){e._queue.shift(),e._loadQueue()}),n.action()}return e},_ended:function(e){var o=this,t=e._sprite;if(!o._webAudio&&o._node&&!o._node.ended)return setTimeout(o._ended.bind(o,e),100),o;var r=!(!e._loop&&!o._sprite[t][2]);if(o._emit("end",e._id),!o._webAudio&&r&&o.stop(e._id,!0).play(e._id),o._webAudio&&r){o._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);o._endTimers[e._id]=setTimeout(o._ended.bind(o,e),a)}return o._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,o._clearTimer(e._id),o._cleanBuffer(e._node),n._autoSuspend()),o._webAudio||r||o.stop(e._id),o},_clearTimer:function(e){var n=this;return n._endTimers[e]&&(clearTimeout(n._endTimers[e]),delete n._endTimers[e]),n},_soundById:function(e){for(var n=this,o=0;o<n._sounds.length;o++)if(e===n._sounds[o]._id)return n._sounds[o];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new t(e)},_drain:function(){var e=this,n=e._pool,o=0,t=0;if(!(e._sounds.length<n)){for(t=0;t<e._sounds.length;t++)e._sounds[t]._ended&&o++;for(t=e._sounds.length-1;t>=0;t--){if(o<=n)return;e._sounds[t]._ended&&(e._webAudio&&e._sounds[t]._node&&e._sounds[t]._node.disconnect(0),e._sounds.splice(t,1),o--)}}},_getSoundIds:function(e){var n=this;if(void 0===e){for(var o=[],t=0;t<n._sounds.length;t++)o.push(n._sounds[t]._id);return o}return[e]},_refreshBuffer:function(e){var o=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[o._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,o},_cleanBuffer:function(e){var n=this;if(n._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}}return e.bufferSource=null,n}};var t=function(e){this._parent=e,this.init()};t.prototype={init:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._rate=o._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,o._sounds.push(e),e.create(),e},create:function(){var e=this,o=e._parent,t=n._muted||e._muted||e._parent._muted?0:e._volume;return o._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(t,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._node.src=o._src,e._node.preload="auto",e._node.volume=t*n.volume(),e._node.load()),e},reset:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._rate=o._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,o=e._parent;o._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(o._sprite).length&&(o._sprite={__default:[0,1e3*o._duration]}),"loaded"!==o._state&&(o._state="loaded",o._emit("load"),o._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void d(e);if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),t=new Uint8Array(o.length),a=0;a<o.length;++a)t[a]=o.charCodeAt(a);i(t.buffer,e)}else{var _=new XMLHttpRequest;_.open("GET",n,!0),_.responseType="arraybuffer",_.onload=function(){var n=(_.status+"")[0];if("0"!==n&&"2"!==n&&"3"!==n)return void e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");i(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},u(_)}},u=function(e){try{e.send()}catch(n){e.onerror()}},i=function(e,o){n.ctx.decodeAudioData(e,function(e){e&&o._sounds.length>0&&(r[o._src]=e,d(o,e))},function(){o._emit("loaderror",null,"Decoding audio data failed.")})},d=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),o=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),t=o?parseInt(o[1],10):null;if(e&&t&&t<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());(n._navigator&&n._navigator.standalone&&!r||n._navigator&&!n._navigator.standalone&&!r)&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.value=n._muted?0:1,n.masterGain.connect(n.ctx.destination)),n._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:o}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=o),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=n,window.Howl=o,window.Sound=t):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=n,global.Howl=o,global.Sound=t)}();
/*! Spatial Plugin */
!function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var o=e._howls.length-1;o>=0;o--)e._howls[o].stereo(n);return e},HowlerGlobal.prototype.pos=function(n,e,o){var t=this;return t.ctx&&t.ctx.listener?(e="number"!=typeof e?t._pos[1]:e,o="number"!=typeof o?t._pos[2]:o,"number"!=typeof n?t._pos:(t._pos=[n,e,o],t.ctx.listener.setPosition(t._pos[0],t._pos[1],t._pos[2]),t)):t},HowlerGlobal.prototype.orientation=function(n,e,o,t,r,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var p=a._orientation;return e="number"!=typeof e?p[1]:e,o="number"!=typeof o?p[2]:o,t="number"!=typeof t?p[3]:t,r="number"!=typeof r?p[4]:r,i="number"!=typeof i?p[5]:i,"number"!=typeof n?p:(a._orientation=[n,e,o,t,r,i],a.ctx.listener.setOrientation(n,e,o,t,r,i),a)},Howl.prototype.init=function(n){return function(e){var o=this;return o._orientation=e.orientation||[1,0,0],o._stereo=e.stereo||null,o._pos=e.pos||null,o._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},o._onstereo=e.onstereo?[{fn:e.onstereo}]:[],o._onpos=e.onpos?[{fn:e.onpos}]:[],o._onorientation=e.onorientation?[{fn:e.onorientation}]:[],n.call(this,e)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,o){var t=this;if(!t._webAudio)return t;if("loaded"!==t._state)return t._queue.push({event:"stereo",action:function(){t.stereo(e,o)}}),t;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===o){if("number"!=typeof e)return t._stereo;t._stereo=e,t._pos=[e,0,0]}for(var i=t._getSoundIds(o),a=0;a<i.length;a++){var p=t._soundById(i[a]);if(p){if("number"!=typeof e)return p._stereo;p._stereo=e,p._pos=[e,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",p._panner&&p._panner.pan||n(p,r),"spatial"===r?p._panner.setPosition(e,0,0):p._panner.pan.value=e),t._emit("stereo",p._id)}}return t},Howl.prototype.pos=function(e,o,t,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(e,o,t,r)}}),i;if(o="number"!=typeof o?0:o,t="number"!=typeof t?-.5:t,void 0===r){if("number"!=typeof e)return i._pos;i._pos=[e,o,t]}for(var a=i._getSoundIds(r),p=0;p<a.length;p++){var s=i._soundById(a[p]);if(s){if("number"!=typeof e)return s._pos;s._pos=[e,o,t],s._node&&(s._panner&&!s._panner.pan||n(s,"spatial"),s._panner.setPosition(e,o,t)),i._emit("pos",s._id)}}return i},Howl.prototype.orientation=function(e,o,t,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(e,o,t,r)}}),i;if(o="number"!=typeof o?i._orientation[1]:o,t="number"!=typeof t?i._orientation[2]:t,void 0===r){if("number"!=typeof e)return i._orientation;i._orientation=[e,o,t]}for(var a=i._getSoundIds(r),p=0;p<a.length;p++){var s=i._soundById(a[p]);if(s){if("number"!=typeof e)return s._orientation;s._orientation=[e,o,t],s._node&&(s._panner||(s._pos||(s._pos=i._pos||[0,0,-.5]),n(s,"spatial")),s._panner.setOrientation(e,o,t)),i._emit("orientation",s._id)}}return i},Howl.prototype.pannerAttr=function(){var e,o,t,r=this,i=arguments;if(!r._webAudio)return r;if(0===i.length)return r._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return t=r._soundById(parseInt(i[0],10)),t?t._pannerAttr:r._pannerAttr;e=i[0],void 0===o&&(r._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:r._distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:r._maxDistance,panningModel:void 0!==e.panningModel?e.panningModel:r._panningModel,refDistance:void 0!==e.refDistance?e.refDistance:r._refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:r._rolloffFactor})}else 2===i.length&&(e=i[0],o=parseInt(i[1],10));for(var a=r._getSoundIds(o),p=0;p<a.length;p++)if(t=r._soundById(a[p])){var s=t._pannerAttr;s={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:s.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:s.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:s.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:s.maxDistance,panningModel:void 0!==e.panningModel?e.panningModel:s.panningModel,refDistance:void 0!==e.refDistance?e.refDistance:s.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:s.rolloffFactor};var l=t._panner;l?(l.coneInnerAngle=s.coneInnerAngle,l.coneOuterAngle=s.coneOuterAngle,l.coneOuterGain=s.coneOuterGain,l.distanceModel=s.distanceModel,l.maxDistance=s.maxDistance,l.panningModel=s.panningModel,l.refDistance=s.refDistance,l.rolloffFactor=s.rolloffFactor):(t._pos||(t._pos=r._pos||[0,0,-.5]),n(t,"spatial"))}return r},Sound.prototype.init=function(n){return function(){var e=this,o=e._parent;e._orientation=o._orientation,e._stereo=o._stereo,e._pos=o._pos,e._pannerAttr=o._pannerAttr,n.call(this),e._stereo?o.stereo(e._stereo):e._pos&&o.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var e=this,o=e._parent;return e._orientation=o._orientation,e._pos=o._pos,e._pannerAttr=o._pannerAttr,n.call(this)}}(Sound.prototype.reset);var n=function(n,e){e=e||"spatial","spatial"===e?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.panningModel=n._pannerAttr.panningModel,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.value=n._stereo),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id)}}();var StickyNotes=(function(){var show=function(content,options){options=options||{};var title=options.header;var $elem=$(".note_elem_tpl").clone();var dest='';if(options.important){$elem.addClass('bg-light-2');dest='.important-notes'}else{$elem.addClass('bg-light-1');dest='.all-notes'}
var $title=$elem.find("h4.title");if(title)$title.html(title);else $title.hide();$elem.find("div.content").html(content);$(".sticky_notes "+dest).prepend($elem);$elem.removeClass("note_elem_tpl hide");$elem.slideDown("fast");var destroy=function(){$elem.slideUp("fast",function(){$elem.remove()});if(options.id){StickyNotes.notes[options.id]=null;delete StickyNotes.notes[options.id]}};$elem.find(".close").click(destroy);var blinkCount=0;var blinkInterval=setInterval(function(){$elem.toggleClass("blink");blinkCount++;if(blinkCount>10){$elem.removeClass("blink");clearInterval(blinkInterval)}},300);if(options.id){StickyNotes.notes[options.id]=$elem}
if(options.life){setTimeout(destroy,options.life)}
return $elem};return{show:function(content,options){return show(content,options)}}})();StickyNotes.notes={};$(function(){$("body").prepend('<div class="sticky_notes"><div class="important-notes"></div><div class="all-notes"></div><div class="hide round-border box-shadow note_elem note_elem_tpl"><i class="close">&times;</i><h4 class="title"></h4><div class="content"></div></div></div>')});if(!window.VK)window.VK={};if(!VK.Share){VK.Share={_popups:[],_gens:[],_base_domain:'',_ge:function(id){return document.getElementById(id)},button:function(gen,but,index){if(!gen)gen={};if(gen===gen.toString())gen={url:gen.toString()};if(!gen.url)gen.url=VK.Share._loc;if(!but)but={type:'round'};if(but===but.toString())but={type:'round',text:but};if(!but.text)but.text='\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c';var old=!0,count_style='display: none';if(index===undefined){gen.count=0;gen.shared=(but.type=='button'||but.type=='round')?!1:!0;this._gens.push(gen);this._popups.push(!1);index=this._popups.length-1;old=!1}else{if((gen.count=this._gens[index].count)&&(but.type=='button'||but.type=='round')){count_style=''}
gen.shared=this._gens[index].shared;this._gens[index]=gen}
var head=document.getElementsByTagName('head')[0];if(!this._base_domain){for(var elem=head.firstChild;elem;elem=elem.nextSibling){var m;if(elem.tagName&&elem.tagName.toLowerCase()=='script'&&(m=elem.src.match(/(https?:\/\/(?:[a-z0-9_\-\.]*\.)?(?:vk\.com|vkontakte\.ru)\/)js\/api\/share\.js(?:\?|$)/))){this._base_domain=m[1]}}}
this._base_domain=this._base_domain.replace('vkontakte.ru','vk.com');if(!this._base_domain){this._base_domain='https://vk.com/'}
if(!old&&(but.type=='button'||but.type=='round')){var elem=document.createElement('script');elem.src=this._base_domain+'share.php?act=count&index='+index+'&url='+encodeURIComponent(gen.url);head.appendChild(elem)}
var is2x=window.devicePixelRatio>=2?'_2x':'';var iseng=but.eng?'_eng':'';var a='<a href="'+this._base_domain+'share.php?url='+encodeURIComponent(gen.url)+'" onmouseup="this._btn=event.button;this.blur();" onclick="return VK.Share.click('+index+', this);"',a1=a+' style="text-decoration:none;">',a2='</a>',a3=a+' style="display:inline-block;text-decoration:none;">',td1='<td style="vertical-align: middle;">',td2='</td>';if(but.type=='round'||but.type=='round_nocount'||but.type=='button'||but.type=='button_nocount'){var logo=but.eng?'':'0px 0px';return'<table cellspacing="0" cellpadding="0" id="vkshare'+index+'" onmouseover="VK.Share.change(1, '+index+');" onmouseout="VK.Share.change(0, '+index+');" onmousedown="VK.Share.change(2, '+index+');" onmouseup="VK.Share.change(1, '+index+');" style="position: relative; width: auto; cursor: pointer; border: 0px;"><tr style="line-height: normal;">'+td1+a+' style="border: none;background: #5F83AA;-webkit-border-radius: 2px 0px 0px 2px;-moz-border-radius: 2px 0px 0px 2px;border-radius: 2px 0px 0px 2px;display:block;text-decoration: none;padding: 3px 3px 3px 6px;color: #FFFFFF;font-family: tahoma, arial;height: 15px;line-height:15px;font-size: 10px;text-shadow: none;">'+but.text+'<div class="float:right"></div>'+a2+td2+td1+a+' style="border: none;background: #5F83AA;-webkit-border-radius: 0px 2px 2px 0px;-moz-border-radius: 0px 2px 2px 0px;border-radius: 0px 2px 2px 0px;display:block; padding: 3px;'+(but.eng?'padding-left: 1px;':'')+'"><div style="background: url(\'//vk.com/images/icons/share_logo'+is2x+'.png\') 0px '+(but.eng?'-15px':'0px')+' no-repeat; background-size: 16px 31px; '+(but.eng?'width: 17px;height:9px;margin: 3px 0px;':'width: 15px;height: 15px;')+'"></div>'+a2+td2+((but.type=='round'||but.type=='button')?td1+a+' style="text-decoration: none;font-weight:bold;font-family: tahoma, arial;'+count_style+'"><div style="background: url(\'//vk.com/images/icons/share_logo'+is2x+'.png\') 0px -24px no-repeat; background-size: 16px 31px; width: 4px; height: 7px;position: absolute; margin: 7px 0px 0px 4px;z-index:100;"></div><div id="vkshare_cnt'+index+'" style="border: 1px solid #bbbfc4;background: #FFFFFF;height: 15px;line-height: 15px;5px; padding: 2px 4px;min-width: 12px;margin-left: 7px;border-radius: 2px;-webkit-border-radius: 2px;-moz-border-radius:2px;text-align: center; color: #666c73;font-size: 10px;z-index:99;">'+gen.count+'</div>'+a2+td2:'')+'</tr></table>'}else if(but.type=='link'){return'<table style="position: relative; cursor:pointer; width: auto; line-height: normal;" onmouseover="this.rows[0].cells[1].firstChild.firstChild.style.textDecoration=\'underline\'" onmouseout="this.rows[0].cells[1].firstChild.firstChild.style.textDecoration=\'none\'" cellspacing="0" cellpadding="0"><tr style="line-height: normal;">'+td1+a1+'<img src="//vk.com/images/icons/share_link'+iseng+is2x+'.png" width="16" height="16" style="vertical-align: middle;border:0;"/>'+a2+td2+td1+a1+'<span style="padding: 0 0 0 5px; color: #2B587A; font-family: tahoma, arial; font-size: 11px;">'+but.text+'</span>'+a2+td2+'</tr></table>'}else if(but.type=='link_noicon'){return a3+'<span style="position: relative; font-family: tahoma, arial; font-size: 11px; color: #2B587A; line-height: normal;" onmouseover="this.style.textDecoration=\'underline\'" onmouseout="this.style.textDecoration=\'none\'">'+but.text+'</span>'+a2}else{return a3+'<span style="position: relative; padding:0;">'+but.text+'</span>'+a2}},change:function(state,index){var el=this._ge('vkshare'+index),color;if(state==0){color='#5F83AA'}else if(state==1){color='#6890bb'}else if(state==2){color='#557599'}
var els=[el.rows[0].cells[0].firstChild,el.rows[0].cells[1].firstChild];for(var i in els){els[i].style.backgroundColor=color;els[i].style.color='#FFFFFF';if(state==2){els[i].style.paddingTop='4px';els[i].style.paddingBottom='2px'}else{els[i].style.paddingTop='3px';els[i].style.paddingBottom='3px'}}},click:function(index,el){var e=window.event;if(e){if(!e.which&&el._btn)e.which=(el._btn&1?1:(el._btn&2?3:(el._btn&4?2:0)));if(e.which==2){return!0}}
var details=this._gens[index];if(!details.shared){VK.Share.count(index,details.count+1);details.shared=!0}
var undefined;if(details.noparse===undefined){details.noparse=details.title&&details.description&&details.image}
details.noparse=details.noparse?1:0;var params={};var fields=['title','description','image','noparse'];for(var i=0;i<fields.length;++i){if(details[fields[i]]){params[fields[i]]=details[fields[i]]}}
var popupName='_blank';var width=554;var height=349;var left=(screen.width-width)/2;var top=(screen.height-height)/2;var url=this._base_domain+'share.php?url='+details.url;var popupParams='scrollbars=0, resizable=1, menubar=0, left='+left+', top='+top+', width='+width+', height='+height+', toolbar=0, status=0';var popup=!1;try{var doc_dom='',loc_hos='';try{doc_dom=document.domain;loc_hos=location.host}catch(e){}
if(doc_dom!=loc_hos){var ua=navigator.userAgent.toLowerCase();if(!/opera/i.test(ua)&&/msie/i.test(ua)){throw 'wont work'}}
popup=this._popups[index]=window.open('',popupName,popupParams);var text='<form accept-charset="UTF-8" action="'+url+'" method="POST" id="share_form">';for(var i in params){text+='<input type="hidden" name="'+i+'" value="'+params[i].toString().replace(/"/g,'&myquot;').replace(/&quot/ig,'&myquot')+'" />'}
text+='</form>';text+='<script type="text/javascript">document.getElementById("share_form").submit()</script>';text='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'+'<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">'+'<head><meta http-equiv="content-type" content="text/html; charset=windows-1251" /></head>'+'<body>'+text+'</body></html>';popup.document.write(text);popup.focus()}catch(e){try{if(popup){popup.close()}
url+='?';for(var i in params){url+=encodeURIComponent(i)+'='+encodeURIComponent(params[i])+'&'}
popup=this._popups[index]=window.open(url,popupName,popupParams);popup.focus()}catch(e){}}
return!1},count:function(index,count){this._gens[index].count=count;var elem=this._ge('vkshare'+index);if(elem){var row=elem.rows[0];if(count){var c=this._ge('vkshare_cnt'+index);c.innerHTML=count;row.cells[2].firstChild.style.display='block'}else{row.cells[2].firstChild.style.display='none'}}}}
try{VK.Share._loc=location.toString()}catch(e){VK.Share._loc='http://vk.com/'}}
try{if(window.stManager)stManager.done('api/share.js')}catch(e){};
/*! http://mths.be/placeholder v2.0.7 by @mathias */
;(function(window,document,$){var isOperaMini=Object.prototype.toString.call(window.operamini)=='[object OperaMini]';var isInputSupported='placeholder' in document.createElement('input')&&!isOperaMini;var isTextareaSupported='placeholder' in document.createElement('textarea')&&!isOperaMini;var prototype=$.fn;var valHooks=$.valHooks;var propHooks=$.propHooks;var hooks;var placeholder;if(isInputSupported&&isTextareaSupported){placeholder=prototype.placeholder=function(){return this};placeholder.input=placeholder.textarea=!0}else{placeholder=prototype.placeholder=function(){var $this=this;$this.filter((isInputSupported?'textarea':':input')+'[placeholder]').not('.placeholder').bind({'focus.placeholder':clearPlaceholder,'blur.placeholder':setPlaceholder}).data('placeholder-enabled',!0).trigger('blur.placeholder');return $this};placeholder.input=isInputSupported;placeholder.textarea=isTextareaSupported;hooks={'get':function(element){var $element=$(element);var $passwordInput=$element.data('placeholder-password');if($passwordInput){return $passwordInput[0].value}
return $element.data('placeholder-enabled')&&$element.hasClass('placeholder')?'':element.value},'set':function(element,value){var $element=$(element);var $passwordInput=$element.data('placeholder-password');if($passwordInput){return $passwordInput[0].value=value}
if(!$element.data('placeholder-enabled')){return element.value=value}
if(value==''){element.value=value;if(element!=safeActiveElement()){setPlaceholder.call(element)}}else if($element.hasClass('placeholder')){clearPlaceholder.call(element,!0,value)||(element.value=value)}else{element.value=value}
return $element}};if(!isInputSupported){valHooks.input=hooks;propHooks.value=hooks}
if(!isTextareaSupported){valHooks.textarea=hooks;propHooks.value=hooks}
$(function(){$(document).delegate('form','submit.placeholder',function(){var $inputs=$('.placeholder',this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder)},10)})});$(window).bind('beforeunload.placeholder',function(){$('.placeholder').each(function(){this.value=''})})}
function args(elem){var newAttrs={};var rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value}});return newAttrs}
function clearPlaceholder(event,value){var input=this;var $input=$(input);if(input.value==$input.attr('placeholder')&&$input.hasClass('placeholder')){if($input.data('placeholder-password')){$input=$input.hide().next().show().attr('id',$input.removeAttr('id').data('placeholder-id'));if(event===!0){return $input[0].value=value}
$input.focus()}else{input.value='';$input.removeClass('placeholder');input==safeActiveElement()&&input.select()}}}
function setPlaceholder(){var $replacement;var input=this;var $input=$(input);var id=this.id;if(input.value==''){if(input.type=='password'){if(!$input.data('placeholder-textinput')){try{$replacement=$input.clone().attr({'type':'text'})}catch(e){$replacement=$('<input>').attr($.extend(args(this),{'type':'text'}))}
$replacement.removeAttr('name').data({'placeholder-password':$input,'placeholder-id':id}).bind('focus.placeholder',clearPlaceholder);$input.data({'placeholder-textinput':$replacement,'placeholder-id':id}).before($replacement)}
$input=$input.removeAttr('id').hide().prev().attr('id',id).show()}
$input.addClass('placeholder');$input[0].value=$input.attr('placeholder')}else{$input.removeClass('placeholder')}}
function safeActiveElement(){try{return document.activeElement}catch(err){}}}(this,document,jQuery));$(function(){var notes={};var scheduleNextCheck=function(timeOutSeconds){setTimeout(tournamentGamesChecker,timeOutSeconds*1000)};var tournamentGamesChecker=function(){$.get(App.urlTo("/play/tournaments",{action:'current',t:(new Date().getTime())+(Math.random())}),function(data){var nextIn=data.next_tournament_in;var timeOutSeconds=300;if(!nextIn||nextIn>300){timeOutSeconds=300}else if(nextIn>100){timeOutSeconds=100}else if(nextIn>50){timeOutSeconds=50}else if(nextIn>10){timeOutSeconds=10}else{timeOutSeconds=15}
if(data&&data.games&&data.games.length&&(!CS.Game||CS.Game.viewMode||!CS.Game.tournamentGame)){timeOutSeconds=20;var gamesString='',t_link;for(var i=0;i<data.games.length;i++){var g=data.games[i];var g_link='<a href="'+g.url+'">Перейти в партию #'+g.id+' &#8594;</a>';t_link='<a href="'+g.t_url+'">'+g.tname+'</a>';gamesString+='<br />'+t_link+': '+g_link}
var head,msgStart;if(data.games.length==1){head='турнирной партии';t_link='<a href="'+data.games[0].t_url+'">'+data.games[0].tname+'</a>';msgStart='В турнире '+t_link+' началась партия с Вашим участием! ';gamesString='<a href="'+data.games[0].url+'">Перейти в партию &#8594;</a>'}else{head='турнирных партиях';msgStart='Начались несколько Ваших турнирных партий. '}
var stickerId='tournaments';if(!StickyNotes.notes[stickerId]){if(notes[stickerId]){notes[stickerId].remove()}
notes[stickerId]=CS.Notify.showImportant('Ваш ход в '+head+'!',msgStart+'Успейте сделать ход, иначе Вам будет присуждено поражение! '+gamesString)}}
if(data.has_current){timeOutSeconds=20}
scheduleNextCheck(timeOutSeconds)})};if(isAuth){if(cs_user.currentTournamentsCount>0){scheduleNextCheck(1)}else if(cs_user.futureTournamentsCount>0){scheduleNextCheck(10)}else{scheduleNextCheck(300)}}})